{
  "name": "BENCHMARK - Neo4j Introspection & Manager V1.0",
  "nodes": [
    {
      "id": "webhook-trigger",
      "name": "Webhook: Neo4j Admin API",
      "type": "n8n-nodes-base.webhook",
      "position": [250, 300],
      "webhookId": "benchmark-neo4j-admin",
      "parameters": {
        "httpMethod": "POST",
        "path": "benchmark-neo4j-admin",
        "responseMode": "responseNode"
      }
    },
    {
      "id": "parse-request",
      "name": "Parse Request",
      "type": "n8n-nodes-base.code",
      "position": [450, 300],
      "parameters": {
        "jsCode": "const body = $input.first().json.body || {};\nconst action = body.action || 'summary';\n\nconst validActions = [\n  'summary',\n  'list_labels',\n  'list_relationships',\n  'count_by_label',\n  'count_by_relationship',\n  'get_schema',\n  'sample_nodes',\n  'search_nodes',\n  'get_neighbors',\n  'get_paths',\n  'execute_cypher',\n  'get_properties',\n  'get_indexes',\n  'get_constraints',\n  'check_connectivity'\n];\n\nif (!validActions.includes(action)) {\n  return [{\n    json: {\n      error: `Invalid action: ${action}`,\n      valid_actions: validActions\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    action,\n    label: body.label || null,\n    relationship: body.relationship || null,\n    node_id: body.node_id || null,\n    cypher: body.cypher || null,\n    search_term: body.search_term || null,\n    limit: body.limit || 10,\n    max_depth: body.max_depth || 2\n  }\n}];"
      }
    },
    {
      "id": "router",
      "name": "Route by Action",
      "type": "n8n-nodes-base.switch",
      "position": [650, 300],
      "parameters": {
        "rules": {
          "rules": [
            {"value": "summary", "output": 0},
            {"value": "list_labels", "output": 1},
            {"value": "list_relationships", "output": 2},
            {"value": "count_by_label", "output": 3},
            {"value": "count_by_relationship", "output": 4},
            {"value": "get_schema", "output": 5},
            {"value": "sample_nodes", "output": 6},
            {"value": "search_nodes", "output": 7},
            {"value": "get_neighbors", "output": 8},
            {"value": "get_paths", "output": 9},
            {"value": "execute_cypher", "output": 10},
            {"value": "get_properties", "output": 11},
            {"value": "get_indexes", "output": 12},
            {"value": "get_constraints", "output": 13},
            {"value": "check_connectivity", "output": 14}
          ]
        }
      }
    },
    {
      "id": "summary",
      "name": "Get Graph Summary",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 50],
      "parameters": {
        "query": "CALL apoc.meta.stats() YIELD labels, relTypesCount, propertyKeys\nRETURN {\n  total_nodes: apoc.coll.sum(apoc.map.values(labels)),\n  total_relationships: apoc.coll.sum(apoc.map.values(relTypesCount)),\n  labels: labels,\n  relationship_types: relTypesCount,\n  total_property_keys: size(propertyKeys)\n} as summary",
        "options": {}
      }
    },
    {
      "id": "list-labels",
      "name": "List Node Labels",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 120],
      "parameters": {
        "query": "CALL db.labels() YIELD label\nRETURN label\nORDER BY label",
        "options": {}
      }
    },
    {
      "id": "list-relationships",
      "name": "List Relationship Types",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 190],
      "parameters": {
        "query": "CALL db.relationshipTypes() YIELD relationshipType\nRETURN relationshipType\nORDER BY relationshipType",
        "options": {}
      }
    },
    {
      "id": "count-by-label",
      "name": "Count Nodes by Label",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 260],
      "parameters": {
        "query": "CALL apoc.meta.stats() YIELD labels\nUNWIND keys(labels) as label\nRETURN label, labels[label] as count\nORDER BY count DESC",
        "options": {}
      }
    },
    {
      "id": "get-schema",
      "name": "Get Full Schema",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 330],
      "parameters": {
        "query": "CALL apoc.meta.schema() YIELD value\nRETURN value as schema",
        "options": {}
      }
    },
    {
      "id": "sample-nodes",
      "name": "Sample Nodes",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 400],
      "parameters": {
        "query": "MATCH (n{{ $json.label ? ':' + $json.label : '' }})\nRETURN n\nLIMIT {{$json.limit}}",
        "options": {}
      }
    },
    {
      "id": "search-nodes",
      "name": "Search Nodes by Name",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 470],
      "parameters": {
        "query": "MATCH (n)\nWHERE toLower(n.name) CONTAINS toLower('{{$json.search_term}}')\n   OR toLower(n.title) CONTAINS toLower('{{$json.search_term}}')\nRETURN n\nLIMIT {{$json.limit}}",
        "options": {}
      }
    },
    {
      "id": "get-neighbors",
      "name": "Get Node Neighbors",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 540],
      "parameters": {
        "query": "MATCH path = (n)-[*1..{{$json.max_depth}}]-(m)\nWHERE id(n) = {{$json.node_id}}\nRETURN [node in nodes(path) | {id: id(node), name: node.name, labels: labels(node)}] as path_nodes,\n       [rel in relationships(path) | {type: type(rel)}] as path_relationships\nLIMIT {{$json.limit}}",
        "options": {}
      }
    },
    {
      "id": "execute-cypher",
      "name": "Execute Custom Cypher",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 610],
      "parameters": {
        "query": "={{$json.cypher}}",
        "options": {}
      }
    },
    {
      "id": "get-indexes",
      "name": "List Indexes",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 680],
      "parameters": {
        "query": "SHOW INDEXES\nYIELD name, type, entityType, labelsOrTypes, properties, state\nRETURN name, type, entityType, labelsOrTypes, properties, state",
        "options": {}
      }
    },
    {
      "id": "check-connectivity",
      "name": "Check DB Connectivity",
      "type": "n8n-nodes-base.neo4j",
      "position": [850, 750],
      "parameters": {
        "query": "RETURN {\n  connected: true,\n  timestamp: datetime(),\n  version: '5.x'\n} as status",
        "options": {}
      }
    },
    {
      "id": "format-response",
      "name": "Format Response",
      "type": "n8n-nodes-base.code",
      "position": [1100, 300],
      "parameters": {
        "jsCode": "const data = $input.all();\nconst action = $vars.action || 'unknown';\n\nreturn [{\n  json: {\n    timestamp: new Date().toISOString(),\n    action: action,\n    database: 'neo4j',\n    result_count: data.length,\n    data: data.map(d => d.json)\n  }\n}];"
      }
    },
    {
      "id": "respond",
      "name": "Respond to Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [1300, 300],
      "parameters": {
        "respondWith": "json",
        "json": "={{ JSON.stringify($json) }}"
      }
    }
  ],
  "connections": {
    "Webhook: Neo4j Admin API": {
      "main": [[{"node": "Parse Request", "type": "main", "index": 0}]]
    },
    "Parse Request": {
      "main": [[{"node": "Route by Action", "type": "main", "index": 0}]]
    },
    "Route by Action": {
      "main": [
        [{"node": "Get Graph Summary", "type": "main", "index": 0}],
        [{"node": "List Node Labels", "type": "main", "index": 0}],
        [{"node": "List Relationship Types", "type": "main", "index": 0}],
        [{"node": "Count Nodes by Label", "type": "main", "index": 0}],
        [{"node": "Count Nodes by Label", "type": "main", "index": 0}],
        [{"node": "Get Full Schema", "type": "main", "index": 0}],
        [{"node": "Sample Nodes", "type": "main", "index": 0}],
        [{"node": "Search Nodes by Name", "type": "main", "index": 0}],
        [{"node": "Get Node Neighbors", "type": "main", "index": 0}],
        [{"node": "Get Node Neighbors", "type": "main", "index": 0}],
        [{"node": "Execute Custom Cypher", "type": "main", "index": 0}],
        [{"node": "Get Full Schema", "type": "main", "index": 0}],
        [{"node": "List Indexes", "type": "main", "index": 0}],
        [{"node": "List Indexes", "type": "main", "index": 0}],
        [{"node": "Check DB Connectivity", "type": "main", "index": 0}]
      ]
    },
    "Get Graph Summary": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "List Node Labels": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "List Relationship Types": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Count Nodes by Label": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Get Full Schema": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Sample Nodes": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Search Nodes by Name": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Get Node Neighbors": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Execute Custom Cypher": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "List Indexes": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Check DB Connectivity": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    },
    "Format Response": {
      "main": [[{"node": "Respond to Webhook", "type": "main", "index": 0}]]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "tags": [
    {
      "name": "benchmark",
      "color": "#ff0000"
    },
    {
      "name": "neo4j",
      "color": "#008cc1"
    },
    {
      "name": "admin",
      "color": "#0000ff"
    }
  ]
}
