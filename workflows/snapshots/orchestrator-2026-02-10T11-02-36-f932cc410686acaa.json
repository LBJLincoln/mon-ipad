{
  "updatedAt": "2026-02-09T22:58:54.205Z",
  "createdAt": "2026-02-09T04:28:15.672Z",
  "id": "ALd4gOEqiKL5KR1p",
  "name": "V10.1 orchestrator copy",
  "description": null,
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "92217bb8-ffc8-459a-8331-3f553812c3d0",
        "responseMode": "responseNode",
        "options": {
          "rawBody": false
        }
      },
      "id": "f744daf0-5a48-444c-800a-b1b3cc4ae510",
      "name": "Webhook V8",
      "type": "n8n-nodes-base.webhook",
      "position": [
        16768,
        22288
      ],
      "typeVersion": 2.1,
      "webhookId": "92217bb8-ffc8-459a-8331-3f553812c3d0"
    },
    {
      "parameters": {
        "public": true,
        "initialMessages": "üß† Bienvenue! Je suis l'assistant RAG SOTA 2026 **V8.0 CoT**.\n\n‚ú® Nouveaut√©s:\n- Chain-of-Thought reasoning\n- Adaptive retrieval\n- Meilleure planification\n\nPosez-moi vos questions!",
        "options": {
          "responseMode": "responseNode"
        }
      },
      "id": "ad2972dd-a8f8-4368-8546-aeb5f5449ca8",
      "name": "Chat Trigger V8",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        16768,
        22080
      ],
      "webhookId": "95045bc0-7635-45e7-9cbb-5e96b93b32af"
    },
    {
      "parameters": {
        "jsCode": "// INPUT MERGER V8 - Unifie Webhook et Chat Trigger\nconst inputItem = $input.first().json;\nconst startTime = Date.now();\n\nlet source = 'unknown';\nlet body = {};\nlet rawQuery = '';\n\nif (inputItem.headers !== undefined && inputItem.body !== undefined) {\n  source = 'webhook';\n  body = inputItem.body || {};\n  rawQuery = body.query || '';\n} else if (inputItem.chatInput !== undefined || inputItem.sessionId !== undefined) {\n  source = 'chat';\n  rawQuery = inputItem.chatInput || inputItem.message || '';\n  body = {\n    query: rawQuery,\n    conversation_id: inputItem.sessionId || 'chat-' + Date.now(),\n    tenant_id: 'chat-user',\n    user_groups: ['chat-user'],\n    roles: ['viewer']\n  };\n} else if (inputItem.query) {\n  source = 'direct';\n  body = inputItem;\n  rawQuery = inputItem.query;\n} else {\n  throw new Error('INPUT_ERROR: No valid input detected');\n}\n\nif (!rawQuery || rawQuery.trim().length === 0) {\n  throw new Error('VALIDATION_ERROR: query is required');\n}\n\nreturn [{\n  json: {\n    source: source,\n    body: body,\n    query: rawQuery.trim(),\n    session_id: body.conversation_id || inputItem.sessionId,\n    is_chat: source === 'chat',\n    is_webhook: source === 'webhook' || source === 'direct',\n    _perf: { start_time: startTime }\n  }\n}];"
      },
      "id": "935fb493-3928-400b-b87a-53a312b97015",
      "name": "Input Merger V8",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16960,
        22192
      ]
    },
    {
      "parameters": {
        "jsCode": "// INIT V8 - Security Gate + Pre-Classification + CoT Prep + Query Hash\nconst body = $node[\"Input Merger V8\"].json.body || {};\nconst inputMerger = $node[\"Input Merger V8\"].json;\nconst startTime = Date.now();\n\n// Crypto pour hash\nconst crypto = require('crypto');\n\n// Extraction query\nlet rawQuery = body.query || inputMerger.query || '';\nconst query = rawQuery.trim();\n\n// G√©n√©rer query_hash pour cache\nconst queryHash = crypto.createHash('sha256')\n  .update(query.toLowerCase().trim())\n  .digest('hex').substring(0, 16);\n\n// Trace ID\nconst traceId = body.conversation_id || inputMerger.conversation_id || \n  `trace-${Date.now()}-${Math.random().toString(36).substring(7)}`;\n\n// Security checks\nconst isSuspicious = /(<script|javascript:|onerror=|eval\\()/i.test(query);\nconst isEmpty = query.length < 2;\n\nreturn {\n  trace_id: traceId,\n  query: query,\n  query_hash: queryHash,\n  conversation_id: body.conversation_id || traceId,\n  session_id: body.session_id || body.conversation_id || traceId,\n  tenant_id: body.tenant_id || 'default',\n  user_groups: body.user_groups || ['default'],\n  metadata: body.metadata || {},\n  is_suspicious: isSuspicious,\n  is_empty: isEmpty,\n  timestamp: startTime,\n  source: inputMerger.source || 'unknown'\n};\n"
      },
      "id": "3e534116-e58f-4aff-802c-66b4c5db2b2e",
      "name": "Init V8 Security & Analysis",
      "type": "n8n-nodes-base.code",
      "position": [
        17152,
        22192
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "operation": "get",
        "key": "={{ 'conv:' + $node['Init V8 Security & Analysis'].json.conversation_id }}",
        "options": {}
      },
      "id": "a9f97e14-db82-4bd7-b0db-51b6eca8f667",
      "name": "Redis: Fetch Conversation",
      "type": "n8n-nodes-base.redis",
      "position": [
        17296,
        22384
      ],
      "typeVersion": 1,
      "credentials": {
        "redis": {
          "id": "O2KEPiv7VzgDG5ZX",
          "name": "Redis Upstash"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  COALESCE(entities_json, '{}'::jsonb) as entities_json,\n  COALESCE(last_intent, 'UNKNOWN') as last_intent,\n  COALESCE(updated_at, NOW()) as updated_at\nFROM conversation_context \nWHERE conversation_id = $1 AND tenant_id = $2\nLIMIT 1",
        "options": {
          "queryReplacement": "=={{ [$json.conversation_id, $json.user_context.tenant_id] }}"
        }
      },
      "id": "da7327db-154d-4cea-9020-96650b124966",
      "name": "Postgres L2/L3 Memory",
      "type": "n8n-nodes-base.postgres",
      "position": [
        17344,
        21904
      ],
      "typeVersion": 2.4,
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "LnTqRX4LZlI009Ks-3Jnp",
          "mode": "id"
        },
        "workflowInputs": {
          "value": {
            "query": "={{ $node['‚öôÔ∏è Execution Engine V10'].json.current_task?.query || $node['‚öôÔ∏è Execution Engine V10'].json.task_query || $node['Init V8 Security & Analysis'].json.query }}",
            "trace_id": "={{ $node['Init V8 Security & Analysis'].json.trace_id }}",
            "user_context": "={{ JSON.stringify({ tenant_id: $node['Init V8 Security & Analysis'].json.tenant_id || 'default', groups: $node['Init V8 Security & Analysis'].json.user_groups || ['default'] }) }}",
            "topK": 20
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "query",
              "displayName": "query",
              "type": "string"
            },
            {
              "id": "trace_id",
              "displayName": "trace_id",
              "type": "string"
            },
            {
              "id": "user_context",
              "displayName": "user_context",
              "type": "string"
            },
            {
              "id": "topK",
              "displayName": "topK",
              "type": "number"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true,
          "mappingMode": "defineBelow"
        },
        "options": {
          "waitForSubWorkflow": true
        }
      },
      "id": "72c191ac-677e-4f9c-a64f-1cc328680e31",
      "name": "Invoke WF5: Standard",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        21840,
        22224
      ],
      "typeVersion": 1.2,
      "alwaysOutputData": false,
      "continueOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "95x2BBAbJlLWZtWEJn6rb",
          "mode": "id",
          "cachedResultUrl": "/workflow/95x2BBAbJlLWZtWEJn6rb"
        },
        "workflowInputs": {
          "value": {
            "query": "={{ $node['‚öôÔ∏è Execution Engine V10'].json.current_task?.query || $node['‚öôÔ∏è Execution Engine V10'].json.task_query || $node['Init V8 Security & Analysis'].json.query }}",
            "trace_id": "={{ $node['Init V8 Security & Analysis'].json.trace_id }}",
            "user_context": "={{ JSON.stringify({ tenant_id: $node['Init V8 Security & Analysis'].json.tenant_id || 'default', groups: $node['Init V8 Security & Analysis'].json.user_groups || ['default'] }) }}",
            "topK": 20
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "query",
              "displayName": "query",
              "type": "string"
            },
            {
              "id": "trace_id",
              "displayName": "trace_id",
              "type": "string"
            },
            {
              "id": "user_context",
              "displayName": "user_context",
              "type": "string"
            },
            {
              "id": "topK",
              "displayName": "topK",
              "type": "number"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true,
          "mappingMode": "defineBelow"
        },
        "options": {
          "waitForSubWorkflow": true
        }
      },
      "id": "e3d043ea-96ab-4413-a1a5-683b090596a4",
      "name": "Invoke WF2: Graph",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        21840,
        22656
      ],
      "typeVersion": 1.2,
      "alwaysOutputData": true,
      "continueOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "E19NZG9WfM7FNsxr",
          "mode": "id"
        },
        "workflowInputs": {
          "value": {
            "query": "={{ $node['‚öôÔ∏è Execution Engine V10'].json.current_task?.query || $node['‚öôÔ∏è Execution Engine V10'].json.task_query || $node['Init V8 Security & Analysis'].json.query }}",
            "trace_id": "={{ $node['Init V8 Security & Analysis'].json.trace_id }}",
            "user_context": "={{ JSON.stringify({ tenant_id: $node['Init V8 Security & Analysis'].json.tenant_id || 'default', groups: $node['Init V8 Security & Analysis'].json.user_groups || ['default'] }) }}",
            "topK": 20
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "query",
              "displayName": "query",
              "type": "string"
            },
            {
              "id": "trace_id",
              "displayName": "trace_id",
              "type": "string"
            },
            {
              "id": "user_context",
              "displayName": "user_context",
              "type": "string"
            },
            {
              "id": "topK",
              "displayName": "topK",
              "type": "number"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true,
          "mappingMode": "defineBelow"
        },
        "options": {
          "waitForSubWorkflow": true
        }
      },
      "id": "8d682938-416e-4a7c-915e-b9a02cca209a",
      "name": "Invoke WF4: Quantitative",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        21856,
        22416
      ],
      "typeVersion": 1.2,
      "alwaysOutputData": true,
      "continueOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Safe accessor for sub-workflow results\nfunction safe_access(nodeRef, defaultVal) {\n  try { return nodeRef || defaultVal; }\n  catch(e) { return defaultVal; }\n}\n\n\n// ITER2 FIX: Better response extraction from diverse sub-workflow outputs\nfunction extractResponseText(result) {\n  if (!result) return '';\n  const j = result.json || result;\n  // Try multiple response field names used by different sub-workflows\n  return j.final_response || j.response || j.interpretation ||\n         j.answer || j.chat_message || j.result || '';\n}\n// ============================================\n// PATCH - Response Builder V9.6\n// FIX: Lit correctement les donn√©es depuis Execution Engine\n// ============================================\n//\n// PROBL√àME: Response Builder ne recevait pas les donn√©es car il lisait\n// depuis des nodes qui n'√©taient pas dans son flux direct.\n//\n// SOLUTION: Lire depuis $json qui vient directement de l'IF node\n// qui lui-m√™me vient de Execution Engine.\n// ============================================\n\nconst inputData = $json;\nconst traceId = inputData.trace_id || $node['Init V8 Security & Analysis']?.json?.trace_id || 'unknown';\nconst isChat = inputData.is_chat || $node['Input Merger V8']?.json?.is_chat || false;\nconst originalQuery = inputData.original_query || $node['Init V8 Security & Analysis']?.json?.query || '';\n\nconsole.log(`[${traceId}] Response Builder V9.6 starting...`);\nconsole.log(`[${traceId}] Input keys: ${Object.keys(inputData).join(', ')}`);\n\n// === 1. R√âCUP√âRER LES R√âSULTATS ===\n// Priorit√© 1: Donn√©es directes depuis Execution Engine (via IF node)\nlet completedTasks = inputData.completed_tasks || [];\nlet allResponses = inputData.all_responses || [];\nlet finalResponse = inputData.final_response || '';\nlet confidence = inputData.confidence || 0;\n\nconsole.log(`[${traceId}] From input: ${completedTasks.length} completed, ${allResponses.length} responses`);\nconsole.log(`[${traceId}] Pre-computed final_response: ${finalResponse.length} chars`);\n\n// === 2. SI PAS DE R√âPONSE PR√â-CALCUL√âE, CONSTRUIRE ===\nif (!finalResponse || finalResponse.length < 10) {\n    console.log(`[${traceId}] Building response from completed_tasks...`);\n    \n    if (allResponses.length > 0) {\n        // Trier par confidence\n        const sorted = allResponses.sort((a, b) => (b.confidence || 0) - (a.confidence || 0));\n        \n        if (sorted.length === 1) {\n            finalResponse = sorted[0].response;\n            confidence = sorted[0].confidence || 0.5;\n        } else {\n            // Combiner les r√©ponses de diff√©rents RAGs\n            const usedRags = new Set(sorted.map(r => r.rag));\n            \n            if (usedRags.size > 1) {\n                // R√©ponses de diff√©rents RAGs\n                finalResponse = sorted.map(r => {\n                    const icon = r.rag === 'STANDARD' ? 'üìö' : r.rag === 'GRAPH' ? 'üîó' : 'üìä';\n                    return `${icon} **${r.rag}:**\\n${r.response}`;\n                }).join('\\n\\n---\\n\\n');\n                \n                confidence = sorted.reduce((sum, r) => sum + (r.confidence || 0), 0) / sorted.length;\n            } else {\n                // M√™me RAG - prendre la meilleure\n                finalResponse = sorted[0].response;\n                confidence = sorted[0].confidence || 0.5;\n            }\n        }\n        \n        console.log(`[${traceId}] Built response: ${finalResponse.length} chars`);\n    }\n}\n\n// === 3. FALLBACK SI TOUJOURS VIDE ===\nif (!finalResponse || finalResponse.length < 10) {\n    // Essayer de lire depuis completed_tasks directement\n    if (completedTasks.length > 0) {\n        const tasksWithResponse = completedTasks.filter(t => t.response && t.response.length > 10);\n        if (tasksWithResponse.length > 0) {\n            // Prendre la meilleure\n            const best = tasksWithResponse.sort((a, b) => (b.confidence || 0) - (a.confidence || 0))[0];\n            finalResponse = best.response;\n            confidence = best.confidence || 0.5;\n            console.log(`[${traceId}] Fallback: used completed_tasks response`);\n        }\n    }\n}\n\n// === 4. DERNIER FALLBACK ===\nif (!finalResponse || finalResponse.length < 10) {\n    finalResponse = \"Je n'ai pas pu trouver d'information pertinente pour r√©pondre √† votre question. Pourriez-vous reformuler ?\";\n    confidence = 0.1;\n    console.log(`[${traceId}] Using default fallback message`);\n}\n\n// === 5. AJOUTER LES SOURCES ===\nlet sources = [];\ncompletedTasks.forEach(t => {\n    if (t.sources && Array.isArray(t.sources)) {\n        sources.push(...t.sources);\n    }\n});\n\n// D√©dupliquer\nconst uniqueSources = [];\nconst seenIds = new Set();\nfor (const s of sources) {\n    const id = s.id || s.source || JSON.stringify(s);\n    if (!seenIds.has(id)) {\n        seenIds.add(id);\n        uniqueSources.push(s);\n    }\n}\n\n// Formater avec sources\nlet formattedResponse = finalResponse;\nif (uniqueSources.length > 0) {\n    formattedResponse += '\\n\\n---\\n**Sources:**\\n';\n    formattedResponse += uniqueSources.slice(0, 5).map((s, i) => {\n        const name = s.source || s.id || 'Document';\n        const score = s.score ? ` (${(s.score * 100).toFixed(0)}%)` : '';\n        return `[${i + 1}] ${name}${score}`;\n    }).join('\\n');\n}\n\n// Note si confiance faible\nif (confidence < 0.4) {\n    formattedResponse += '\\n\\n*‚ö†Ô∏è Confiance mod√©r√©e - v√©rifiez les informations.*';\n}\n\nconsole.log(`[${traceId}] Final response: ${formattedResponse.length} chars, confidence: ${confidence.toFixed(2)}`);\n\n// === 6. OUTPUT ===\nreturn {\n    final_response: formattedResponse,\n    chat_message: formattedResponse,  // Pour Chat: Final V8\n    confidence: confidence,\n    sources: uniqueSources.slice(0, 10),\n    sources_count: uniqueSources.length,\n    trace_id: traceId,\n    is_chat: isChat,\n    original_query: originalQuery,\n    \n    // Stats\n    tasks_completed: completedTasks.length,\n    responses_merged: allResponses.length,\n    \n    // Debug\n    _debug: {\n        input_had_final_response: !!inputData.final_response,\n        input_completed_count: inputData.completed_tasks?.length || 0,\n        input_responses_count: inputData.all_responses?.length || 0\n    }\n};\n"
      },
      "id": "161210a8-05be-4341-b5ac-b58a79026c32",
      "name": "Response Builder V9",
      "type": "n8n-nodes-base.code",
      "position": [
        24144,
        22112
      ],
      "typeVersion": 2,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO rlhf_training_data (conversation_id, query, response, feedback_score, feedback_type, reasoning_path, is_good_example, is_bad_example, needs_review) \nVALUES ($1, $2, $3, $4, 'implicit', $5, $6, $7, $8) \nON CONFLICT DO NOTHING",
        "options": {
          "queryReplacement": "={{ [\n  $('Init V8 Security & Analysis').item.json.conversation_id,\n  $('Init V8 Security & Analysis').item.json.query,\n  $('Response Builder V9').item.json.final_response,\n  $('Response Builder V9').item.json.confidence || 0.5,\n  JSON.stringify($('Response Builder V9').item.json.reasoning_path || {}),\n  ($('Response Builder V9').item.json.confidence || 0.5) > 0.7,\n  ($('Response Builder V9').item.json.confidence || 0.5) < 0.3,\n  true\n] }}"
        }
      },
      "id": "9b24efe5-41c2-42ea-889a-b704ece3b592",
      "name": "Store RLHF Data V8",
      "type": "n8n-nodes-base.postgres",
      "position": [
        24400,
        22512
      ],
      "typeVersion": 2.4,
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "set",
        "key": "={{ 'conv:' + $node['Init V8 Security & Analysis'].json.conversation_id }}",
        "value": "={{ JSON.stringify({ history: [...(($node['üì¶ Context Compression V10.1'].json?.compressed_history) || []), { query: $node['Init V8 Security & Analysis'].json.query, response: $node['Response Builder V9'].json.final_response, timestamp: new Date().toISOString() }].slice(-10), cache: { [$node['Init V8 Security & Analysis'].json.query_hash]: { response: $node['Response Builder V9'].json.final_response, timestamp: new Date().toISOString() } } }) }}"
      },
      "id": "d5455c64-0042-471f-88f1-d8a64c8d26ff",
      "name": "Redis: Store Conv V8",
      "type": "n8n-nodes-base.redis",
      "position": [
        24384,
        21984
      ],
      "typeVersion": 1,
      "credentials": {
        "redis": {
          "id": "O2KEPiv7VzgDG5ZX",
          "name": "Redis Upstash"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO conversation_context (conversation_id, tenant_id, entities_json, last_intent, updated_at) VALUES ($1, $2, $3, $4, NOW()) ON CONFLICT (conversation_id, tenant_id) DO UPDATE SET entities_json = $3, last_intent = $4, updated_at = NOW()",
        "options": {
          "queryReplacement": "={{ [\n  $('Init V8 Security & Analysis').first().json.conversation_id,\n  $('Init V8 Security & Analysis').first().json.tenant_id || 'default',\n  JSON.stringify($('üì¶ Context Compression V10.1').first().json.entities_of_interest || {}),\n  $('üîç Query Classifier V10.1').first().json.query_route || 'UNKNOWN'\n] }}"
        }
      },
      "id": "8fe8eadb-9f5d-421c-bbb5-798d1966e937",
      "name": "Postgres: Update Context V8",
      "type": "n8n-nodes-base.postgres",
      "position": [
        24384,
        22240
      ],
      "typeVersion": 2.4,
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 1
          },
          "conditions": [
            {
              "id": "is-chat-final",
              "leftValue": "={{ $('Response Builder V9').item.json.is_chat }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "looseTypeValidation": true
        }
      },
      "id": "fcc058cf-79a3-4c2c-a27a-e57e4b7d0c5b",
      "name": "Output Router (Final)",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        25088,
        22192
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $('Response Builder V9').item.json.chat_message }}",
        "options": {}
      },
      "id": "55f180e4-5489-47b0-97fe-de50a127cc48",
      "name": "Chat: Final V8",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        25264,
        22048
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"response\": {{ $('Response Builder V9').item.json.final_response ? JSON.stringify($('Response Builder V9').item.json.final_response) : '\"\"' }},\n  \"confidence\": {{ $('Response Builder V9').item.json.confidence || 0 }},\n  \"trace_id\": {{ $('Response Builder V9').item.json.trace_id ? JSON.stringify($('Response Builder V9').item.json.trace_id) : '\"\"' }},\n  \"version\": \"V8.0-CoT\",\n  \"perf\": {{ $('Response Builder V9').item.json.perf ? JSON.stringify($('Response Builder V9').item.json.perf) : '{}' }},\n  \"reasoning_path\": {{ $('Response Builder V9').item.json.reasoning_path ? JSON.stringify($('Response Builder V9').item.json.reasoning_path) : '{}' }}\n}",
        "options": {}
      },
      "id": "906694a2-098b-480b-9705-8c9f6fa397f3",
      "name": "Return Response V8",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [
        25264,
        22256
      ],
      "typeVersion": 1.1
    },
    {
      "parameters": {},
      "id": "3b1040f3-8d0e-4a98-9bf1-6a54193a3aa9",
      "name": "Error Handler V8",
      "type": "n8n-nodes-base.errorTrigger",
      "position": [
        16528,
        22544
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "jsCode": "// Error Payload Builder V8\nconst error = $json.error || { message: 'Unknown error' };\nlet traceId = 'unknown';\ntry { traceId = $node['Init V8 Security & Analysis'].json?.trace_id; } catch(e) {}\n\nreturn {\n  event_id: `err-${Date.now()}`,\n  trace_id: traceId,\n  timestamp: new Date().toISOString(),\n  level: 'error',\n  message: error.message,\n  stack: error.stack?.substring(0, 1000),\n  context: {\n    workflow: $workflow.name,\n    node: $prevNode?.name,\n    execution_id: $execution.id\n  },\n  user_input: '[REDACTED]',\n  version: 'V8.0-CoT'\n};"
      },
      "id": "3a540e97-79d1-4d12-ac5b-ca731b3374b8",
      "name": "Error Payload V8",
      "type": "n8n-nodes-base.code",
      "position": [
        16704,
        22544
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $vars.SENTRY_DSN || 'https://sentry.io/api/ingest' }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json }}",
        "options": {
          "timeout": 5000
        }
      },
      "id": "f7a8b350-4099-442a-b35e-fa2e64e74c32",
      "name": "Export Error V8",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        16896,
        22544
      ],
      "typeVersion": 4.3,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": false,\n  \"response\": \"An error occurred while processing your request. Please try again.\",\n  \"error\": {{ JSON.stringify($json.message || 'Internal workflow error') }},\n  \"trace_id\": {{ JSON.stringify($json.trace_id || '') }},\n  \"version\": \"V8.0-CoT\"\n}",
        "options": {
          "responseCode": 200
        }
      },
      "id": "err-respond-v8-001",
      "name": "Return: Error Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        17088,
        22544
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1/chat/completions' }}",
        "authentication": "none",
        "nodeCredentialType": "openRouterApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"{{ $vars.LLM_INTENT_MODEL || 'meta-llama/llama-3.3-70b-instruct:free' }}\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are the INTENT ANALYZER of a sophisticated multi-engine RAG system.\\n\\n=== YOUR MISSION ===\\n1. Analyze the user query\\n2. Identify ALL intents (explicit AND implicit)\\n3. Determine DEPENDENCIES between intents\\n4. Assign the optimal RAG engine for each intent\\n\\n=== AVAILABLE RAG ENGINES ===\\n\\n**STANDARD (Pinecone + BM25)**\\n- Hybrid document retrieval (dense + sparse)\\n- topK=20, Cohere reranking\\n- Latency: ~3s\\n- Strengths: facts, procedures, definitions, technical documentation\\n- Weaknesses: poor for precise numbers, complex relationships\\n\\n**GRAPH (Neo4j)**\\n- Multi-hop traversal (4 levels max)\\n- Community detection, intelligent pruning\\n- Latency: ~5s\\n- Strengths: relationships, hierarchies, impacts, multi-hop reasoning, bridging facts across entities\\n- Weaknesses: no quantitative data, slow for simple queries\\n- USE FOR ANY question that requires CHAINING 2+ facts across different entities or documents:\\n  * 'Who voices the character named after X?' (chain: X -> character -> voice actor)\\n  * 'In what year did the founder of X die?' (chain: X -> founder -> death year)\\n  * 'What country is the birthplace of the director of film Y located in?' (chain: Y -> director -> birthplace -> country)\\n  * 'Which film has the director who died first?' (chain: film -> director -> death date, compare)\\n  * Any question mentioning a person/place/org indirectly through another entity\\n- CRITICAL: If answering requires looking up entity A to find entity B, then looking up entity B to find the answer, this is GRAPH, NOT STANDARD\\n- When in doubt between STANDARD and GRAPH, prefer GRAPH for questions about people, places, organizations, or historical facts that involve indirect references\\n\\n**QUANTITATIVE (PostgreSQL)**\\n- Automatic SQL generation with self-healing\\n- Access to tables: sales, employees, products, kpis\\n- Latency: ~4s\\n- Strengths: numbers, totals, averages, comparisons, KPIs, trends\\n- Weaknesses: no narrative text, requires structured data\\n\\n=== PRIORITIZATION RULES ===\\n1. Numbers/totals/averages/KPIs -> QUANTITATIVE\\n2. Simple factual lookups (single entity, direct answer) -> STANDARD\\n3. Multi-hop chains (answer requires 2+ fact lookups) -> GRAPH\\n4. If the question refers to an entity INDIRECTLY (e.g. 'the founder of X', 'the director of Y', 'the birthplace of Z') -> GRAPH\\n5. Comparisons between entities (which is older, who died first) -> GRAPH\\n6. Questions about people, places, orgs connected through events/works -> GRAPH\\n7. If two intents are INDEPENDENT, mark 'can_parallelize': true\\n8. When unsure between STANDARD and GRAPH, choose GRAPH\\n\\n=== STRICT JSON FORMAT ===\\nRespond ONLY with this JSON, no text before/after:\\n{\\n  \\\"reasoning\\\": \\\"<your step-by-step analysis in 2-3 sentences>\\\",\\n  \\\"intents\\\": [\\n    {\\n      \\\"id\\\": \\\"intent-1\\\",\\n      \\\"description\\\": \\\"<what the user wants to know>\\\",\\n      \\\"type\\\": \\\"FACTUAL|QUANTITATIVE|RELATIONAL|PROCEDURAL|COMPARATIVE\\\",\\n      \\\"suggested_rag\\\": \\\"STANDARD|GRAPH|QUANTITATIVE\\\",\\n      \\\"priority\\\": 1,\\n      \\\"depends_on\\\": [],\\n      \\\"can_parallelize_with\\\": [\\\"intent-X\\\"]\\n    }\\n  ],\\n  \\\"execution_order\\\": [\\\"intent-1\\\"],\\n  \\\"has_parallel_intents\\\": false,\\n  \\\"complexity\\\": \\\"SIMPLE|MODERATE|COMPLEX\\\"\\n}\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"=== QUERY TO ANALYZE ===\\n{{ $node['Init V8 Security & Analysis'].json.query }}\"\n    }\n  ],\n  \"temperature\": 0.1,\n  \"max_tokens\": 800\n}",
        "options": {
          "timeout": 8000,
          "retry": {
            "maxTries": 1,
            "waitBetweenTries": 1000
          }
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
            }
          ]
        }
      },
      "id": "5a69dda9-8989-4837-87f4-69f6ea39e462",
      "name": "üß† LLM 1: Intent Analyzer",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        19840,
        22304
      ],
      "credentials": {},
      "continueOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Intent Parser V9.1 - Parse LLM 1 output avec support parall√©lisation\nconst llmResponse = $json;\nconst initData = $node['Init V8 Security & Analysis'].json;\nconst guardrailData = $node['üõ°Ô∏è Advanced Guardrails'].json;\n\nlet intentsData;\ntry {\n  const content = llmResponse.body?.choices?.[0]?.message?.content \n               || llmResponse.choices?.[0]?.message?.content || '{}';\n  intentsData = JSON.parse(content);\n} catch (e) {\n  // Fallback: single intent based on router\n  intentsData = {\n    reasoning: 'Fallback due to parsing error: ' + e.message,\n    intents: [{\n      id: 'intent-1',\n      description: initData.query,\n      type: 'FACTUAL',\n      suggested_rag: guardrailData.engine || 'STANDARD',\n      priority: 1,\n      depends_on: [],\n      can_parallelize_with: []\n    }],\n    execution_order: ['intent-1'],\n    has_parallel_intents: false,\n    complexity: 'SIMPLE'\n  };\n}\n\n// Validate intents\nconst validRags = ['STANDARD', 'GRAPH', 'QUANTITATIVE'];\nintentsData.intents = (intentsData.intents || []).map((intent, idx) => ({\n  ...intent,\n  id: intent.id || `intent-${idx + 1}`,\n  suggested_rag: validRags.includes(intent.suggested_rag) ? intent.suggested_rag : 'STANDARD',\n  priority: intent.priority || idx + 1,\n  depends_on: Array.isArray(intent.depends_on) ? intent.depends_on : [],\n  can_parallelize_with: Array.isArray(intent.can_parallelize_with) ? intent.can_parallelize_with : []\n}));\n\n// Determine if parallel execution is possible\nconst hasParallel = intentsData.has_parallel_intents || \n  intentsData.intents.some(i => i.can_parallelize_with?.length > 0);\n\n// Output format for LLM 2\nreturn {\n  trace_id: initData.trace_id,\n  original_query: initData.query,\n  user_context: initData.user_context,\n  \n  // Intent analysis\n  intents: intentsData.intents,\n  execution_order: intentsData.execution_order || intentsData.intents.map(i => i.id),\n  reasoning: intentsData.reasoning,\n  complexity: intentsData.complexity || 'MODERATE',\n  \n  // Parallelization info\n  has_parallel_intents: hasParallel,\n  \n  // Pass through\n  is_chat: $node['Input Merger V8'].json.is_chat,\n  is_webhook: $node['Input Merger V8'].json.is_webhook,\n  conversation_id: initData.conversation_id\n};"
      },
      "id": "bdea704a-e190-4948-b5df-8452da164e03",
      "name": "Intent Parser V9",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        20032,
        22304
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1/chat/completions' }}",
        "authentication": "none",
        "nodeCredentialType": "openRouterApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"{{ $vars.LLM_PLANNER_MODEL || 'meta-llama/llama-3.3-70b-instruct:free' }}\",\n  \"temperature\": 0.2,\n  \"max_tokens\": 500,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": {{ JSON.stringify(`You are the TASK PLANNER of a multi-engine RAG system. You receive analyzed intents and must create an optimal execution plan.\n\n=== DETAILED RAG ENGINE CAPABILITIES ===\n\n**STANDARD (RAG Multi-Index V3.4)**\n- Technology: Pinecone (1536 dims) + BM25 sparse\n- Retrieval: HyDE (hypothetical document), optional Query Decomposition\n- Reranking: Cohere rerank-multilingual-v3\n- topK: 20 chunks, ~500 tokens/chunk\n- Latency: 2-4 seconds\n- OPTIMAL FOR: Factual questions, procedures, definitions, technical documentation\n- AVOID FOR: precise numbers, hierarchical relationships\n\n**GRAPH (Neo4j Graph RAG V3.3)**\n- Technology: Neo4j + 4-hop traversal\n- Capabilities: community detection, path finding, pruning\n- Entities: Person, Team, Project, Document, Skill\n- Relations: WORKS_IN, MANAGES, REPORTS_TO, CONTRIBUTES_TO\n- Latency: 3-6 seconds\n- OPTIMAL FOR: Relationships, hierarchies, impacts, org charts, multi-hop reasoning, entity traversal, comparison between entities\n- AVOID FOR: numbers, long narrative text\n\n**QUANTITATIVE (SQL RAG V2.0)**\n- Technology: PostgreSQL + Text-to-SQL (CoT)\n- Self-healing: automatic SQL correction\n- Tables: sales, employees, products, kpis\n- Latency: 2-5 seconds\n- OPTIMAL FOR: Totals, averages, comparisons, KPIs, trends\n- AVOID FOR: text, non-numeric relationships\n\n=== PLANNING RULES ===\n1. PARALLELIZATION: If two tasks have NO dependency, same parallel_group (max 3)\n2. DEPENDENCIES: A task needing another's result -> depends_on\n3. SKIP CONDITIONS: If one answer can cover multiple intents -> if_success_covers\n4. FALLBACKS: Always provide a fallback_rag DIFFERENT from target_rag\n\n=== RECEIVED INTENTS ===\n${JSON.stringify($json.intents, null, 2)}\n\n=== SUGGESTED ORDER ===\n${$json.execution_order.join(' -> ')}\n\n=== PARALLELIZABLE INTENTS ===\n${$json.has_parallel_intents ? 'YES' : 'NO'}\n\n=== ORIGINAL QUERY ===\n${$json.original_query}\n\n=== STRICT JSON FORMAT ===\nRespond ONLY with this JSON:\n{\n  \"plan_id\": \"plan-<timestamp>\",\n  \"reasoning\": \"<your reasoning in 2-3 sentences>\",\n  \"execution_mode\": \"SEQUENTIAL|PARALLEL|MIXED\",\n  \"parallel_groups\": [{\"group_id\": 1, \"task_ids\": [1, 2], \"reason\": \"...\"}],\n  \"tasks\": [\n    {\n      \"task_id\": 1,\n      \"intent_id\": \"intent-1\",\n      \"query\": \"<query OPTIMIZED for this RAG>\",\n      \"target_rag\": \"STANDARD|GRAPH|QUANTITATIVE\",\n      \"fallback_rag\": \"STANDARD|GRAPH|QUANTITATIVE\",\n      \"parallel_group\": null,\n      \"depends_on_task\": null,\n      \"success_criteria\": {\"min_confidence\": 0.6, \"min_sources\": 1},\n      \"if_success_covers\": []\n    }\n  ],\n  \"total_tasks\": 1,\n  \"estimated_latency_ms\": 3000\n}`) }}\n    }\n  ]\n}",
        "options": {
          "timeout": 10000,
          "retry": {
            "maxTries": 1,
            "waitBetweenTries": 1000
          }
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
            }
          ]
        }
      },
      "id": "a2123ca5-27d8-41d5-85c1-a8c6dd96c1d2",
      "name": "üéØ LLM 2: Task Planner",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        20256,
        22304
      ],
      "credentials": {},
      "continueOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "content": "# üîß CONFIGURATION SOTA 2026\n## Variables d'environnement requises\n\n### APIs (cl√©s requises)\n- `DEEPSEEK_API_KEY` - api.deepseek.com\n- `ANTHROPIC_API_KEY` - planning complexe\n- `GOOGLE_API_KEY` - Gemini Flash (optionnel)\n\n### Mod√®les LLM (optionnel, d√©fauts inclus)\n- `SQL_MODEL` = deepseek-chat (BIRD-SQL 72.3%)\n- `INTENT_MODEL` = deepseek-chat\n- `PLANNING_MODEL` = claude-sonnet-4-5\n- `GENERATION_MODEL` = deepseek-chat\n- `ROUTER_MODEL` = gemini-2.0-flash\n\n### Embedding (FORTEMENT RECOMMAND√â)\n- `EMBEDDING_API_URL` ‚Üí self-hosted Qwen3\n- `EMBEDDING_MODEL` = Qwen3-Embedding-8B\n- Impact: +15 pts MTEB vs text-embedding-3-small\n\n### Reranking (FORTEMENT RECOMMAND√â)\n- `RERANKER_API_URL` ‚Üí self-hosted Qwen3\n- `RERANKER_MODEL` = Qwen3-Reranker-8B\n- Impact: +2 pts BEIR, $0 vs $2/1k\n\n### Impact √©conomique estim√©:\n- Ingestion: -89% co√ªt\n- Requ√™tes: -95% co√ªt\n- Qualit√© SQL: +3%\n- Qualit√© retrieval: +15%",
        "height": 804,
        "width": 188
      },
      "id": "dae9fb50-b9e9-44c8-9f01-82fe249bb3ed",
      "name": "üìã Config SOTA 2026",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        16320,
        21360
      ]
    },
    {
      "parameters": {
        "jsCode": "// === RATE LIMIT GUARD - Post Redis Cache ===\nconst redisData = $json;\nconst initData = $node['Init V8 Security & Analysis'].json;\nconst conversationHistory = redisData.conversation_history || [];\nconst now = Date.now();\nconst traceId = initData.trace_id;\n\n// Analyser les timestamps des messages r√©cents\nconst recentWindow = 60000; // 1 minute\nconst recentMessages = conversationHistory.filter(msg => \n  msg.timestamp && (now - msg.timestamp) < recentWindow\n);\n\n// Rate limit: max 10 messages par minute\nconst MAX_REQUESTS_PER_MINUTE = 10;\nconst isRateLimited = recentMessages.length >= MAX_REQUESTS_PER_MINUTE;\n\n// Pattern abuse detection: plus de 5 messages en 10 secondes\nconst veryRecentMessages = conversationHistory.filter(msg =>\n  msg.timestamp && (now - msg.timestamp) < 10000\n);\nconst isAbuse = veryRecentMessages.length > 5;\n\nif (isRateLimited || isAbuse) {\n  console.log(`[${traceId}] RATE LIMITED: ${recentMessages.length} req/min, ${veryRecentMessages.length} req/10s`);\n  \n  return {\n    rate_limited: true,\n    blocked_until: now + recentWindow,\n    message: \"Rate limit exceeded. Please slow down your requests.\",\n    recent_count: recentMessages.length,\n    abuse_detected: isAbuse,\n    trace_id: traceId\n  };\n}\n\n// Pas de rate limit - passer les donn√©es\nreturn {\n  rate_limited: false,\n  ...redisData,\n  trace_id: traceId\n};\n"
      },
      "id": "f5371300-cc52-4f1b-aad6-f95d8d67eaf3",
      "name": "üõ°Ô∏è Rate Limit Guard",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        17520,
        22384
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.rate_limited }}",
              "value2": true
            }
          ]
        },
        "options": {}
      },
      "id": "479a0220-29c2-42a9-8374-ccf4ca47c4aa",
      "name": "IF: Rate Limited?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        17696,
        22384
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $json.message }}",
        "options": {}
      },
      "id": "e84e2158-ce59-4d66-90af-07526b4fb5da",
      "name": "Return: Rate Limited",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        17904,
        22400
      ]
    },
    {
      "parameters": {
        "jsCode": "// === CACHE PARSER - V√©rifie hit/miss ===\nconst redisResult = $json;\nconst initData = $node['Init V8 Security & Analysis'].json;\n\nlet cacheHit = false;\nlet cachedResponse = null;\n\ntry {\n    if (redisResult && redisResult.value) {\n        const cached = JSON.parse(redisResult.value);\n        const cacheAge = Date.now() - (cached.timestamp || 0);\n        \n        // Cache valide si < 1h\n        if (cacheAge < 3600000) {\n            cacheHit = true;\n            cachedResponse = cached.response;\n            console.log(`[${initData.trace_id}] Cache HIT: ${initData.query_hash}`);\n        } else {\n            console.log(`[${initData.trace_id}] Cache expired: ${cacheAge}ms old`);\n        }\n    }\n} catch (e) {\n    console.log(`[${initData.trace_id}] Cache parse error: ${e.message}`);\n}\n\nreturn {\n    cache_hit: cacheHit,\n    cached_response: cachedResponse,\n    query: initData.query,\n    query_hash: initData.query_hash,\n    trace_id: initData.trace_id\n};\n"
      },
      "id": "6afac6d0-4023-43ae-9b7e-76fd1f199862",
      "name": "Cache Parser",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        19072,
        21888
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "e0d9ad14-ed75-46a4-a1bf-d804801bd1c0",
              "leftValue": "={{ $json.cached_response }}",
              "rightValue": "Null",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            },
            {
              "id": "a61487b3-0cc9-470c-af6b-e4e5b57f1538",
              "leftValue": "",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "cd442267-b982-44c2-af3e-cd85bad12a24",
      "name": "IF: Cache Hit?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        19216,
        21888
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $json.cached_response + '\\n\\n_üöÄ R√©ponse en cache_' }}",
        "options": {}
      },
      "id": "4fbc2f9b-57a0-4004-9305-ae5b50045464",
      "name": "Return: Cached",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        19408,
        21888
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "CREATE TABLE IF NOT EXISTS rag_task_executions (\n  id SERIAL PRIMARY KEY,\n  trace_id VARCHAR(255) NOT NULL,\n  task_id INTEGER NOT NULL,\n  intent_id VARCHAR(255),\n  status VARCHAR(50) DEFAULT 'pending',\n  rag_called VARCHAR(50),\n  attempt INTEGER DEFAULT 1,\n  query TEXT,\n  response TEXT,\n  error_message TEXT,\n  sources JSONB,\n  confidence FLOAT,\n  created_at TIMESTAMP DEFAULT NOW(),\n  updated_at TIMESTAMP DEFAULT NOW(),\n  UNIQUE(trace_id, task_id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_task_status ON rag_task_executions(trace_id, status);\nCREATE INDEX IF NOT EXISTS idx_task_attempt ON rag_task_executions(trace_id, task_id, attempt);\n",
        "options": {}
      },
      "id": "ea82be59-7036-4626-acfd-11822f852c0f",
      "name": "Postgres: Init Tasks Table",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        20592,
        22448
      ],
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "continueOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// FORMAT & DISPATCH V10.2 - MULTI-INTENT FIXED\n// ============================================\n\nvar plannerRawOutput = $json;\nvar traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nvar originalQuery = $node['Init V8 Security & Analysis'].json.query;\n\nvar RAG_MAPPING = {\n  'standard': 'STANDARD',\n  'graph': 'GRAPH',\n  'quantitative': 'QUANTITATIVE'\n};\n\nfunction normalizeRAGName(ragName) {\n  if (!ragName) return 'STANDARD';\n  var key = String(ragName).toLowerCase().trim();\n  if (RAG_MAPPING[key]) return RAG_MAPPING[key];\n  return String(ragName).toUpperCase();\n}\n\nvar tasks = [];\nvar plannerData = null;\n\n// === 1. PARSER LA R√âPONSE LLM 2 ===\ntry {\n  var contentString = '';\n  \n  // Support OpenRouter format\n  if (plannerRawOutput.choices && plannerRawOutput.choices[0] && \n      plannerRawOutput.choices[0].message && plannerRawOutput.choices[0].message.content) {\n    contentString = plannerRawOutput.choices[0].message.content;\n  }\n  // Support Anthropic format\n  else if (plannerRawOutput.content && plannerRawOutput.content[0] && \n           plannerRawOutput.content[0].text) {\n    contentString = plannerRawOutput.content[0].text;\n  }\n  \n  // Nettoyer les markdown code blocks\n  contentString = contentString.replace(/```json/g, '').replace(/```/g, '').trim();\n  \n  // Parser le JSON\n  plannerData = JSON.parse(contentString);\n  \n  if (plannerData && plannerData.tasks && Array.isArray(plannerData.tasks)) {\n    tasks = plannerData.tasks;\n    console.log('[' + traceId + '] Parsed ' + tasks.length + ' tasks from LLM 2');\n  }\n  \n} catch (parseError) {\n  console.error('[' + traceId + '] LLM 2 parse error: ' + parseError.message);\n  // Continue vers le fallback\n}\n\n// === 2. FALLBACK : CR√âER UNE T√ÇCHE PAR INTENT ===\nif (tasks.length === 0) {\n  console.log('[' + traceId + '] Fallback: creating tasks from Intent Parser');\n  \n  var intentData = $node['Intent Parser V9'].json;\n  var intents = intentData.intents || [];\n  \n  if (intents.length > 0) {\n    // Cr√©er une t√¢che pour CHAQUE intent\n    for (var i = 0; i < intents.length; i++) {\n      var intent = intents[i];\n      \n      tasks.push({\n        task_id: i + 1,\n        intent_id: intent.id || ('intent-' + (i + 1)),\n        // Utiliser la description de l'intent OU la query optimis√©e\n        query: intent.query || intent.description || originalQuery,\n        target_rag: intent.suggested_rag || 'STANDARD',\n        fallback_rag: 'STANDARD',\n        parallel_group: intent.can_parallelize_with && intent.can_parallelize_with.length > 0 ? 1 : null\n      });\n    }\n    \n    console.log('[' + traceId + '] Created ' + tasks.length + ' tasks from ' + intents.length + ' intents');\n  } else {\n    // Dernier fallback : une seule t√¢che g√©n√©rique\n    tasks = [{\n      task_id: 1,\n      intent_id: 'intent-1',\n      query: originalQuery,\n      target_rag: 'STANDARD',\n      fallback_rag: 'GRAPH'\n    }];\n    \n    console.log('[' + traceId + '] Ultimate fallback: single generic task');\n  }\n}\n\n// === 3. CONSTRUIRE tasksToInsert ===\nvar tasksToInsert = [];\n\nfor (var i = 0; i < tasks.length; i++) {\n  var task = tasks[i];\n  \n  // R√©cup√©rer le RAG cible\n  var targetRag = task.target_rag || task.rag || 'STANDARD';\n  var normalizedRAG = normalizeRAGName(targetRag);\n  \n  // √âchapper les quotes pour PostgreSQL\n  var cleanQuery = String(task.query || originalQuery).replace(/'/g, \"''\");\n  \n  tasksToInsert.push({\n    trace_id: traceId,\n    task_id: task.task_id || (i + 1),\n    intent_id: task.intent_id || ('intent-' + (i + 1)),\n    status: 'pending',\n    rag_called: normalizedRAG,\n    attempt: 1,\n    query: cleanQuery,\n    response: null,\n    error_message: null,\n    sources: null,\n    confidence: task.success_criteria ? task.success_criteria.min_confidence : 0.8\n  });\n}\n\nconsole.log('[' + traceId + '] Final output: ' + tasksToInsert.length + ' tasks ready for DB');\n\n// === 4. OUTPUT ===\nreturn {\n  trace_id: traceId,\n  tasks_to_insert: tasksToInsert,\n  total_tasks: tasksToInsert.length,\n  execution_mode: plannerData ? (plannerData.execution_mode || 'SEQUENTIAL') : 'SEQUENTIAL',\n  parallel_groups: plannerData ? (plannerData.parallel_groups || []) : [],\n  // Debug info\n  _debug: {\n    parser_success: plannerData !== null,\n    fallback_used: tasks.length === 0,\n    original_task_count: tasks.length\n  }\n};"
      },
      "id": "6e28b992-6c41-495d-a21d-812ec7120d63",
      "name": "üìù Format & Dispatch (Plan‚ÜíDB)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        20832,
        22304
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO rag_task_executions \n  (trace_id, task_id, intent_id, status, rag_called, attempt, query, confidence)\nVALUES {{ $json.tasks_to_insert.map(t => \n  `('${t.trace_id}', ${t.task_id}, '${t.intent_id}', '${t.status}', '${t.rag_called}', ${t.attempt}, '${t.query}', ${t.confidence})`\n).join(', ') }}\nON CONFLICT (trace_id, task_id) DO UPDATE \nSET status = 'pending', updated_at = NOW();\n",
        "options": {}
      },
      "id": "dd492a5d-32aa-4a72-9d90-7c9253e6f228",
      "name": "Postgres: Insert Tasks",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        21024,
        22304
      ],
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "continueOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// PATCH - Execution Engine V10.9\n// FIX 1: Passe correctement les donn√©es √† Response Builder\n// FIX 2: Marque le workflow comme termin√© pour √©viter re-trigger\n// ============================================\n\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nconst originalQuery = $node['Init V8 Security & Analysis'].json.query;\nconst isChat = $node['Input Merger V8'].json.is_chat || false;\n\n// === 1. ANTI-LOOP avec staticData ===\nconst staticData = $getWorkflowStaticData('global');\n\n// Check si d√©j√† termin√©\nconst completeKey = `complete_${traceId}`;\nif (staticData[completeKey]) {\n    console.log(`[${traceId}] ‚ö†Ô∏è Workflow d√©j√† termin√© - ignoring re-trigger`);\n    // Retourner un objet vide pour ne pas continuer\n    return [];\n}\n\n// Counter de boucle\nif (!staticData.loopCounters) {\n    staticData.loopCounters = {};\n}\nconst loopKey = `loop_${traceId}`;\nif (!staticData.loopCounters[loopKey]) {\n    staticData.loopCounters[loopKey] = 0;\n}\nstaticData.loopCounters[loopKey]++;\n\nconst currentIteration = staticData.loopCounters[loopKey];\nconst MAX_ITERATIONS = 10;\n\nconsole.log(`[${traceId}] Execution Engine V10.9 - iteration ${currentIteration}/${MAX_ITERATIONS}`);\n\n// === 2. SAFETY - Max iterations ===\nif (currentIteration > MAX_ITERATIONS) {\n    console.error(`[${traceId}] MAX ITERATIONS - Breaking!`);\n    staticData[completeKey] = true;  // Marquer comme termin√©\n    delete staticData.loopCounters[loopKey];\n    \n    return {\n        all_complete: true,\n        trace_id: traceId,\n        is_chat: isChat,\n        original_query: originalQuery,\n        completed_tasks: [],\n        all_responses: [],\n        final_response: \"Erreur: limite d'it√©rations atteinte.\",\n        error: \"MAX_ITERATIONS_EXCEEDED\"\n    };\n}\n\n// === 3. LECTURE DES T√ÇCHES ===\nlet dbTasks = [];\nlet currentTask = null;\nlet isFromFallback = false;\n\n// Check fallback\ntry {\n    const fallbackData = $node['üîÑ Fallback Dispatch']?.json;\n    if (fallbackData?.current_task?.status === 'pending') {\n        currentTask = fallbackData.current_task;\n        isFromFallback = true;\n        console.log(`[${traceId}] From fallback: task ${currentTask.task_id}`);\n    }\n} catch (e) {}\n\n// Lecture depuis input\nif (!currentTask) {\n    try {\n        const allItems = $input.all();\n        if (allItems?.length > 0) {\n            dbTasks = allItems.map(item => item.json).filter(t => t && t.task_id);\n            console.log(`[${traceId}] Read ${dbTasks.length} tasks from input`);\n        }\n    } catch (e) {\n        const inputData = $json;\n        if (Array.isArray(inputData)) {\n            dbTasks = inputData;\n        } else if (inputData?.task_id) {\n            dbTasks = [inputData];\n        }\n    }\n    \n    // Fallback premi√®re ex√©cution\n    if (dbTasks.length === 0) {\n        try {\n            dbTasks = $node['üìù Format & Dispatch (Plan‚ÜíDB)'].json.tasks_to_insert || [];\n            console.log(`[${traceId}] First run: ${dbTasks.length} tasks`);\n        } catch (e) {}\n    }\n}\n\n// === 4. ANALYSE DES T√ÇCHES ===\nif (!currentTask && dbTasks.length > 0) {\n    const pendingTasks = dbTasks.filter(t => t.status === 'pending');\n    const completedTasks = dbTasks.filter(t => t.status === 'complete');\n    const errorTasks = dbTasks.filter(t => t.status === 'error');\n    const skippedTasks = dbTasks.filter(t => t.status === 'skipped');\n    \n    const total = dbTasks.length;\n    \n    console.log(`[${traceId}] Tasks: ${pendingTasks.length} pending, ${completedTasks.length} complete, ${skippedTasks.length} skipped, ${errorTasks.length} error`);\n    \n    // === 5. ALL COMPLETE ===\n    if (pendingTasks.length === 0) {\n        console.log(`[${traceId}] ‚úÖ ALL COMPLETE - routing to Response Builder`);\n        \n        // MARQUER COMME TERMIN√â pour √©viter re-trigger\n        staticData[completeKey] = true;\n        delete staticData.loopCounters[loopKey];\n        \n        // Formatter les r√©sultats pour Response Builder\n        const formattedCompleted = completedTasks.map(t => {\n            let sources = t.sources || [];\n            if (typeof sources === 'string') {\n                try { sources = JSON.parse(sources); } catch (e) { sources = []; }\n            }\n            return {\n                task_id: t.task_id,\n                rag_called: t.rag_called,\n                query: t.query,\n                response: t.response || '',\n                confidence: parseFloat(t.confidence) || 0.5,\n                sources: sources\n            };\n        });\n        \n        // Construire all_responses\n        const allResponses = formattedCompleted\n            .filter(t => t.response && t.response.length > 10)\n            .map(t => ({\n                task_id: t.task_id,\n                rag: t.rag_called,\n                response: t.response,\n                confidence: t.confidence\n            }));\n        \n        // Calculer la meilleure r√©ponse\n        let bestResponse = '';\n        let bestConfidence = 0;\n        for (const resp of allResponses) {\n            if (resp.confidence > bestConfidence) {\n                bestConfidence = resp.confidence;\n                bestResponse = resp.response;\n            }\n        }\n        \n        console.log(`[${traceId}] Best response: ${bestResponse.length} chars, confidence ${bestConfidence}`);\n        \n        // === OUTPUT COMPLET POUR RESPONSE BUILDER ===\n        return {\n            all_complete: true,\n            trace_id: traceId,\n            is_chat: isChat,\n            original_query: originalQuery,\n            \n            // Donn√©es pour Response Builder\n            completed_tasks: formattedCompleted,\n            all_responses: allResponses,\n            pending_tasks: [],\n            error_tasks: errorTasks.map(t => ({\n                task_id: t.task_id,\n                rag_called: t.rag_called,\n                error_message: t.error_message || 'Unknown'\n            })),\n            skipped_tasks: skippedTasks.map(t => ({\n                task_id: t.task_id,\n                rag_called: t.rag_called\n            })),\n            \n            // Pr√©-calculer pour Response Builder\n            final_response: bestResponse,\n            confidence: bestConfidence,\n            \n            // Stats\n            total_tasks: total,\n            summary: {\n                completed: completedTasks.length,\n                pending: 0,\n                errors: errorTasks.length,\n                skipped: skippedTasks.length\n            }\n        };\n    }\n    \n    // === 6. NEXT TASK ===\n    currentTask = pendingTasks[0];\n    console.log(`[${traceId}] Next: task ${currentTask.task_id} ‚Üí ${currentTask.rag_called}`);\n}\n\n// === 7. VALIDATION ===\nif (!currentTask?.rag_called) {\n    console.error(`[${traceId}] No valid task found`);\n    staticData[completeKey] = true;\n    \n    return {\n        all_complete: true,\n        trace_id: traceId,\n        is_chat: isChat,\n        original_query: originalQuery,\n        completed_tasks: [],\n        all_responses: [],\n        final_response: \"Aucune t√¢che valide trouv√©e.\",\n        error: \"NO_VALID_TASK\"\n    };\n}\n\n// === 8. NORMALIZE RAG ===\nconst ragName = String(currentTask.rag_called).toUpperCase().trim();\nconst validRags = ['STANDARD', 'GRAPH', 'QUANTITATIVE'];\nconst normalizedRag = validRags.includes(ragName) ? ragName : 'STANDARD';\n\nconsole.log(`[${traceId}] Executing: ${normalizedRag}`);\n\n// === 9. OUTPUT POUR DYNAMIC SWITCH ===\nreturn {\n    all_complete: false,\n    trace_id: traceId,\n    is_chat: isChat,\n    original_query: originalQuery,\n    \n    current_task: {\n        ...currentTask,\n        rag_called: normalizedRag,\n        trace_id: traceId\n    },\n    route_to: normalizedRag,\n    task_id: currentTask.task_id,\n    task_query: currentTask.query,\n    attempt: currentTask.attempt || 1,\n    is_fallback: isFromFallback,\n    iteration: currentIteration\n};\n"
      },
      "id": "e234ca05-5574-404b-b92b-43f9db307ae7",
      "name": "‚öôÔ∏è Execution Engine V10",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        21376,
        22288
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.route_to }}",
                    "rightValue": "STANDARD",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a54bbcc1-b6ef-4975-b887-1b300668f194"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.route_to }}",
                    "rightValue": "GRAPH",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "21dd21c6-f1b2-4d94-addf-2480f828b96f"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.route_to }}",
                    "rightValue": "QUANTITATIVE",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "06843e71-20ab-456a-a49f-4f17db5ff26e"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "none"
        }
      },
      "id": "2813f987-c594-4ae1-9942-9fbeadd78b9d",
      "name": "üîÄ Dynamic Switch V10",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        21616,
        22400
      ]
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// PATCH - Task Result Handler V10.1.3\n// FIX: Parsing robuste multi-format + fallback_response\n// ============================================\n//\n// PROBL√àMES R√âSOLUS:\n// 1. Ne lisait pas le format fallback_response du Standard RAG\n// 2. Graph RAG: pas de v√©rification du flag fallback\n// 3. Confidence toujours √† 0 car mauvais parsing\n//\n// INSTRUCTIONS:\n// 1. Ouvrir workflow \"V10.1 orchestrator copy\" (FZxkpldDbgV8AD_cg7IWG)\n// 2. √âditer le n≈ìud \"üì• Task Result Handler\"\n// 3. Remplacer tout le code par celui-ci\n// 4. Sauvegarder et tester\n// ============================================\n\nconst workflowResult = $json;\nconst currentTask = $node['‚öôÔ∏è Execution Engine V10'].json.current_task;\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\n\nlet response = '';\nlet sources = [];\nlet confidence = 0;\nlet error = null;\nlet success = false;\nlet formatDetected = 'unknown';\n\n// === FORMAT 0: Fallback Response (Standard RAG skip_llm=true) ===\nif (workflowResult.fallback_response) {\n  formatDetected = 'fallback_response';\n  response = workflowResult.fallback_response.response || '';\n  sources = workflowResult.fallback_response.sources || [];\n  confidence = workflowResult.fallback_response.confidence || 0.1;\n  success = response.length > 10;\n}\n// === FORMAT 1: Standard RAG direct (avec engine marker) ===\nelse if (workflowResult.engine === 'STANDARD' && workflowResult.response) {\n  formatDetected = 'standard_rag';\n  response = workflowResult.response;\n  sources = (workflowResult.sources || []).map(s => ({\n    source: s.source || 'document',\n    content: s.excerpt || s.content || '',\n    score: s.score || s.combined_score || 0\n  }));\n  confidence = workflowResult.confidence || 0.5;\n  success = response.length > 10;\n}\n// === FORMAT 2: Graph RAG nested (budgeted_context) ===\nelse if (workflowResult.status === 'SUCCESS' && workflowResult.response) {\n  const nestedResponse = workflowResult.response;\n  \n  if (nestedResponse.budgeted_context) {\n    formatDetected = 'graph_rag';\n    const ctx = nestedResponse.budgeted_context;\n    \n    // Check for fallback mode (no real graph traversal)\n    const isFallback = nestedResponse.fallback === true;\n    const traversalDepth = nestedResponse.traversal_depth || 0;\n    const hasGraphData = ctx.graph && ctx.graph.length > 0;\n    const hasRelationships = ctx.relationships && ctx.relationships.length > 10;\n    const hasValidData = hasGraphData || hasRelationships;\n    \n    if (isFallback || (!hasValidData && traversalDepth === 0)) {\n      // Graph traversal failed - mark as failure to trigger fallback\n      success = false;\n      error = `Graph RAG fallback: no data (fallback=${isFallback}, depth=${traversalDepth})`;\n      console.log(`[${traceId}] Graph RAG returned no useful data - will trigger fallback`);\n    } else {\n      response = ctx.relationships || '';\n      \n      // Combine graph and vector sources\n      const graphSources = (ctx.graph || []).map(s => ({\n        source: s.source || s.id || 'graph_entity',\n        content: s.content || s.properties || '',\n        type: 'graph'\n      }));\n      const vectorSources = (ctx.vector || []).map(s => ({\n        source: s.source || s.id || 'vector_doc',\n        content: s.content || '',\n        type: 'vector'\n      }));\n      sources = [...graphSources, ...vectorSources];\n      confidence = 0.6;\n      success = response.length > 10 || sources.length > 0;\n    }\n  } else {\n    // Graph RAG returned SUCCESS with direct response (no budgeted_context wrapper)\n    formatDetected = 'graph_rag_direct';\n    if (typeof nestedResponse === 'string') {\n      response = nestedResponse;\n    } else if (typeof nestedResponse === 'object') {\n      response = nestedResponse.text || nestedResponse.answer || nestedResponse.content || JSON.stringify(nestedResponse);\n    }\n    const meta = workflowResult.metadata || {};\n    confidence = meta.confidence || 0.5;\n    sources = [];\n    // If metadata has source info, create a source entry\n    if (meta.source) {\n      sources.push({ source: meta.source, content: '', type: 'graph' });\n    }\n    success = response && String(response).trim().length > 10;\n  }\n}\n// === FORMAT 3: Quantitative RAG (SQL interpretation) ===\nelse if (workflowResult.interpretation) {\n  formatDetected = 'quantitative_rag';\n  response = workflowResult.interpretation;\n  sources = (workflowResult.raw_results || []).map((r, i) => ({\n    source: `SQL Result ${i + 1}`,\n    content: JSON.stringify(r).substring(0, 500),\n    type: 'sql'\n  }));\n  confidence = 0.7;\n  success = true;\n}\n// === FORMAT 4: Generic response (simple format) ===\nelse if (workflowResult.response) {\n  formatDetected = 'generic';\n  response = typeof workflowResult.response === 'string' \n    ? workflowResult.response \n    : JSON.stringify(workflowResult.response);\n  sources = workflowResult.sources || [];\n  confidence = workflowResult.confidence || 0.5;\n  success = response.length > 10;\n}\n// === FORMAT 5: Answer field (some workflows) ===\nelse if (workflowResult.answer) {\n  formatDetected = 'answer_field';\n  response = workflowResult.answer;\n  sources = [];\n  confidence = 0.5;\n  success = response.length > 10;\n}\n// === FORMAT 6: Explicit error ===\nelse if (workflowResult.error || workflowResult.errorMessage) {\n  formatDetected = 'error';\n  error = workflowResult.error || workflowResult.errorMessage;\n  if (typeof error === 'object') {\n    error = error.message || JSON.stringify(error);\n  }\n  success = false;\n}\n// === FORMAT 7: Empty result (no documents) ===\nelse if (workflowResult.result_count === 0 || workflowResult.has_results === false) {\n  formatDetected = 'empty_result';\n  response = \"Aucun document pertinent trouv√©.\";\n  confidence = 0.1;\n  success = false; // Trigger fallback\n}\n// === FORMAT 8: Unrecognized ===\nelse {\n  formatDetected = 'unrecognized';\n  console.log(`[${traceId}] Unrecognized format. Keys: ${Object.keys(workflowResult).join(', ')}`);\n  \n  // Try to extract anything useful\n  const possibleResponse = workflowResult.text || workflowResult.content || workflowResult.output || '';\n  if (possibleResponse && possibleResponse.length > 10) {\n    response = possibleResponse;\n    confidence = 0.3;\n    success = true;\n  } else {\n    success = false;\n    error = 'Unrecognized response format';\n  }\n}\n\n// === VALIDATION FINALE ===\nconst hasValidResponse = response && String(response).trim().length > 10;\nconst finalSuccess = success && (hasValidResponse || sources.length > 0);\n\n// Ensure confidence is a valid number\nif (typeof confidence !== 'number' || isNaN(confidence)) {\n  confidence = finalSuccess ? 0.5 : 0.1;\n}\n\nconsole.log(`[${traceId}] Task ${currentTask.task_id} (${currentTask.rag_called}): ${finalSuccess ? 'SUCCESS' : 'FAILED'}`);\nconsole.log(`[${traceId}]   Format: ${formatDetected}, Response: ${response.length} chars, Sources: ${sources.length}, Confidence: ${confidence.toFixed(4)}`);\n\nif (error) {\n  console.log(`[${traceId}]   Error: ${error}`);\n}\n\n// === OUTPUT ===\nreturn {\n  task: currentTask,\n  success: finalSuccess,\n  response: response,\n  sources: sources.slice(0, 10),\n  confidence: confidence,\n  error_message: error,\n  trace_id: traceId,\n  format_detected: formatDetected,\n  raw_result: workflowResult // Pour debug\n};"
      },
      "id": "69968841-95e5-4717-9acd-9a80d2b3a215",
      "name": "üì• Task Result Handler",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        22128,
        22336
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE rag_task_executions\nSET \n  status = $1,\n  response = $2,\n  error_message = $3,\n  sources = $4::jsonb,\n  updated_at = NOW()\nWHERE trace_id = $5 \n  AND task_id = $6",
        "options": {
          "queryReplacement": "={{ [$json.success ? 'complete' : 'error', $json.response || '', $json.error_message || '', JSON.stringify($json.sources || []), $json.trace_id, $json.task.task_id] }}"
        }
      },
      "id": "6bd0234e-efea-4e89-8cf5-3448af22cbda",
      "name": "Postgres: Update Task",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        22224,
        21744
      ],
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "continueOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// === FALLBACK MONITOR V10.2 - SIMPLIFIED: Accept any response with content ===\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nconst taskHandlerData = $node['üì• Task Result Handler'].json;\nconst currentTask = taskHandlerData.task || {};\n\nconst response = taskHandlerData.response || '';\nconst confidence = taskHandlerData.confidence || 0;\nconst attempt = currentTask.attempt || 1;\nconst taskId = currentTask.task_id;\nconst originalSuccess = taskHandlerData.success || false;\n\n// SIMPLIFIED: Accept if we have ANY response text, regardless of length or confidence\nconst hasAnyResponse = response && String(response).trim().length > 0;\nconst success = hasAnyResponse || originalSuccess;\n\nconsole.log(`[${traceId}] Task ${taskId} - success=${success}, response_len=${String(response).length}, confidence=${confidence}, attempt=${attempt}`);\n\nif (success) {\n  // No fallback needed\n  return {\n    fallback_needed: false,\n    task_id: taskId,\n    current_rag: currentTask.rag_called,\n    response: response,\n    confidence: confidence,\n    trace_id: traceId,\n    task: currentTask\n  };\n}\n\n// Only fallback if truly no response AND first attempt\nif (attempt >= 2) {\n  console.log(`[${traceId}] Task ${taskId} - Max attempts reached, accepting even empty response`);\n  return {\n    fallback_needed: false,\n    task_id: taskId,\n    current_rag: currentTask.rag_called,\n    response: response || \"Unable to retrieve information\",\n    confidence: 0.1,\n    trace_id: traceId,\n    task: currentTask\n  };\n}\n\n// Determine fallback RAG\nconst currentRag = currentTask.rag_called || 'STANDARD';\nconst FALLBACK_MAP = {\n  'QUANTITATIVE': 'STANDARD',\n  'GRAPH': 'STANDARD',\n  'STANDARD': 'GRAPH'\n};\nconst nextRag = FALLBACK_MAP[currentRag] || 'STANDARD';\n\nreturn {\n  fallback_needed: true,\n  task_id: taskId,\n  current_rag: currentRag,\n  next_rag: nextRag,\n  attempt: attempt + 1,\n  failure_reason: 'empty_response',\n  original_query: $node['Init V8 Security & Analysis'].json.query,\n  trace_id: traceId,\n  task: currentTask\n};"
      },
      "id": "760a5d3c-6e1e-4d91-aff1-eb0cf96a1c4e",
      "name": "üîÑ Fallback Monitor V10",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        22400,
        21744
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "id-1",
              "leftValue": "={{ $json.fallback_needed }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "67332e02-80d8-4dfc-9d94-d1427dcefd26",
      "name": "IF: Fallback Needed?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        22576,
        21744
      ]
    },
    {
      "parameters": {
        "jsCode": "// === FALLBACK DISPATCH V10.1.2 - Pr√©paration compl√®te pour retry ===\nconst fb = $json;\nconst traceId = fb.trace_id;\n\nconsole.log(`[${traceId}] Dispatching fallback: task ${fb.task_id} ‚Üí ${fb.next_rag} (attempt ${fb.attempt})`);\n\n// Construire une t√¢che compl√®te pour le retry\nconst retriedTask = {\n  task_id: fb.task_id,\n  trace_id: traceId,\n  intent_id: fb.task?.intent_id || 'fallback',\n  status: 'pending',\n  rag_called: fb.next_rag,\n  attempt: fb.attempt,\n  query: fb.original_query,\n  confidence: 0.8,\n  // M√©tadonn√©es de fallback\n  is_fallback: true,\n  previous_rag: fb.current_rag,\n  failure_reason: fb.failure_reason\n};\n\nreturn {\n  // Pour Postgres: Update Fallback\n  trace_id: traceId,\n  task_id: fb.task_id,\n  new_status: 'pending',\n  new_rag: fb.next_rag,\n  new_attempt: fb.attempt,\n  \n  // Pour Dynamic Switch (route_to)\n  route_to: fb.next_rag,\n  \n  // T√¢che compl√®te pour Execution Engine\n  current_task: retriedTask,\n  task_query: fb.original_query,\n  \n  // Pour debug\n  fallback_chain: [fb.current_rag, fb.next_rag],\n  all_complete: false\n};"
      },
      "id": "2aaeab2f-9a91-421e-b4a2-b9c9ab19b7be",
      "name": "üîÑ Fallback Dispatch",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        22800,
        21776
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE rag_task_executions\nSET \n  status = 'pending',\n  rag_called = '{{ $json.new_rag }}',\n  attempt = {{ $json.new_attempt }},\n  updated_at = NOW()\nWHERE trace_id = '{{ $json.trace_id }}' \n  AND task_id = {{ $json.task_id }};\n",
        "options": {}
      },
      "id": "960461ba-c688-4993-98ec-1ea16be7d883",
      "name": "Postgres: Update Fallback",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        22960,
        21776
      ],
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "continueOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// === CACHE STORAGE - Stocke les r√©ponses simples ===\nconst finalResponse = $node['Response Builder V9'].json.final_response;\nconst initData = $node['Init V8 Security & Analysis'].json;\n\n// Pr√©parer les donn√©es de cache\nconst cacheKey = `faq:${initData.query_hash}`;\nconst cacheValue = JSON.stringify({\n  response: finalResponse,\n  timestamp: Date.now(),\n  query: initData.query\n});\n\nconsole.log(`[${initData.trace_id}] Storing in cache: ${cacheKey}`);\n\nreturn {\n  cache_key: cacheKey,\n  cache_value: cacheValue,\n  ttl: 3600,\n  trace_id: initData.trace_id\n};"
      },
      "id": "ca85038c-26c6-4002-b9c1-b231dc51e10f",
      "name": "üíæ Cache Storage",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        24320,
        22816
      ]
    },
    {
      "parameters": {
        "operation": "set",
        "key": "={{ $json.cache_key }}",
        "value": "={{ $json.cache_value }}",
        "keyType": "string",
        "expire": true,
        "ttl": "={{ $json.ttl }}"
      },
      "id": "c295072a-deaf-494d-84c7-6b569fc810e4",
      "name": "Redis: Set Cache",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        24512,
        22816
      ],
      "credentials": {
        "redis": {
          "id": "O2KEPiv7VzgDG5ZX",
          "name": "Redis Upstash"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// NODE: üß† Memory Merger V10.1 (FIXED)\n// PURPOSE: Fusion Redis + Postgres avec gestion erreurs\n// ============================================\n\n// === 1. R√âCUP√âRER REDIS DATA ===\nlet redisData = {};\ntry {\n  redisData = $node['üõ°Ô∏è Redis Failure Handler V10.1']?.json || {};\n} catch(e) {\n  console.log('Redis Failure Handler not found, trying raw Redis');\n  try {\n    redisData = $node['Redis: Fetch Conversation']?.json || {};\n    // Fallback parsing\n    if (redisData.data) {\n      try {\n        const parsed = JSON.parse(redisData.data || '{}');\n        redisData = {\n          conversation_history: parsed.history || [],\n          redis_available: true\n        };\n      } catch(e2) {\n        redisData = { conversation_history: [], redis_available: true };\n      }\n    }\n  } catch(e2) {\n    redisData = { conversation_history: [], redis_available: false };\n  }\n}\n\nconst initData = $node['Init V8 Security & Analysis'].json;\nconst traceId = redisData.trace_id || initData.trace_id;\n\n// Historique court terme (Redis)\nconst shortTermHistory = redisData.conversation_history || [];\n\n// === 2. R√âCUP√âRER POSTGRES DATA (AVEC GESTION ERREURS) ===\nlet postgresData = {};\nlet postgresAvailable = false;\n\ntry {\n  const pgResult = $node['Postgres L2/L3 Memory']?.json;\n  \n  // V√©rifications multiples\n  if (pgResult && \n      !pgResult.error && \n      pgResult.entities_json !== null && \n      pgResult.entities_json !== undefined) {\n    \n    postgresData = pgResult;\n    postgresAvailable = true;\n    console.log(`[${traceId}] Postgres L2/L3 OK`);\n    \n  } else if (pgResult?.error) {\n    console.warn(`[${traceId}] Postgres L2/L3 ERROR:`, pgResult.error.message || pgResult.error);\n  } else {\n    console.log(`[${traceId}] Postgres L2/L3 empty (new user)`);\n  }\n  \n} catch (e) {\n  console.error(`[${traceId}] Postgres L2/L3 exception:`, e.message);\n}\n\n// === 3. FUSIONNER INTELLIGEMMENT ===\nlet entitiesJson = {};\nif (postgresData.entities_json) {\n  if (typeof postgresData.entities_json === 'string') {\n    try {\n      entitiesJson = JSON.parse(postgresData.entities_json);\n    } catch(e) {\n      entitiesJson = {};\n    }\n  } else {\n    entitiesJson = postgresData.entities_json;\n  }\n}\n\nconst lastIntent = postgresData.last_intent || 'UNKNOWN';\n\n// Construire contexte fusionn√©\nconst mergedContext = {\n  recent_messages: shortTermHistory.slice(-10),\n  user_profile: postgresData.user_context || {},\n  user_preferences: postgresData.preferences || {},\n  entities_of_interest: entitiesJson,\n  last_intent: lastIntent,\n  conversation_id: initData.conversation_id,\n  session_id: initData.session_id,\n  trace_id: traceId,\n  query: initData.query,\n  query_hash: initData.query_hash,\n  redis_available: redisData.redis_available !== false,\n  postgres_available: postgresAvailable,\n  context_status: redisData.context_status || 'UNKNOWN'\n};\n\nconsole.log(`[${traceId}] Memory merged: ${shortTermHistory.length} msgs (Redis), ${postgresAvailable ? 'Postgres OK' : 'Postgres unavailable'}`);\n\nreturn mergedContext;"
      },
      "id": "771afac4-90da-4e02-a8e8-d4032075bb64",
      "name": "üß† Memory Merger (Redis + Postgres)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        17696,
        21888
      ]
    },
    {
      "parameters": {
        "jsCode": "// === ADVANCED GUARDRAILS - Prompt Injection, Jailbreak, Content Safety ===\nconst mergedContext = $json;\nconst query = mergedContext.query || '';\nconst traceId = mergedContext.trace_id;\n\n// Patterns de prompt injection\nconst INJECTION_PATTERNS = [\n  /ignore (previous|all) (instructions|prompts)/i,\n  /you are now|pretend (you are|to be)/i,\n  /system:|<\\|im_start\\|>|<\\|im_end\\|>/i,\n  /\\n\\nHuman:|\\n\\nAssistant:/i,\n  /<script|javascript:|onerror=|eval\\(/i,\n  /forget (everything|all)|disregard (previous|all)/i\n];\n\n// Patterns de jailbreak\nconst JAILBREAK_PATTERNS = [\n  /DAN|Do Anything Now/i,\n  /evil mode|developer mode/i,\n  /sudo mode|admin mode/i,\n  /without any (restrictions|limitations|ethical)/i\n];\n\n// Patterns de contenu sensible\nconst SENSITIVE_PATTERNS = [\n  /how to (make|create|build) (bomb|weapon|explosive)/i,\n  /hack|exploit|vulnerability|backdoor/i,\n  /(illegal|illicit) (drugs|substances)/i\n];\n\n// V√©rifications\nconst hasInjection = INJECTION_PATTERNS.some(p => p.test(query));\nconst hasJailbreak = JAILBREAK_PATTERNS.some(p => p.test(query));\nconst hasSensitive = SENSITIVE_PATTERNS.some(p => p.test(query));\n\nconst isBlocked = hasInjection || hasJailbreak || hasSensitive;\n\nlet blockReason = null;\nif (hasInjection) blockReason = \"prompt_injection\";\nif (hasJailbreak) blockReason = \"jailbreak_attempt\";\nif (hasSensitive) blockReason = \"sensitive_content\";\n\nif (isBlocked) {\n  console.log(`[${traceId}] BLOCKED: ${blockReason}`);\n}\n\nreturn {\n  ...mergedContext,\n  guardrail_passed: !isBlocked,\n  guardrail_blocked: isBlocked,\n  block_reason: blockReason,\n  injection_detected: hasInjection,\n  jailbreak_detected: hasJailbreak,\n  sensitive_detected: hasSensitive\n};\n"
      },
      "id": "5195d53f-ba51-4531-a015-08d5a22b67ed",
      "name": "üõ°Ô∏è Advanced Guardrails",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        17888,
        21888
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.guardrail_passed }}",
              "value2": true
            }
          ]
        },
        "options": {}
      },
      "id": "dac0a336-6e67-4b4c-b5ae-80ff733d4414",
      "name": "IF: Guardrail Passed?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        18080,
        21888
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "I cannot respond to this request because it contains inappropriate or potentially harmful content.",
        "options": {}
      },
      "id": "b6bd01b0-8d5f-47d3-9c7d-98de8d2e77ae",
      "name": "Return: Guardrail Blocked",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        18256,
        21952
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.query_route }}",
                    "rightValue": "conversational",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "09b9e899-fec1-4e05-a4ba-58262fb5c072"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.query_route }}",
                    "rightValue": "cache_check",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "52bd6b24-bf82-48ff-b1aa-4d8266ade86f"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "dae8b9a1-a47c-490e-93d2-549bf166c3ab",
                    "leftValue": "={{ $json.query_route }}",
                    "rightValue": "direct_llm",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "id": "3a29a41a-fe91-4c3d-bce6-ddc3206f734b",
      "name": "üîÄ Query Router",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        18528,
        21808
      ]
    },
    {
      "parameters": {
        "jsCode": "// === CONVERSATIONAL HANDLER - R√©ponses directes conversationnelles ===\nconst context = $json;\nconst query = context.query.toLowerCase().trim();\nconst traceId = context.trace_id;\n\n// R√©ponses template\nconst RESPONSES = {\n  'hi': \"Bonjour ! Comment puis-je vous aider aujourd'hui ?\",\n  'hello': \"Hello! How can I assist you today?\",\n  'bonjour': \"Bonjour ! Je suis l√† pour vous aider. Que puis-je faire pour vous ?\",\n  'thanks': \"De rien ! N'h√©sitez pas si vous avez d'autres questions.\",\n  'thank you': \"You're welcome! Feel free to ask if you need anything else.\",\n  'merci': \"Avec plaisir ! Je reste √† votre disposition.\",\n  'bye': \"Au revoir ! √Ä bient√¥t.\",\n  'goodbye': \"Goodbye! Have a great day!\",\n  'ok': \"D'accord ! Y a-t-il autre chose ?\",\n  'yes': \"Parfait ! Que puis-je faire d'autre pour vous ?\",\n  'no': \"D'accord, n'h√©sitez pas si vous changez d'avis.\"\n};\n\n// Trouver la r√©ponse\nlet response = \"Je suis l√† pour vous aider. Que puis-je faire pour vous ?\";\nfor (const [pattern, resp] of Object.entries(RESPONSES)) {\n  if (query.includes(pattern)) {\n    response = resp;\n    break;\n  }\n}\n\nconsole.log(`[${traceId}] Conversational response generated`);\n\nreturn {\n  trace_id: traceId,\n  query: context.query,\n  response: response,\n  is_conversational: true,\n  conversation_id: context.conversation_id\n};\n"
      },
      "id": "b7212bb1-ec8d-45c3-b19a-919acd65f460",
      "name": "üí¨ Conversational Handler",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        18768,
        21712
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $json.response }}",
        "options": {}
      },
      "id": "bb985081-d04e-41eb-a725-5169e456ad02",
      "name": "Return: Conversational",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        18928,
        21744
      ]
    },
    {
      "parameters": {
        "jsCode": "// === CACHE SEMANTIC SEARCH - Trouve questions similaires ===\nconst context = $json;\nconst query = context.query;\nconst queryHash = context.query_hash;\nconst traceId = context.trace_id;\n\n// Note: Ici on simule une recherche s√©mantique\n// En production, on utiliserait un vector store (Pinecone, Qdrant, etc.)\n// ou Redis avec RedisSearch/RediSearch VSS\n\n// Pour l'instant, on checke juste le hash exact\n// Le node Redis suivant fera le vrai travail\n\nreturn {\n  ...context,\n  cache_search_query: queryHash,\n  semantic_search_enabled: true\n};\n"
      },
      "id": "8211b2d7-c032-4617-adcf-037d1b8c0b27",
      "name": "üîé Cache Semantic Search",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        18768,
        21920
      ]
    },
    {
      "parameters": {
        "operation": "get",
        "key": "={{ 'faq:' + $json.query_hash }}",
        "options": {}
      },
      "id": "97a611eb-b47f-4066-b00d-6b0a6cda5650",
      "name": "Redis: Cache + Generator",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        18944,
        21920
      ],
      "credentials": {
        "redis": {
          "id": "O2KEPiv7VzgDG5ZX",
          "name": "Redis Upstash"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1/chat/completions' }}",
        "authentication": "none",
        "nodeCredentialType": "openRouterApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"model\": $vars.LLM_AGENT_MODEL || 'meta-llama/llama-3.3-70b-instruct:free',\n  \"max_tokens\": 500,\n  \"temperature\": 0.3,\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are the JUDGE of a multi-engine RAG system. Your role is to decide if the obtained results are sufficient to answer the user's question.\\n\\n=== YOUR ROLE ===\\n1. Analyze the user's ORIGINAL QUERY\\n2. Examine the OBTAINED RESPONSES from completed tasks\\n3. JUDGE whether these responses are sufficient to answer the query\\n4. Decide what to do with remaining pending tasks\\n\\n=== YOUR POSSIBLE DECISIONS ===\\n\\n**all_tasks_complete: true** ‚Üí The obtained responses are sufficient to answer the user\\n- Set all pending tasks to SKIP\\n- The workflow will generate the final response\\n\\n**all_tasks_complete: false** ‚Üí Information is still missing\\n- KEEP necessary pending tasks\\n- SKIP redundant pending tasks\\n- Optional: ADD new tasks\\n\\n=== JSON RESPONSE FORMAT ===\\n{\\n  \\\"all_tasks_complete\\\": true/false,\\n  \\\"judgment\\\": \\\"Explanation of why responses are sufficient or not\\\",\\n  \\\"actions\\\": [\\n    {\\\"action\\\": \\\"SKIP\\\", \\\"task_id\\\": 2, \\\"reason\\\": \\\"...\\\"},\\n    {\\\"action\\\": \\\"KEEP\\\", \\\"task_id\\\": 3, \\\"reason\\\": \\\"...\\\"}\\n  ],\\n  \\\"missing_info\\\": \\\"What is missing if all_tasks_complete=false\\\"\\n}\\n\\n=== RULES ===\\n- You MUST provide an action for EVERY pending task\\n- If all_tasks_complete=true, ALL pending tasks must be SKIP\\n- Do NOT handle fallbacks/errors (another system handles that)\\n- Respond ONLY with valid JSON\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"=== USER'S ORIGINAL QUERY ===\\n\" + $node['Init V8 Security & Analysis'].json.query + \"\\n\\n=== OBTAINED RESPONSES (completed tasks) ===\\n\" + JSON.stringify($node['üìä Task Status Aggregator'].json.completed_tasks || [], null, 2) + \"\\n\\n=== PENDING TASKS ===\\n\" + JSON.stringify($node['üìä Task Status Aggregator'].json.pending_tasks || [], null, 2) + \"\\n\\n=== ERROR TASKS ===\\n\" + JSON.stringify($node['üìä Task Status Aggregator'].json.error_tasks || [], null, 2) + \"\\n\\nAnalyze whether the obtained responses are sufficient to answer the original query. Return your decision in JSON.\"\n    }\n  ]\n} }}",
        "options": {
          "timeout": 8000,
          "retry": {
            "maxTries": 1,
            "waitBetweenTries": 1000
          }
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
            }
          ]
        }
      },
      "id": "65630655-5b38-4faa-9a4d-a30faa4ce90a",
      "name": "üéØ LLM 3: Agent Harness (Opus 4.5)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        22944,
        22096
      ],
      "credentials": {},
      "continueOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// NODE: üìä Agent Decision Parser V10.3\n// PURPOSE: Parse LLM3 Agent Harness (JUGE) response\n// ============================================\n\nconst agentResponse = $json;\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\n\nlet decisions = null;\n\ntry {\n    // === 1. EXTRACT CONTENT FROM API RESPONSE ===\n    let content = '';\n    \n    // OpenRouter format: choices[0].message.content\n    if (agentResponse.choices?.[0]?.message?.content) {\n        content = agentResponse.choices[0].message.content;\n        console.log(`[${traceId}] Detected OpenRouter format`);\n    }\n    // Anthropic format: content[0].text\n    else if (agentResponse.content?.[0]?.text) {\n        content = agentResponse.content[0].text;\n        console.log(`[${traceId}] Detected Anthropic format`);\n    }\n    // Body wrapper (some API configs)\n    else if (agentResponse.body?.choices?.[0]?.message?.content) {\n        content = agentResponse.body.choices[0].message.content;\n        console.log(`[${traceId}] Detected wrapped OpenRouter format`);\n    }\n    // Anthropic body wrapper\n    else if (agentResponse.body?.content?.[0]?.text) {\n        content = agentResponse.body.content[0].text;\n        console.log(`[${traceId}] Detected wrapped Anthropic format`);\n    }\n    \n    if (!content) {\n        throw new Error('No content found in LLM response. Available keys: ' + Object.keys(agentResponse).join(', '));\n    }\n    \n    // === 2. CLEAN AND PARSE JSON ===\n    let cleanedContent = content.trim();\n    \n    // Remove markdown code blocks if present\n    cleanedContent = cleanedContent.replace(/```json\\s*/g, '').replace(/```\\s*/g, '');\n    \n    // Try to extract JSON object\n    const jsonMatch = cleanedContent.match(/\\{[\\s\\S]*\\}/);\n    if (jsonMatch) {\n        decisions = JSON.parse(jsonMatch[0]);\n    } else {\n        decisions = JSON.parse(cleanedContent);\n    }\n    \n    console.log(`[${traceId}] LLM3 Agent Harness parsed successfully`);\n    \n} catch (e) {\n    console.error(`[${traceId}] Agent parsing error: ${e.message}`);\n    console.error(`[${traceId}] Response structure: ${JSON.stringify(agentResponse, null, 2).substring(0, 500)}`);\n    \n    // Fallback: continue without modifications\n    decisions = {\n        all_tasks_complete: false,\n        judgment: 'Parse error - continuing with existing tasks',\n        actions: [],\n        missing_info: 'Unable to parse LLM3 response: ' + e.message\n    };\n}\n\n// === 3. EXTRACT DECISIONS ===\nconst allTasksComplete = decisions.all_tasks_complete === true;\nconst judgment = decisions.judgment || 'No judgment provided';\nconst actions = Array.isArray(decisions.actions) ? decisions.actions : [];\nconst missingInfo = decisions.missing_info || '';\n\n// === 4. LOGGING ===\nconsole.log(`[${traceId}] === LLM3 JUDGMENT ===`);\nconsole.log(`[${traceId}] all_tasks_complete: ${allTasksComplete}`);\nconsole.log(`[${traceId}] judgment: ${judgment}`);\nconsole.log(`[${traceId}] actions: ${actions.length}`);\n\nif (allTasksComplete) {\n    console.log(`[${traceId}] ‚úÖ LLM3 says: Responses are sufficient!`);\n} else {\n    console.log(`[${traceId}] ‚è≥ LLM3 says: Missing info: ${missingInfo}`);\n}\n\nactions.forEach((action, idx) => {\n    console.log(`[${traceId}]   Action ${idx + 1}: ${action.action} task_id=${action.task_id} - ${action.reason || 'no reason'}`);\n});\n\n// === 5. OUTPUT ===\nreturn {\n    trace_id: traceId,\n    \n    // Main signal for Task Updater\n    all_tasks_complete: allTasksComplete,\n    judgment: judgment,\n    missing_info: missingInfo,\n    \n    // Actions array for Task Updater\n    actions: actions,\n    \n    // Compatibility with old format\n    plan_updated: actions.length > 0,\n    reasoning: judgment,\n    \n    // Debug info\n    _debug: {\n        actions_count: actions.length,\n        has_skip_actions: actions.some(a => a.action === 'SKIP'),\n        has_keep_actions: actions.some(a => a.action === 'KEEP'),\n        has_add_actions: actions.some(a => a.action === 'ADD')\n    }\n};"
      },
      "id": "4e969cfa-9585-4d55-b7dc-3809bd6b3284",
      "name": "üìä Agent Decision Parser",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        23104,
        22096
      ]
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// PATCH - Task Updater V10.6\n// FIX: Ne reboucle PAS quand all_tasks_complete=true\n// ============================================\n//\n// PROBL√àME R√âSOLU:\n// Avant: Task Updater ‚Üí Postgres: Apply Skips ‚Üí Postgres: Get Current Tasks ‚Üí Execution Engine\n// Cela causait une boucle m√™me apr√®s que Response Builder ait fini!\n//\n// SOLUTION:\n// Quand all_tasks_complete=true, on NE FAIT PAS de skip dans la DB\n// car Execution Engine a d√©j√† rout√© vers Response Builder.\n// Les t√¢ches pending seront ignor√©es, pas besoin de les skipper.\n//\n// CHANGEMENT ARCHITECTURAL REQUIS:\n// Ajouter un IF node apr√®s Task Updater:\n// - Si all_tasks_complete=true ‚Üí NE PAS connecter √† Postgres: Apply Skips\n// - Si all_tasks_complete=false ‚Üí Connecter normalement\n// ============================================\n\nconst parsed = $json;\nconst traceId = parsed.trace_id;\n\nconst allTasksComplete = parsed.all_tasks_complete === true;\nconst judgment = parsed.judgment || '';\nconst actions = parsed.actions || [];\n\nconsole.log(`[${traceId}] Task Updater V10.6`);\nconsole.log(`[${traceId}] all_tasks_complete: ${allTasksComplete}`);\n\n// === CAS 1: TERMINAISON - NE PAS REBOUCLER ===\nif (allTasksComplete) {\n    console.log(`[${traceId}] ‚úÖ TERMINAISON D√âTECT√âE`);\n    console.log(`[${traceId}] Judgment: ${judgment}`);\n    console.log(`[${traceId}] ‚ö†Ô∏è NE PAS reboucler - Response Builder va g√©rer`);\n    \n    // IMPORTANT: On ne fait PAS de skip_updates\n    // Car on ne veut PAS trigger Postgres: Apply Skips ‚Üí Get Current Tasks ‚Üí Execution Engine\n    // Execution Engine a d√©j√† rout√© vers Response Builder via le IF node\n    \n    return {\n        trace_id: traceId,\n        all_tasks_complete: true,\n        should_loop: false,  // FLAG IMPORTANT pour le IF node\n        judgment: judgment,\n        skip_updates: [],    // VIDE - pas de reboucle\n        new_tasks: [],\n        total_skipped: 0,\n        total_added: 0,\n        has_pending_after: false\n    };\n}\n\n// === CAS 2: TRAVAIL RESTANT - Appliquer les actions ===\nconsole.log(`[${traceId}] ‚è≥ Travail restant, ${actions.length} actions`);\n\n// R√©cup√©rer les t√¢ches pending\nlet pendingTasks = [];\nlet maxTaskId = 0;\ntry {\n    const dbResult = $('Postgres : Get Current Tasks').all();\n    const dbTasks = dbResult.map(item => item.json);\n    pendingTasks = dbTasks.filter(t => t.status === 'pending');\n    dbTasks.forEach(t => {\n        if (t.task_id > maxTaskId) maxTaskId = t.task_id;\n    });\n} catch (e) {\n    console.log(`[${traceId}] DB read error: ${e.message}`);\n}\n\nconst skips = [];\nconst newTasks = [];\n\nfor (const action of actions) {\n    if (action.action === 'SKIP') {\n        skips.push({\n            task_id: action.task_id,\n            trace_id: traceId,\n            reason: action.reason || 'LLM3 decision',\n            new_status: 'skipped'\n        });\n        console.log(`[${traceId}] SKIP task ${action.task_id}`);\n        \n    } else if (action.action === 'KEEP') {\n        console.log(`[${traceId}] KEEP task ${action.task_id}`);\n        \n    } else if (action.action === 'ADD' && action.new_task) {\n        const newTaskId = maxTaskId + newTasks.length + 1;\n        newTasks.push({\n            trace_id: traceId,\n            task_id: newTaskId,\n            intent_id: 'llm3_added',\n            status: 'pending',\n            rag_called: action.new_task.rag || 'STANDARD',\n            attempt: 1,\n            query: (action.new_task.query || '').replace(/'/g, \"''\"),\n            confidence: 0.8\n        });\n        console.log(`[${traceId}] ADD task ${newTaskId}`);\n    }\n}\n\nconst skippedIds = new Set(skips.map(s => s.task_id));\nconst remainingPending = pendingTasks.filter(t => !skippedIds.has(t.task_id));\nconst hasPendingAfter = remainingPending.length > 0 || newTasks.length > 0;\n\nconsole.log(`[${traceId}] Result: ${skips.length} skips, ${newTasks.length} adds, ${remainingPending.length} remaining`);\n\nreturn {\n    trace_id: traceId,\n    all_tasks_complete: false,\n    should_loop: true,  // FLAG pour le IF node - continuer la boucle\n    judgment: judgment,\n    skip_updates: skips,\n    new_tasks: newTasks,\n    total_skipped: skips.length,\n    total_added: newTasks.length,\n    has_pending_after: hasPendingAfter\n};\n"
      },
      "id": "04172aae-947d-4181-b3ca-cac2102249b3",
      "name": "üîÑ Task Updater",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        23280,
        22080
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "={{ $json.skip_updates && $json.skip_updates.length > 0 ? \n  \"UPDATE rag_task_executions SET status = 'skipped', updated_at = NOW() WHERE \" +\n  $json.skip_updates.map(s => `(trace_id = '${s.trace_id}' AND task_id = ${s.task_id})`).join(' OR ')\n  : \"SELECT 1\" \n}}",
        "options": {}
      },
      "id": "ba3d7b7d-adfb-423f-a43c-ce2b670484a2",
      "name": "Postgres: Apply Skips",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        23696,
        22208
      ],
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "continueOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "={{ $json.new_tasks && $json.new_tasks.length > 0 ? \"INSERT INTO rag_task_executions (trace_id, task_id, intent_id, status, rag_called, attempt, query, confidence) VALUES \" + $json.new_tasks.map(t => `('${t.trace_id}', ${t.task_id}, '${t.intent_id}', '${t.status}', '${t.rag_called}', ${t.attempt}, '${t.query}', ${t.confidence})`).join(', ') + \" ON CONFLICT (trace_id, task_id) DO NOTHING\" : \"SELECT 1\" }}",
        "options": {}
      },
      "id": "3501e6a9-d1e6-41c8-8298-1b310f2f05f0",
      "name": "Postgres: Insert New Tasks",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        23680,
        22416
      ],
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      },
      "continueOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// PATCH - Task Status Aggregator V10.4\n// FIX: Accumulation robuste des r√©sultats pour Response Builder\n// ============================================\n//\n// PROBL√àME R√âSOLU:\n// Le Response Builder V9.3 lit depuis staticData[`results_${traceId}`]\n// mais le Task Status Aggregator ne stockait pas toujours les r√©sultats.\n//\n// SOLUTION:\n// 1. Toujours lire le r√©sultat depuis Task Result Handler\n// 2. Toujours stocker dans staticData m√™me si pas de fallback\n// 3. Ajouter des logs pour debug\n//\n// INSTRUCTIONS:\n// 1. Ouvrir workflow \"V10.1 orchestrator copy\" (FZxkpldDbgV8AD_cg7IWG)\n// 2. √âditer le n≈ìud \"üìä Task Status Aggregator\"\n// 3. Remplacer tout le code par celui-ci\n// 4. Sauvegarder et tester\n// ============================================\n\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nconst inputData = $json; // Donn√©es du Fallback Monitor\n\nconsole.log(`[${traceId}] Task Status Aggregator V10.4 starting...`);\n\n// === 1. √âTAT GLOBAL POUR ACCUMULATION ===\nconst staticData = $getWorkflowStaticData('global');\n\nconst resultsKey = `results_${traceId}`;\nif (!staticData[resultsKey]) {\n  staticData[resultsKey] = {\n    completed_tasks: [],\n    error_tasks: [],\n    skipped_tasks: [],\n    all_responses: []\n  };\n  console.log(`[${traceId}] Initialized results storage`);\n}\n\nconst accumulated = staticData[resultsKey];\n\n// === 2. LIRE LE R√âSULTAT ACTUEL ===\n// IMPORTANT: Toujours lire depuis Task Result Handler\nlet currentResult = null;\n\ntry {\n  // Priorit√© 1: Lire directement depuis Task Result Handler\n  const taskHandlerData = $node['üì• Task Result Handler']?.json;\n  if (taskHandlerData) {\n    currentResult = {\n      task: taskHandlerData.task || {},\n      success: taskHandlerData.success || false,\n      response: taskHandlerData.response || '',\n      sources: taskHandlerData.sources || [],\n      confidence: taskHandlerData.confidence || 0,\n      error_message: taskHandlerData.error_message || null,\n      format_detected: taskHandlerData.format_detected || 'unknown'\n    };\n    console.log(`[${traceId}] Read from Task Result Handler: success=${currentResult.success}, format=${currentResult.format_detected}, response_length=${currentResult.response.length}`);\n  }\n} catch (e) {\n  console.log(`[${traceId}] Could not read Task Result Handler: ${e.message}`);\n}\n\n// Priorit√© 2: Fallback Monitor (si disponible dans input)\nif (!currentResult && inputData && inputData.success !== undefined) {\n  currentResult = {\n    task: inputData.task || { task_id: inputData.task_id },\n    success: inputData.success,\n    response: inputData.response || '',\n    sources: inputData.sources || [],\n    confidence: inputData.confidence || 0,\n    error_message: inputData.failure_reason || null\n  };\n  console.log(`[${traceId}] Read from Fallback Monitor input`);\n}\n\n// === 3. AJOUTER LE R√âSULTAT √Ä L'ACCUMULATION ===\nif (currentResult && currentResult.task) {\n  const taskId = currentResult.task.task_id;\n  const ragCalled = currentResult.task.rag_called || 'UNKNOWN';\n  \n  // √âviter les doublons\n  const existsCompleted = accumulated.completed_tasks.some(t => t.task_id === taskId);\n  const existsError = accumulated.error_tasks.some(t => t.task_id === taskId);\n  \n  if (!existsCompleted && !existsError) {\n    if (currentResult.success) {\n      const completedTask = {\n        task_id: taskId,\n        rag_called: ragCalled,\n        response: currentResult.response || '',\n        sources: currentResult.sources || [],\n        confidence: currentResult.confidence || 0.5\n      };\n      \n      accumulated.completed_tasks.push(completedTask);\n      \n      // Ajouter √† all_responses pour la fusion\n      if (currentResult.response && currentResult.response.length > 10) {\n        accumulated.all_responses.push({\n          task_id: taskId,\n          rag: ragCalled,\n          response: currentResult.response,\n          confidence: currentResult.confidence || 0.5\n        });\n      }\n      \n      console.log(`[${traceId}] ‚úÖ Accumulated completed task ${taskId} (${ragCalled}): ${currentResult.response.length} chars, confidence=${currentResult.confidence}`);\n    } else {\n      accumulated.error_tasks.push({\n        task_id: taskId,\n        rag_called: ragCalled,\n        error_message: currentResult.error_message || 'Unknown error'\n      });\n      \n      console.log(`[${traceId}] ‚ùå Accumulated error task ${taskId} (${ragCalled}): ${currentResult.error_message}`);\n    }\n  } else {\n    console.log(`[${traceId}] Task ${taskId} already accumulated, skipping`);\n  }\n} else {\n  console.log(`[${traceId}] No valid current result to accumulate`);\n}\n\n// === 4. LIRE LE PLAN ORIGINAL POUR LE TOTAL ===\nlet totalTasks = 1;\nlet pendingTasks = [];\n\ntry {\n  const planData = $node['üìù Format & Dispatch (Plan‚ÜíDB)'].json;\n  totalTasks = planData.total_tasks || planData.tasks_to_insert?.length || 1;\n  \n  // Calculer les pending\n  const completedIds = accumulated.completed_tasks.map(t => t.task_id);\n  const errorIds = accumulated.error_tasks.map(t => t.task_id);\n  const processedIds = [...completedIds, ...errorIds];\n  \n  const allTaskIds = (planData.tasks_to_insert || []).map(t => t.task_id);\n  pendingTasks = allTaskIds\n    .filter(id => !processedIds.includes(id))\n    .map(id => {\n      const task = planData.tasks_to_insert.find(t => t.task_id === id);\n      return {\n        task_id: id,\n        query: task?.query || '',\n        rag_called: task?.rag_called || 'STANDARD'\n      };\n    });\n    \n} catch (e) {\n  console.log(`[${traceId}] Could not read plan: ${e.message}`);\n}\n\n// === 5. CALCULER LES M√âTRIQUES ===\nconst completedCount = accumulated.completed_tasks.length;\nconst errorCount = accumulated.error_tasks.length;\nconst pendingCount = pendingTasks.length;\nconst processedCount = completedCount + errorCount;\n\nconst completionRate = totalTasks > 0 ? processedCount / totalTasks : 0;\nconst avgConfidence = completedCount > 0 \n  ? accumulated.completed_tasks.reduce((sum, t) => sum + (t.confidence || 0), 0) / completedCount\n  : 0;\n\nconsole.log(`[${traceId}] Aggregation summary:`);\nconsole.log(`[${traceId}]   Completed: ${completedCount}, Errors: ${errorCount}, Pending: ${pendingCount}`);\nconsole.log(`[${traceId}]   Total tasks: ${totalTasks}, Completion: ${Math.round(completionRate * 100)}%`);\nconsole.log(`[${traceId}]   Avg confidence: ${avgConfidence.toFixed(4)}`);\nconsole.log(`[${traceId}]   All responses count: ${accumulated.all_responses.length}`);\n\n// === 6. DEBUG: Afficher les r√©ponses accumul√©es ===\nif (accumulated.all_responses.length > 0) {\n  accumulated.all_responses.forEach((r, i) => {\n    console.log(`[${traceId}]   Response ${i+1} (${r.rag}): ${r.response.substring(0, 100)}...`);\n  });\n}\n\n// === 7. FLAG DE COMPL√âTION ===\nconst isComplete = pendingCount === 0;\n\n// === 8. OUTPUT ===\nreturn {\n  trace_id: traceId,\n  \n  // T√¢ches par statut\n  completed_tasks: accumulated.completed_tasks,\n  pending_tasks: pendingTasks,\n  error_tasks: accumulated.error_tasks,\n  \n  // R√©ponses pour fusion (crucial pour Response Builder!)\n  accumulated_results: accumulated.completed_tasks,\n  all_responses: accumulated.all_responses,\n  \n  // M√©triques\n  total_tasks: totalTasks,\n  completion_rate: completionRate,\n  average_confidence: avgConfidence,\n  \n  // Flags\n  has_failures: errorCount > 0,\n  has_pending: pendingCount > 0,\n  is_complete: isComplete,\n  \n  // R√©sum√©\n  summary: {\n    completed: completedCount,\n    pending: pendingCount,\n    errors: errorCount,\n    total: totalTasks,\n    completion_percentage: Math.round(completionRate * 100)\n  },\n  \n  // Debug info\n  _debug: {\n    results_key: resultsKey,\n    staticData_has_key: !!staticData[resultsKey],\n    responses_accumulated: accumulated.all_responses.length\n  }\n};\n"
      },
      "id": "11209e3f-7603-46d2-be3a-995b47251435",
      "name": "üìä Task Status Aggregator",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        22784,
        22112
      ]
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// NODE: Redis Failure Handler V10.1\n// PURPOSE: Graceful degradation si Redis down\n// ============================================\n\nconst redisData = $json;\nconst redisError = redisData.error || null;\n\n// R√©cup√©rer trace_id depuis Init\nlet traceId = 'unknown';\ntry {\n  traceId = $node['Init V8 Security & Analysis'].json.trace_id;\n} catch(e) {\n  traceId = `fallback-${Date.now()}`;\n}\n\n// === CAS 1: REDIS ERROR (service down) ===\nif (redisError) {\n  console.error(`[${traceId}] REDIS_FAILURE:`, {\n    error: redisError.message || 'Unknown',\n    timestamp: new Date().toISOString(),\n    trace_id: traceId\n  });\n  \n  return {\n    conversation_history: [],\n    context_status: 'DEGRADED',\n    redis_available: false,\n    warning: 'Redis unavailable - running in stateless mode',\n    trace_id: traceId\n  };\n}\n\n// === CAS 2: REDIS OK - Parser les donn√©es ===\ntry {\n  const rawData = redisData.data;\n  \n  // Si pas de data ‚Üí conversation nouvelle\n  if (!rawData || rawData === null || rawData === 'null') {\n    console.log(`[${traceId}] New conversation - no Redis data`);\n    return {\n      conversation_history: [],\n      context_status: 'NEW',\n      redis_available: true,\n      trace_id: traceId\n    };\n  }\n  \n  // Parser le JSON\n  const parsedData = JSON.parse(rawData);\n  const history = parsedData.history || [];\n  \n  console.log(`[${traceId}] Redis OK: ${history.length} messages in history`);\n  \n  return {\n    conversation_history: history,\n    context_status: 'FULL',\n    redis_available: true,\n    trace_id: traceId\n  };\n  \n} catch (parseError) {\n  // === CAS 3: REDIS DATA CORRUPTED ===\n  console.error(`[${traceId}] REDIS_PARSE_ERROR:`, parseError.message);\n  \n  return {\n    conversation_history: [],\n    context_status: 'CORRUPTED',\n    redis_available: true,\n    warning: 'Redis data corrupted - starting fresh',\n    trace_id: traceId\n  };\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        17408,
        22624
      ],
      "id": "c7ee4ae3-47e2-44d7-b012-f138a2ed80c3",
      "name": "üõ°Ô∏è Redis Failure Handler V10.1"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// NODE: Context Compression V10.1\n// ============================================\n\nconst mergedContext = $json;\nconst conversationHistory = mergedContext.recent_messages || [];\nconst traceId = mergedContext.trace_id;\n\n// 3 derniers messages seulement\nconst recentHistory = conversationHistory.slice(-3);\n\n// R√©sum√© compress√© des anciens\nlet compressedSummary = '';\nif (conversationHistory.length > 3) {\n  const olderHistory = conversationHistory.slice(0, -3);\n  compressedSummary = olderHistory\n    .map(h => h.query || h.message || '')\n    .filter(q => q.length > 0)\n    .join(' | ')\n    .substring(0, 500);\n}\n\n// D√©tecter changement d'intention\nconst lastIntent = mergedContext.last_intent;\nconst intentionShift = lastIntent && lastIntent !== 'UNKNOWN';\n\n// Tokens √©conomis√©s\nconst originalTokens = conversationHistory.reduce((sum, h) => \n  sum + (h.query?.length || 0) + (h.response?.length || 0), 0) / 4;\nconst compressedTokens = recentHistory.reduce((sum, h) => \n  sum + (h.query?.length || 0) + (h.response?.length || 0), 0) / 4;\nconst tokensSaved = Math.max(0, originalTokens - compressedTokens);\n\nconsole.log(`[${traceId}] Compressed: ${conversationHistory.length} ‚Üí ${recentHistory.length} msgs, ~${Math.round(tokensSaved)} tokens saved`);\n\nreturn {\n  ...mergedContext,\n  compressed_history: recentHistory,\n  compressed_summary: compressedSummary,\n  full_history_length: conversationHistory.length,\n  intention_shift: intentionShift,\n  tokens_saved: Math.round(tokensSaved)\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        17792,
        21728
      ],
      "id": "ee9b5dbc-f858-451d-bf3e-2dabf78bdffe",
      "name": "üì¶ Context Compression V10.1"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// NODE: üîç Query Classifier V10.1 + Adaptive Retrieval Gate\n// ============================================\n\nconst context = $json;\nconst query = context.query || '';\nconst traceId = context.trace_id;\nconst recentMessages = context.compressed_history || context.recent_messages || [];\n\n// === 1. CONVERSATIONAL DETECTION ===\nconst CONVERSATIONAL_PATTERNS = [\n  /^(hi|hello|hey|bonjour|salut)/i,\n  /^(thanks|thank you|merci)/i,\n  /^(ok|okay|yes|no|oui|non)$/i,\n  /^(bye|goodbye|au revoir)/i,\n  /how are you|comment (vas-tu|allez-vous)/i,\n  /can you help me/i\n];\n\nconst isConversational = \n  CONVERSATIONAL_PATTERNS.some(p => p.test(query)) ||\n  query.length < 5 ||\n  (recentMessages.length > 0 && query.split(' ').length < 5);\n\n// === 2. CACHE CHECK ===\nconst shouldCheckCache = \n  !isConversational && \n  query.length > 10 && \n  query.length < 200;\n\n// === 3. ADAPTIVE RETRIEVAL GATE ===\nconst RETRIEVAL_REQUIRED = [\n  /combien|quel.*total|quelle.*somme/i,\n  /qui.*responsable|quelle.*relation/i,\n  /selon|d'apr√®s|dans.*document|notre/i,\n  /proc√©dure|process|√©tape|comment faire/i,\n  /politique|r√®gle|r√®glement/i\n];\n\nconst DIRECT_ANSWER = [\n  /qu'est-ce qu'un|d√©finition de|c'est quoi/i,\n  /explique.*concept|comment.*fonctionne/i\n];\n\nlet needsRetrieval = true;\nlet retrievalReason = 'DEFAULT';\n\nfor (const pattern of RETRIEVAL_REQUIRED) {\n  if (pattern.test(query)) {\n    needsRetrieval = true;\n    retrievalReason = 'DOMAIN_SPECIFIC';\n    break;\n  }\n}\n\nif (retrievalReason === 'DEFAULT') {\n  for (const pattern of DIRECT_ANSWER) {\n    if (pattern.test(query)) {\n      needsRetrieval = false;\n      retrievalReason = 'GENERAL_KNOWLEDGE';\n      break;\n    }\n  }\n}\n\n// === 4. ROUTE DECISION ===\nlet route = 'agent';\n\nif (isConversational) {\n  route = 'conversational';\n} else if (shouldCheckCache) {\n  route = 'cache_check';\n} else if (!needsRetrieval) {\n  route = 'direct_llm';\n}\n\nconsole.log(`[${traceId}] Route: ${route}, Retrieval: ${needsRetrieval} (${retrievalReason})`);\n\nreturn {\n  ...context,\n  query_route: route,\n  is_conversational: isConversational,\n  should_check_cache: shouldCheckCache,\n  needs_retrieval: needsRetrieval,\n  retrieval_reason: retrievalReason\n};\n"
      },
      "id": "9e99068a-a937-4369-99d4-b3b062c83ac4",
      "name": "üîç Query Classifier V10.1",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        18256,
        21904
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1' }}/chat/completions",
        "authentication": "none",
        "nodeCredentialType": "openRouterApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"{{ $vars.LLM_FAST_MODEL || 'google/gemma-3-27b-it:free' }}\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are the INTENT ANALYZER of a sophisticated multi-engine RAG system.\\n\\n=== YOUR MISSION ===\\n1. Analyzer la query utilisateur\\n2. Identifier TOUS les intents (explicites ET implicites)\\n3. D√©terminer les D√âPENDANCES entre intents\\n4. Assigner le moteur RAG optimal pour chaque intent\\n\\n=== MOTEURS RAG DISPONIBLES ===\\n\\n**STANDARD (Pinecone + BM25)**\\n- Forces: faits, proc√©dures, d√©finitions\\n\\n**GRAPH (Neo4j)**\\n- Forces: relations, hi√©rarchies, impacts\\n\\n**QUANTITATIVE (PostgreSQL)**\\n- Forces: chiffres, totaux, moyennes, KPIs\\n\\n=== FORMAT JSON STRICT ===\\n{\\n  \\\"reasoning\\\": \\\"<ton analyse>\\\",\\n  \\\"intents\\\": [{\\\"id\\\": \\\"intent-1\\\", \\\"type\\\": \\\"FACTUAL|QUANTITATIVE|RELATIONAL\\\", \\\"suggested_rag\\\": \\\"STANDARD|GRAPH|QUANTITATIVE\\\", \\\"priority\\\": 1}],\\n  \\\"execution_order\\\": [\\\"intent-1\\\"],\\n  \\\"complexity\\\": \\\"SIMPLE|MODERATE|COMPLEX\\\"\\n}\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"=== QUERY TO ANALYZE ===\\n{{ $node['Init V8 Security & Analysis'].json.query }}\"\n    }\n  ],\n  \"temperature\": 0.1,\n  \"max_tokens\": 800\n}",
        "options": {
          "timeout": 12000,
          "retry": {
            "maxTries": 3,
            "waitBetweenTries": 2000
          }
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        19056,
        22496
      ],
      "id": "6bfcc7d3-9915-43c4-abd9-4c299b5dd4b1",
      "name": "HTTP Request",
      "credentials": {},
      "continueOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT task_id, intent_id, status, rag_called, attempt, query, response, confidence\nFROM rag_task_executions \nWHERE trace_id = '{{ $node[\"Init V8 Security & Analysis\"].json.trace_id }}'\nORDER BY task_id ASC",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        21216,
        22528
      ],
      "id": "7fa85861-eefe-48f9-a03c-7dad6fc40c94",
      "name": "Postgres : Get Current Tasks",
      "credentials": {
        "postgres": {
          "id": "zEr7jPswZNv6lWKu",
          "name": "Supabase PostgreSQL"
        }
      }
    },
    {
      "parameters": {
        "numberInputs": 4
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        24864,
        22160
      ],
      "id": "713d6797-3083-4119-a1b3-a86bcf0b5c77",
      "name": "Merge",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "ebee2253-8093-451a-bf3b-5b00e78fdc69",
              "leftValue": "={{ $json.all_complete }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        21504,
        22816
      ],
      "id": "357e6360-0498-4633-b5f8-30061ecd941a",
      "name": "If"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "f64b093e-7578-418f-aa48-03ebc26d5a02",
              "leftValue": "={{$json.all_tasks_complete}}",
              "rightValue": false,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        23504,
        21984
      ],
      "id": "ea57ed6e-ec10-4c32-9600-d5859f56d625",
      "name": "If1"
    },
    {
      "parameters": {
        "jsCode": "// GitHub Error Logger for orchestrator\nconst errorData = $input.first().json;\nconst timestamp = new Date().toISOString();\nconst questionId = errorData.question_id || errorData.trace_id || 'q-' + Date.now();\nconst errorType = errorData.error_type || errorData.error_code || 'UNKNOWN';\nconst pipeline = 'orchestrator';\n\nconst logEntry = {\n  timestamp: timestamp,\n  pipeline: pipeline,\n  question_id: questionId,\n  error_type: errorType,\n  error_message: (errorData.error || errorData.message || 'No message').slice(0, 500),\n  input: {\n    query: (errorData.query || errorData.original_query || '').slice(0, 300),\n    tenant_id: errorData.tenant_id || 'benchmark'\n  },\n  partial_response: errorData.partial_response || errorData.response || null,\n  n8n_context: {\n    workflow_id: $workflow.id,\n    workflow_name: $workflow.name,\n    execution_id: $execution.id\n  },\n  performance: {\n    latency_ms: errorData.latency_ms || 0,\n    http_status: errorData.http_status || null\n  }\n};\n\nreturn [{ json: logEntry }];"
      },
      "id": "0a33eb42-654b-45ca-aaae-79a48360d408",
      "name": "GitHub Error Logger (orchestrator)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        25564,
        0
      ],
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Execution Summary Logger for orchestrator\nconst input = $input.first().json;\nconst timestamp = new Date().toISOString();\n\nconst summary = {\n  timestamp: timestamp,\n  pipeline: 'orchestrator',\n  question_id: input.trace_id || input.question_id || 'q-' + Date.now(),\n  query: (input.query || input.original_query || '').slice(0, 300),\n  success: !!(input.response || input.final_response || input.answer),\n  response_length: (input.response || input.final_response || input.answer || '').length,\n  confidence: input.confidence || 0,\n  latency_ms: input.latency_ms || 0,\n  engine: input.engine || input.selected_engine || 'orchestrator',\n  n8n_context: {\n    workflow_id: $workflow.id,\n    execution_id: $execution.id\n  }\n};\n\nreturn [{ json: summary }];"
      },
      "id": "126ba97d-e08d-413b-9d0e-b6305ac0b2cd",
      "name": "Execution Summary (orchestrator)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        25564,
        200
      ],
      "onError": "continueRegularOutput"
    }
  ],
  "connections": {
    "Webhook V8": {
      "main": [
        [
          {
            "node": "Input Merger V8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Chat Trigger V8": {
      "main": [
        [
          {
            "node": "Input Merger V8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Input Merger V8": {
      "main": [
        [
          {
            "node": "Init V8 Security & Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Init V8 Security & Analysis": {
      "main": [
        [
          {
            "node": "Redis: Fetch Conversation",
            "type": "main",
            "index": 0
          },
          {
            "node": "Postgres L2/L3 Memory",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Redis: Fetch Conversation": {
      "main": [
        [
          {
            "node": "üõ°Ô∏è Redis Failure Handler V10.1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üõ°Ô∏è Rate Limit Guard": {
      "main": [
        [
          {
            "node": "IF: Rate Limited?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF: Rate Limited?": {
      "main": [
        [
          {
            "node": "üß† Memory Merger (Redis + Postgres)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Return: Rate Limited",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres L2/L3 Memory": {
      "main": [
        [
          {
            "node": "üß† Memory Merger (Redis + Postgres)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üß† Memory Merger (Redis + Postgres)": {
      "main": [
        [
          {
            "node": "üì¶ Context Compression V10.1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üõ°Ô∏è Advanced Guardrails": {
      "main": [
        [
          {
            "node": "IF: Guardrail Passed?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF: Guardrail Passed?": {
      "main": [
        [
          {
            "node": "üîç Query Classifier V10.1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Return: Guardrail Blocked",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÄ Query Router": {
      "main": [
        [
          {
            "node": "üí¨ Conversational Handler",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üîé Cache Semantic Search",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üß† LLM 1: Intent Analyzer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üí¨ Conversational Handler": {
      "main": [
        [
          {
            "node": "Return: Conversational",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîé Cache Semantic Search": {
      "main": [
        [
          {
            "node": "Redis: Cache + Generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Redis: Cache + Generator": {
      "main": [
        [
          {
            "node": "Cache Parser",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cache Parser": {
      "main": [
        [
          {
            "node": "IF: Cache Hit?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF: Cache Hit?": {
      "main": [
        [
          {
            "node": "Return: Cached",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üß† LLM 1: Intent Analyzer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üß† LLM 1: Intent Analyzer": {
      "main": [
        [
          {
            "node": "Intent Parser V9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Intent Parser V9": {
      "main": [
        [
          {
            "node": "Postgres: Init Tasks Table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres: Init Tasks Table": {
      "main": [
        [
          {
            "node": "üìù Format & Dispatch (Plan‚ÜíDB)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìù Format & Dispatch (Plan‚ÜíDB)": {
      "main": [
        [
          {
            "node": "Postgres: Insert Tasks",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres: Insert Tasks": {
      "main": [
        [
          {
            "node": "Postgres : Get Current Tasks",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚öôÔ∏è Execution Engine V10": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÄ Dynamic Switch V10": {
      "main": [
        [
          {
            "node": "Invoke WF5: Standard",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Invoke WF2: Graph",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Invoke WF4: Quantitative",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Invoke WF5: Standard": {
      "main": [
        [
          {
            "node": "üì• Task Result Handler",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Invoke WF2: Graph": {
      "main": [
        [
          {
            "node": "üì• Task Result Handler",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Invoke WF4: Quantitative": {
      "main": [
        [
          {
            "node": "üì• Task Result Handler",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì• Task Result Handler": {
      "main": [
        [
          {
            "node": "Postgres: Update Task",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres: Update Task": {
      "main": [
        [
          {
            "node": "üîÑ Fallback Monitor V10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÑ Fallback Monitor V10": {
      "main": [
        [
          {
            "node": "IF: Fallback Needed?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF: Fallback Needed?": {
      "main": [
        [
          {
            "node": "üîÑ Fallback Dispatch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üìä Task Status Aggregator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîÑ Fallback Dispatch": {
      "main": [
        [
          {
            "node": "Postgres: Update Fallback",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres: Update Fallback": {
      "main": [
        [
          {
            "node": "Postgres : Get Current Tasks",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìä Task Status Aggregator": {
      "main": [
        [
          {
            "node": "Response Builder V9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres: Apply Skips": {
      "main": [
        [
          {
            "node": "Postgres : Get Current Tasks",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres: Insert New Tasks": {
      "main": [
        [
          {
            "node": "Postgres : Get Current Tasks",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Response Builder V9": {
      "main": [
        [
          {
            "node": "üíæ Cache Storage",
            "type": "main",
            "index": 0
          },
          {
            "node": "Store RLHF Data V8",
            "type": "main",
            "index": 0
          },
          {
            "node": "Redis: Store Conv V8",
            "type": "main",
            "index": 0
          },
          {
            "node": "Postgres: Update Context V8",
            "type": "main",
            "index": 0
          },
          {
            "node": "Execution Summary (orchestrator)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üíæ Cache Storage": {
      "main": [
        [
          {
            "node": "Redis: Set Cache",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Redis: Set Cache": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Store RLHF Data V8": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Redis: Store Conv V8": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "Postgres: Update Context V8": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Output Router (Final)": {
      "main": [
        [
          {
            "node": "Chat: Final V8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Return Response V8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Error Handler V8": {
      "main": [
        [
          {
            "node": "Error Payload V8",
            "type": "main",
            "index": 0
          },
          {
            "node": "GitHub Error Logger (orchestrator)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Error Payload V8": {
      "main": [
        [
          {
            "node": "Export Error V8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Export Error V8": {
      "main": [
        [
          {
            "node": "Return: Error Response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Return: Error Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üõ°Ô∏è Redis Failure Handler V10.1": {
      "main": [
        [
          {
            "node": "üõ°Ô∏è Rate Limit Guard",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì¶ Context Compression V10.1": {
      "main": [
        [
          {
            "node": "üõ°Ô∏è Advanced Guardrails",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîç Query Classifier V10.1": {
      "main": [
        [
          {
            "node": "üîÄ Query Router",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Intent Parser V9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres : Get Current Tasks": {
      "main": [
        [
          {
            "node": "‚öôÔ∏è Execution Engine V10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Output Router (Final)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Response Builder V9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üîÄ Dynamic Switch V10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "executionTimeout": 90,
    "availableInMCP": false
  },
  "staticData": {
    "global": {
      "loopCounters": {
        "loop_trace-1770615070066-wd85zy": 2,
        "loop_trace-1770659131887-718lx9": 1,
        "loop_trace-1770675301013-m1cdcn": 2,
        "loop_trace-1770675530164-ok7lrv": 1,
        "loop_trace-1770675580355-urcypy": 2,
        "loop_trace-1770675747283-qzrkwh": 2,
        "loop_trace-1770675838638-qmmb1r": 1,
        "loop_trace-1770675873566-dfv7a7": 2,
        "loop_trace-1770675941875-lqfk2": 1,
        "loop_trace-1770675993838-h214m": 1,
        "loop_trace-1770676048157-mo56vf": 1,
        "loop_trace-1770676081805-nub6sg": 2,
        "loop_trace-1770676147809-r4ocjt": 1,
        "loop_trace-1770676196011-c2exe7": 1,
        "loop_trace-1770676230319-0nxek": 1,
        "loop_trace-1770676358499-j892sl": 2,
        "loop_trace-1770676435651-krqu5t": 1,
        "loop_trace-1770676477123-eilj0w": 2,
        "loop_trace-1770676561206-wv6xw": 1,
        "loop_trace-1770676605255-7jjum8": 1,
        "loop_trace-1770676655538-8zo9x": 1,
        "loop_trace-1770676869721-yoyqlc": 1,
        "loop_trace-1770677006997-z0gp2": 2,
        "loop_trace-1770677070496-acz7ym": 1,
        "loop_trace-1770677101285-shypdw": 1,
        "loop_trace-1770677151455-b1u1eu": 2,
        "loop_trace-1770677220254-2td8ie": 1,
        "loop_trace-1770677247197-1h57o": 1,
        "loop_trace-1770677315901-oz2c5": 1,
        "loop_test-fix-v2": 2,
        "loop_trace-1770679076174-gvfyu": 1,
        "loop_trace-1770679531486-7tjp9": 1,
        "loop_trace-1770679576446-t0v67": 1,
        "loop_trace-1770679617922-lh9fbl": 1,
        "loop_trace-1770679647151-tetmc": 1,
        "loop_trace-1770679682465-5xbgy": 1,
        "loop_trace-1770680638780-b1jhfh": 1,
        "loop_trace-1770680693232-r7a0lq": 1,
        "loop_trace-1770680763480-icmom": 1,
        "loop_trace-1770680838663-xwdhbi": 1,
        "loop_trace-1770680889063-5xcs59": 1,
        "loop_trace-1770680961320-8g0bs4": 1,
        "loop_trace-1770681010529-vum8r": 1,
        "loop_trace-1770681067031-cxt2t": 1,
        "loop_trace-1770681126690-ugn99r": 1,
        "loop_trace-1770681176819-rrq1g6": 1,
        "loop_trace-1770701115382-ibdenk": 1,
        "loop_trace-1770701120087-9gjcme": 1,
        "loop_trace-1770701124091-l8chop": 1,
        "loop_trace-1770701128228-fn9ir": 1,
        "loop_trace-1770701132522-8hj6ml3": 1,
        "loop_trace-1770701136716-3w43na": 1,
        "loop_trace-1770701141179-qlf9ur": 1,
        "loop_trace-1770701145620-qmqoir": 1,
        "loop_trace-1770701150783-zmp6jo": 1,
        "loop_trace-1770701156022-49d9l8": 1,
        "loop_trace-1770710885505-5zn03": 1,
        "loop_trace-1770710892098-xatmkj": 1,
        "loop_trace-1770710896714-2keqb": 1,
        "loop_trace-1770710901315-yquzcq": 1,
        "loop_trace-1770710905772-9jfgli": 1,
        "loop_trace-1770710910305-b882": 1,
        "loop_trace-1770710915157-hb3gd": 1,
        "loop_trace-1770710920011-wsf2pq": 1,
        "loop_trace-1770710924994-ako1w": 1,
        "loop_trace-1770710930564-9xn5to": 1,
        "loop_trace-1770714007923-hszzbj": 1,
        "loop_trace-1770714013619-us4pgf": 1,
        "loop_trace-1770714018863-8tuvqu": 1,
        "loop_trace-1770714023683-yw37zc": 1,
        "loop_trace-1770714028552-y5hja4": 1,
        "loop_trace-1770714033630-o0m9ai": 1,
        "loop_trace-1770714038546-6p1umd": 1,
        "loop_trace-1770714043505-p4x0t": 1,
        "loop_trace-1770714048998-1mutms": 1,
        "loop_trace-1770714053728-fjkpv": 1,
        "loop_trace-1770714058666-k9brde": 1,
        "loop_trace-1770714068222-tguq8": 1,
        "loop_trace-1770714073314-mjigmn": 1,
        "loop_trace-1770714078382-auuos7": 1,
        "loop_trace-1770714083047-cg0qt7": 1,
        "loop_trace-1770714087971-nwj5gm": 1,
        "loop_trace-1770714092730-o7lgj": 1,
        "loop_trace-1770714098719-5tcevr": 1,
        "loop_trace-1770714103406-uxppwi": 1,
        "loop_trace-1770714109484-z5pveh": 1,
        "loop_trace-1770714114358-0cmjwe": 1,
        "loop_trace-1770714118991-k8jil9": 1,
        "loop_trace-1770714123926-ydvdz": 1,
        "loop_trace-1770714128794-4pdoa": 1,
        "loop_trace-1770714135048-rlv8en": 1,
        "loop_trace-1770714139793-qei2gn": 1,
        "loop_trace-1770714144401-rw1bqq": 1,
        "loop_trace-1770714149405-t8yg0c": 1,
        "loop_trace-1770714154065-yqdp4": 1,
        "loop_trace-1770714158978-5ntsp": 1,
        "loop_trace-1770714163800-4tj0g7": 1,
        "loop_trace-1770714168804-wgh27": 1,
        "loop_trace-1770714173547-90yg66": 1,
        "loop_trace-1770714178354-c3tp1": 1,
        "loop_trace-1770714182935-qtsm3j": 1,
        "loop_trace-1770714187792-m3n894": 1,
        "loop_trace-1770714192513-p8q6ml": 1,
        "loop_trace-1770714197351-wmvh3w": 1,
        "loop_trace-1770714202116-lf6uve": 1,
        "loop_trace-1770714206847-ngz09g": 1,
        "loop_trace-1770714211883-yssn6g": 1,
        "loop_trace-1770714217004-9vjty": 1,
        "loop_trace-1770714223420-2ufi3": 1,
        "loop_trace-1770714228183-zsq15": 1,
        "loop_trace-1770714232893-5g9ly7": 1,
        "loop_trace-1770714237950-a946p": 1,
        "loop_trace-1770714242518-qow92": 1,
        "loop_trace-1770714247158-toubn": 1,
        "loop_trace-1770714251803-jbc0n": 1,
        "loop_trace-1770714256541-ku966h": 1,
        "loop_trace-1770716046667-yiwbze": 1,
        "loop_trace-1770716528976-lbxzuf": 1,
        "loop_trace-1770717007578-s4ymt": 1,
        "loop_trace-1770717038260-pgm9j": 1,
        "loop_trace-1770717071129-klfk8o": 1,
        "loop_trace-1770718038045-7ktfor": 1,
        "loop_trace-1770718332380-74qt55": 1,
        "loop_trace-1770719216645-pkeru8": 1,
        "loop_trace-1770719251720-dc2amb": 1,
        "loop_trace-1770719292514-7kmjj3": 1,
        "loop_trace-1770719324460-u7r7nd": 1,
        "loop_trace-1770719361723-g4d4rl": 1,
        "loop_trace-1770719632624-fzj3go": 1,
        "loop_trace-1770719647523-bu0xpj": 1,
        "loop_trace-1770719669013-3t8lkm": 1,
        "loop_trace-1770719691417-5aujg": 1,
        "loop_trace-1770719713004-1lqin": 1,
        "loop_trace-1770720916008-f6hbnl": 1,
        "loop_trace-1770721197935-54tdrg": 1,
        "loop_trace-1770721217949-yluaqn": 1,
        "loop_trace-1770721245997-81ovfh": 1,
        "loop_trace-1770721270077-kx78a": 1,
        "loop_trace-1770721287873-nz6n5p": 1
      },
      "results_trace-1770614970423-6ggldq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Artificial intelligence (AI) is the simulation of human intelligence processes by machines, especially computer systems, enabling them to perform tasks that typically require human intelligence such as learning, reasoning, problem-solving, perception, and language understanding.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Artificial intelligence (AI) is the simulation of human intelligence processes by machines, especially computer systems, enabling them to perform tasks that typically require human intelligence such as learning, reasoning, problem-solving, perception, and language understanding.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770614970423-6ggldq": true,
      "results_trace-1770615160776-sk16pi": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 was $6,745,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 was $6,745,000,000.00.",
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770615160776-sk16pi": true,
      "results_trace-1770615203145-rx7cf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770615203145-rx7cf": true,
      "results_trace-1770615229619-dj2kgm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "Unable to generate SQL query for this question. Error: [object Object]",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "Unable to generate SQL query for this question. Error: [object Object]",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770615229619-dj2kgm": true,
      "results_trace-1770615654387-ilx4m7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of France is Paris.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of France is Paris.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770615654387-ilx4m7": true,
      "results_trace-1770615774795-qskiih": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770615774795-qskiih": true,
      "results_trace-1770615808010-aripcf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Machine learning is a subset of artificial intelligence that enables computer systems to learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Machine learning is a subset of artificial intelligence that enables computer systems to learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770615808010-aripcf": true,
      "results_trace-1770615842522-o1gp58": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The net income figure for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"net_income\":\"1337550000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The net income figure for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770615842522-o1gp58": true,
      "results_trace-1770615880085-clkb7b": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "QUANTITATIVE",
            "response": "GreenEnergy Corp currently has $900,000,000 in cash and cash equivalents.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"cash_and_equivalents\":\"900000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "QUANTITATIVE",
            "response": "GreenEnergy Corp currently has $900,000,000 in cash and cash equivalents.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770615880085-clkb7b": true,
      "results_trace-1770615964015-ienli": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770615964015-ienli": true,
      "results_trace-1770616153012-nejcbi": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770616153012-nejcbi": true,
      "results_trace-1770616200841-5pxtpb": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770616200841-5pxtpb": true,
      "results_trace-1770616612233-ffqt4o": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770616612233-ffqt4o": true,
      "results_trace-1770617023696-hu8zvm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of France is Paris.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of France is Paris.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770617023696-hu8zvm": true,
      "results_trace-1770617057985-9hwd7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.996527777777777778%, which can be rounded to 52.0%.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"fiscal_year\":2023,\"gross_profit\":\"599000000.00\",\"revenue\":\"1152000000.00\",\"gross_profit_margin\":\"0.51996527777777777778\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.996527777777777778%, which can be rounded to 52.0%.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770617057985-9hwd7": true,
      "results_trace-1770617488419-s32puo": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Machine learning is a branch of artificial intelligence that enables computer systems to automatically learn and improve from experience without being explicitly programmed, using algorithms to analyze data, identify patterns, and make decisions or predictions.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Machine learning is a branch of artificial intelligence that enables computer systems to automatically learn and improve from experience without being explicitly programmed, using algorithms to analyze data, identify patterns, and make decisions or predictions.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770617488419-s32puo": true,
      "results_trace-1770617523701-2anmyc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "In 2023, the three companies with the highest R&D spending were:\n\n1. TechVision Inc: $1,349,000,000\n2. GreenEnergy Corp: $365,000,000\n3. HealthPlus Labs: $288,000,000\n\nTechVision Inc significantly outspent the other two companies, investing more than three times as much as GreenEnergy Corp and nearly five times as much as HealthPlus Labs in research and development.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"TechVision Inc\",\"research_development\":\"1349000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_name\":\"GreenEnergy Corp\",\"research_development\":\"365000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"research_development\":\"288000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "The Louvre, Mus√©e d'Orsay, Centre Pompidou, Mus√©e Rodin, Mus√©e de l'Orangerie, Mus√©e Picasso, Mus√©e de l'Arm√©e, Mus√©e Carnavalet, Mus√©e de Cluny, Mus√©e Jacquemart-Andr√©, Mus√©e de la Chasse et de la Nature, Mus√©e de la Vie Romantique, Mus√©e Zadkine, Mus√©e Cernuschi, Mus√©e Guimet, Mus√©e de la Monnaie, Mus√©e de la Poup√©e, Mus√©e de la Magie, Mus√©e de la Chasse et de la Nature, Mus√©e de la Vie Romantique, Mus√©e Zadkine, Mus√©e Cernuschi, Mus√©e Guimet, Mus√©e de la Monnaie, Mus√©e de la Poup√©e, Mus√©e de la Magie.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "In 2023, the three companies with the highest R&D spending were:\n\n1. TechVision Inc: $1,349,000,000\n2. GreenEnergy Corp: $365,000,000\n3. HealthPlus Labs: $288,000,000\n\nTechVision Inc significantly outspent the other two companies, investing more than three times as much as GreenEnergy Corp and nearly five times as much as HealthPlus Labs in research and development.",
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "The Louvre, Mus√©e d'Orsay, Centre Pompidou, Mus√©e Rodin, Mus√©e de l'Orangerie, Mus√©e Picasso, Mus√©e de l'Arm√©e, Mus√©e Carnavalet, Mus√©e de Cluny, Mus√©e Jacquemart-Andr√©, Mus√©e de la Chasse et de la Nature, Mus√©e de la Vie Romantique, Mus√©e Zadkine, Mus√©e Cernuschi, Mus√©e Guimet, Mus√©e de la Monnaie, Mus√©e de la Poup√©e, Mus√©e de la Magie, Mus√©e de la Chasse et de la Nature, Mus√©e de la Vie Romantique, Mus√©e Zadkine, Mus√©e Cernuschi, Mus√©e Guimet, Mus√©e de la Monnaie, Mus√©e de la Poup√©e, Mus√©e de la Magie.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770617523701-2anmyc": true,
      "results_trace-1770617599413-0xae6p": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc reported a net income of $1,337,550,000 for fiscal year 2022.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"net_income\":\"1337550000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc reported a net income of $1,337,550,000 for fiscal year 2022.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770617599413-0xae6p": true,
      "results_trace-1770618015089-xld25": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "NASA studies a wide range of research areas including Earth science, planetary science, astrophysics, heliophysics, aeronautics, and human spaceflight.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "NASA studies a wide range of research areas including Earth science, planetary science, astrophysics, heliophysics, aeronautics, and human spaceflight.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770618015089-xld25": true,
      "results_trace-1770618055836-x2ryw6": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure (1 atm or 101.325 kPa).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure (1 atm or 101.325 kPa).",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770618055836-x2ryw6": true,
      "results_trace-1770618088930-vnhwx9": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The operating income for all companies in Q1 2023 is as follows:\n\n1. GreenEnergy Corp: $184,690,000.00\n2. HealthPlus Labs: $48,153,000.00\n3. TechVision Inc: $465,908,000.00\n\nThese results show the operating income for three companies in the benchmark tenant for the first quarter of 2023, ordered alphabetically by company name.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_id\":\"greenenergy\",\"company_name\":\"GreenEnergy Corp\",\"operating_income\":\"184690000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_id\":\"healthplus\",\"company_name\":\"HealthPlus Labs\",\"operating_income\":\"48153000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_id\":\"techvision\",\"company_name\":\"TechVision Inc\",\"operating_income\":\"465908000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The operating income for all companies in Q1 2023 is as follows:\n\n1. GreenEnergy Corp: $184,690,000.00\n2. HealthPlus Labs: $48,153,000.00\n3. TechVision Inc: $465,908,000.00\n\nThese results show the operating income for three companies in the benchmark tenant for the first quarter of 2023, ordered alphabetically by company name.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770618088930-vnhwx9": true,
      "results_trace-1770618508959-m5i9nl": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Winston Churchill was a British statesman who served as Prime Minister of the United Kingdom during World War II and again from 1951 to 1955. He was also a prolific writer, historian, and artist, winning the Nobel Prize in Literature in 1953.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Winston Churchill was a British statesman who served as Prime Minister of the United Kingdom during World War II and again from 1951 to 1955. He was also a prolific writer, historian, and artist, winning the Nobel Prize in Literature in 1953.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770618508959-m5i9nl": true,
      "results_trace-1770618542574-2rcpj": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Products in the AI/ML category include machine learning frameworks like TensorFlow and PyTorch, cloud-based AI services such as AWS SageMaker and Google Cloud AI, and specialized hardware like NVIDIA GPUs and Google TPUs designed for AI workloads.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "QUANTITATIVE",
            "response": "The revenue trend for AI/ML products shows that there are two products in this category: VisionAI Edge and VisionAI Platform. Both products have maintained consistent revenue figures across the years 2020, 2021, and 2022. Specifically, VisionAI Edge generated $4,649,767.56 each year, while VisionAI Platform generated $3,719,876.00 each year. This indicates a stable revenue trend for these AI/ML products over the observed period.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"product_name\":\"VisionAI Edge\",\"fiscal_year\":2020,\"revenue\":\"4649767.56\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"product_name\":\"VisionAI Platform\",\"fiscal_year\":2020,\"revenue\":\"3719876.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"product_name\":\"VisionAI Edge\",\"fiscal_year\":2021,\"revenue\":\"4649767.56\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 4",
                "content": "{\"product_name\":\"VisionAI Platform\",\"fiscal_year\":2021,\"revenue\":\"3719876.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 5",
                "content": "{\"product_name\":\"VisionAI Edge\",\"fiscal_year\":2022,\"revenue\":\"4649767.56\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 6",
                "content": "{\"product_name\":\"VisionAI Platform\",\"fiscal_year\":2022,\"revenue\":\"3719876.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 7",
                "content": "{\"product_name\":\"VisionAI Edge\",\"fiscal_year\":2023,\"revenue\":\"9299535.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 8",
                "content": "{\"product_name\":\"VisionAI Platform\",\"fiscal_year\":2023,\"revenue\":\"7439752.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Products in the AI/ML category include machine learning frameworks like TensorFlow and PyTorch, cloud-based AI services such as AWS SageMaker and Google Cloud AI, and specialized hardware like NVIDIA GPUs and Google TPUs designed for AI workloads.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "QUANTITATIVE",
            "response": "The revenue trend for AI/ML products shows that there are two products in this category: VisionAI Edge and VisionAI Platform. Both products have maintained consistent revenue figures across the years 2020, 2021, and 2022. Specifically, VisionAI Edge generated $4,649,767.56 each year, while VisionAI Platform generated $3,719,876.00 each year. This indicates a stable revenue trend for these AI/ML products over the observed period.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770618542574-2rcpj": true,
      "results_trace-1770619369621-slg6z2": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "GreenEnergy Corp sells solar panels, wind turbines, and energy storage systems.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "GreenEnergy Corp sells solar panels, wind turbines, and energy storage systems.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770619369621-slg6z2": true,
      "results_trace-1770619401303-vsf609": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The technology that preceded the Internet was ARPANET, a packet-switching network developed in the late 1960s by the U.S. Department of Defense.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The technology that preceded the Internet was ARPANET, a packet-switching network developed in the late 1960s by the U.S. Department of Defense.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770619401303-vsf609": true,
      "results_trace-1770619432945-pwr61": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "DNA, or deoxyribonucleic acid, is a molecule that carries the genetic instructions used in the growth, development, functioning, and reproduction of all known living organisms and many viruses.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "DNA's role in genetics is to store and transmit genetic information that determines an organism's traits and characteristics through its sequence of nucleotides.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "DNA, or deoxyribonucleic acid, is a molecule that carries the genetic instructions used in the growth, development, functioning, and reproduction of all known living organisms and many viruses.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "DNA's role in genetics is to store and transmit genetic information that determines an organism's traits and characteristics through its sequence of nucleotides.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770619432945-pwr61": true,
      "results_trace-1770619684921-93yffk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The EPS (Earnings Per Share) value for TechVision Inc in 2023 is 16.17.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"basic_eps\":\"16.1700\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag_called": "QUANTITATIVE",
            "response": "The EPS (Earnings Per Share) value for GreenEnergy Corp in 2023 is 13.2900.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"basic_eps\":\"13.2900\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 3,
            "rag_called": "QUANTITATIVE",
            "response": "The EPS differences between the companies are as follows:\n\n1. TechVision Inc vs GreenEnergy Corp: 2.88\n2. TechVision Inc vs HealthPlus Labs: 9.19\n3. GreenEnergy Corp vs TechVision Inc: -2.88\n4. GreenEnergy Corp vs HealthPlus Labs: 6.31\n5. HealthPlus Labs vs TechVision Inc: -9.19\n\nThe largest positive EPS difference is 9.19 (TechVision Inc vs HealthPlus Labs), while the largest negative difference is -9.19 (HealthPlus Labs vs TechVision Inc).",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company1\":\"TechVision Inc\",\"eps1\":\"16.1700\",\"company2\":\"GreenEnergy Corp\",\"eps2\":\"13.2900\",\"eps_difference\":\"2.8800\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company1\":\"TechVision Inc\",\"eps1\":\"16.1700\",\"company2\":\"HealthPlus Labs\",\"eps2\":\"6.9800\",\"eps_difference\":\"9.1900\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company1\":\"GreenEnergy Corp\",\"eps1\":\"13.2900\",\"company2\":\"TechVision Inc\",\"eps2\":\"16.1700\",\"eps_difference\":\"-2.8800\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 4",
                "content": "{\"company1\":\"GreenEnergy Corp\",\"eps1\":\"13.2900\",\"company2\":\"HealthPlus Labs\",\"eps2\":\"6.9800\",\"eps_difference\":\"6.3100\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 5",
                "content": "{\"company1\":\"HealthPlus Labs\",\"eps1\":\"6.9800\",\"company2\":\"TechVision Inc\",\"eps2\":\"16.1700\",\"eps_difference\":\"-9.1900\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 6",
                "content": "{\"company1\":\"HealthPlus Labs\",\"eps1\":\"6.9800\",\"company2\":\"GreenEnergy Corp\",\"eps2\":\"13.2900\",\"eps_difference\":\"-6.3100\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The EPS (Earnings Per Share) value for TechVision Inc in 2023 is 16.17.",
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag": "QUANTITATIVE",
            "response": "The EPS (Earnings Per Share) value for GreenEnergy Corp in 2023 is 13.2900.",
            "confidence": 0.7
          },
          {
            "task_id": 3,
            "rag": "QUANTITATIVE",
            "response": "The EPS differences between the companies are as follows:\n\n1. TechVision Inc vs GreenEnergy Corp: 2.88\n2. TechVision Inc vs HealthPlus Labs: 9.19\n3. GreenEnergy Corp vs TechVision Inc: -2.88\n4. GreenEnergy Corp vs HealthPlus Labs: 6.31\n5. HealthPlus Labs vs TechVision Inc: -9.19\n\nThe largest positive EPS difference is 9.19 (TechVision Inc vs HealthPlus Labs), while the largest negative difference is -9.19 (HealthPlus Labs vs TechVision Inc).",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770619684921-93yffk": true,
      "results_trace-1770619778438-un2fis": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "CERN is located in Geneva, Switzerland.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "CERN studies fundamental particles and their interactions by colliding high-energy particles to understand the basic laws of nature and the universe's origins.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "CERN is located in Geneva, Switzerland.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "CERN studies fundamental particles and their interactions by colliding high-energy particles to understand the basic laws of nature and the universe's origins.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770619778438-un2fis": true,
      "results_trace-1770632647963-16kpo6": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of France is Paris.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of France is Paris.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770632647963-16kpo6": true,
      "results_trace-1770632697024-4pv2jf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770632697024-4pv2jf": true,
      "results_trace-1770632750272-jls31a": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770632750272-jls31a": true,
      "results_trace-1770632867330-g2t30k": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770632867330-g2t30k": true,
      "results_trace-1770632898553-yjbzba": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770632898553-yjbzba": true,
      "results_trace-1770633303261-0gers": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Machine learning is a subset of artificial intelligence that enables computer systems to learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Machine learning is a subset of artificial intelligence that enables computer systems to learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633303261-0gers": true,
      "results_trace-1770633335041-3vz4ji": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The net income for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"net_income\":\"1337550000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The net income for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770633335041-3vz4ji": true,
      "results_trace-1770633365601-v914q": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "NASA studies a wide range of research areas and topics including Earth science, planetary science, astrophysics, heliophysics, space technology, human exploration and operations, and aeronautics.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "QUANTITATIVE",
            "response": "The current cash balance of GreenEnergy Corp is $900,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"cash_and_equivalents\":\"900000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "NASA studies a wide range of research areas and topics including Earth science, planetary science, astrophysics, heliophysics, space technology, human exploration and operations, and aeronautics.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "QUANTITATIVE",
            "response": "The current cash balance of GreenEnergy Corp is $900,000,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770633365601-v914q": true,
      "results_trace-1770633413261-oy0zgb": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure (1 atm or 101.325 kPa).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure (1 atm or 101.325 kPa).",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633413261-oy0zgb": true,
      "results_trace-1770633449216-yrfvid": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The SQL query successfully retrieved the operating income for three companies in Q1 2023. The results show:\n\n1. GreenEnergy Corp: $184,690,000\n2. HealthPlus Labs: $48,153,000\n3. TechVision Inc: $465,908,000\n\nThese companies are part of the 'benchmark' tenant group, and their operating income figures are for the first quarter of the 2023 fiscal year. The data is ordered alphabetically by company name and limited to 1000 rows, though only 3 rows were returned in this case.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_id\":\"greenenergy\",\"company_name\":\"GreenEnergy Corp\",\"operating_income\":\"184690000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_id\":\"healthplus\",\"company_name\":\"HealthPlus Labs\",\"operating_income\":\"48153000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_id\":\"techvision\",\"company_name\":\"TechVision Inc\",\"operating_income\":\"465908000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The SQL query successfully retrieved the operating income for three companies in Q1 2023. The results show:\n\n1. GreenEnergy Corp: $184,690,000\n2. HealthPlus Labs: $48,153,000\n3. TechVision Inc: $465,908,000\n\nThese companies are part of the 'benchmark' tenant group, and their operating income figures are for the first quarter of the 2023 fiscal year. The data is ordered alphabetically by company name and limited to 1000 rows, though only 3 rows were returned in this case.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770633449216-yrfvid": true,
      "results_trace-1770633583336-j14s08": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633583336-j14s08": true,
      "results_trace-1770633588385-quel76f": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633588385-quel76f": true,
      "results_trace-1770633594260-7zzjru": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633594260-7zzjru": true,
      "results_trace-1770633598329-6wiam": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633598329-6wiam": true,
      "results_trace-1770633602776-52ngg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633602776-52ngg": true,
      "results_trace-1770633608973-1wrznc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633608973-1wrznc": true,
      "results_trace-1770633614578-dbtcsj": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633614578-dbtcsj": true,
      "results_trace-1770633622384-72n3t": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633622384-72n3t": true,
      "results_trace-1770633627252-dschfkk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633627252-dschfkk": true,
      "results_trace-1770633632287-89anql": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633632287-89anql": true,
      "results_trace-1770633637486-k5zzh2": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633637486-k5zzh2": true,
      "results_trace-1770633642702-v5tz5": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633642702-v5tz5": true,
      "results_trace-1770633646396-prefms": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770633646396-prefms": true,
      "results_trace-1770637441324-56cnrt": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for 2023 is $6,745,000,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for 2023 is $6,745,000,000.",
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "Albert Einstein created the Theory of Relativity.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770637441324-56cnrt": true,
      "results_trace-1770637497254-hp0j6l": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770637497254-hp0j6l": true,
      "results_trace-1770637618002-p9a4ne": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770637618002-p9a4ne": true,
      "results_trace-1770637653979-9w544b": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770637653979-9w544b": true,
      "results_trace-1770638062466-kn8zl5": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of France is Paris.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of France is Paris.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770638062466-kn8zl5": true,
      "results_trace-1770638097811-mf6gf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.9965%.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"fiscal_year\":2023,\"gross_profit_margin\":\"0.51996527777777777778\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.9965%.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770638097811-mf6gf": true,
      "results_trace-1770638505428-9vsph": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Machine learning is a branch of artificial intelligence that enables computer systems to automatically learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Machine learning is a branch of artificial intelligence that enables computer systems to automatically learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770638505428-9vsph": true,
      "results_trace-1770638727282-3iem8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "In 2023, TechVision Inc led the three companies with the highest R&D spending at $1,349,000,000, followed by GreenEnergy Corp at $365,000,000, and HealthPlus Labs at $288,000,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"TechVision Inc\",\"research_development\":\"1349000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_name\":\"GreenEnergy Corp\",\"research_development\":\"365000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"research_development\":\"288000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "The Louvre, Mus√©e d'Orsay, Centre Pompidou, Mus√©e Rodin, Mus√©e de l'Orangerie, Mus√©e Picasso, Mus√©e Carnavalet, Mus√©e de l'Arm√©e, Mus√©e de l'Air et de l'Espace, Mus√©e Gr√©vin, Mus√©e du Quai Branly, Mus√©e de la Chasse et de la Nature, Mus√©e de la Vie Romantique, Mus√©e de la Poup√©e, Mus√©e de la Magie, Mus√©e de la Musique, Mus√©e de la Publicit√©, Mus√©e de la Serrure, Mus√©e de la Sculpture en Plein Air, Mus√©e de la Tour Eiffel, Mus√©e de Montmartre, Mus√©e de l'Assistance Publique, Mus√©e de l'Histoire de France, Mus√©e de l'Homme, Mus√©e de l'Immigration, Mus√©e de l'Ordre de la Lib√©ration, Mus√©e de l'Ordre de Malte, Mus√©e de l'Ordre de Saint-Jean de J√©rusalem, Mus√©e de l'Ordre de Saint-Lazare, Mus√©e de l'Ordre de Saint-Thomas d'Aquin, Mus√©e de l'Ordre de Saint-Vincent de Paul, Mus√©e de l'Ordre de la Toison d'Or, Mus√©e de l'Ordre de la Couronne de Fer, Mus√©e de l'Ordre de la Couronne de Ch√™ne, Mus√©e de l'Ordre de la Couronne de Laurier, Mus√©e de l'Ordre de la Couronne de Palmier, Mus√©e de l",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "In 2023, TechVision Inc led the three companies with the highest R&D spending at $1,349,000,000, followed by GreenEnergy Corp at $365,000,000, and HealthPlus Labs at $288,000,000.",
            "confidence": 0.7
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "The Louvre, Mus√©e d'Orsay, Centre Pompidou, Mus√©e Rodin, Mus√©e de l'Orangerie, Mus√©e Picasso, Mus√©e Carnavalet, Mus√©e de l'Arm√©e, Mus√©e de l'Air et de l'Espace, Mus√©e Gr√©vin, Mus√©e du Quai Branly, Mus√©e de la Chasse et de la Nature, Mus√©e de la Vie Romantique, Mus√©e de la Poup√©e, Mus√©e de la Magie, Mus√©e de la Musique, Mus√©e de la Publicit√©, Mus√©e de la Serrure, Mus√©e de la Sculpture en Plein Air, Mus√©e de la Tour Eiffel, Mus√©e de Montmartre, Mus√©e de l'Assistance Publique, Mus√©e de l'Histoire de France, Mus√©e de l'Homme, Mus√©e de l'Immigration, Mus√©e de l'Ordre de la Lib√©ration, Mus√©e de l'Ordre de Malte, Mus√©e de l'Ordre de Saint-Jean de J√©rusalem, Mus√©e de l'Ordre de Saint-Lazare, Mus√©e de l'Ordre de Saint-Thomas d'Aquin, Mus√©e de l'Ordre de Saint-Vincent de Paul, Mus√©e de l'Ordre de la Toison d'Or, Mus√©e de l'Ordre de la Couronne de Fer, Mus√©e de l'Ordre de la Couronne de Ch√™ne, Mus√©e de l'Ordre de la Couronne de Laurier, Mus√©e de l'Ordre de la Couronne de Palmier, Mus√©e de l",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770638727282-3iem8": true,
      "results_trace-1770638827906-fdwd39": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The net income figure for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"net_income\":\"1337550000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The net income figure for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770638827906-fdwd39": true,
      "results_trace-1770639235689-x0yb6": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "NASA studies a wide range of research areas including Earth science, planetary science, astrophysics, heliophysics, aeronautics, human spaceflight, and technology development.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "QUANTITATIVE",
            "response": "GreenEnergy Corp's current cash balance is $900,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"current_cash_balance\":\"900000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "NASA studies a wide range of research areas including Earth science, planetary science, astrophysics, heliophysics, aeronautics, human spaceflight, and technology development.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "QUANTITATIVE",
            "response": "GreenEnergy Corp's current cash balance is $900,000,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770639235689-x0yb6": true,
      "results_trace-1770639305495-rdtxtz": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770639305495-rdtxtz": true,
      "results_trace-1770639340526-1geqt": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The SQL query successfully retrieved the operating income for three companies in Q1 2023. The results show:\n\n1. GreenEnergy Corp: $184,690,000\n2. HealthPlus Labs: $48,153,000\n3. TechVision Inc: $465,908,000\n\nThese figures represent the operating income for each company during the specified period. TechVision Inc has the highest operating income among the three companies, followed by GreenEnergy Corp and HealthPlus Labs.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_id\":\"greenenergy\",\"company_name\":\"GreenEnergy Corp\",\"operating_income\":\"184690000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_id\":\"healthplus\",\"company_name\":\"HealthPlus Labs\",\"operating_income\":\"48153000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_id\":\"techvision\",\"company_name\":\"TechVision Inc\",\"operating_income\":\"465908000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The SQL query successfully retrieved the operating income for three companies in Q1 2023. The results show:\n\n1. GreenEnergy Corp: $184,690,000\n2. HealthPlus Labs: $48,153,000\n3. TechVision Inc: $465,908,000\n\nThese figures represent the operating income for each company during the specified period. TechVision Inc has the highest operating income among the three companies, followed by GreenEnergy Corp and HealthPlus Labs.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770639340526-1geqt": true,
      "results_trace-1770639752626-kf9p0o": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Winston Churchill was a British statesman, orator, and author who served as Prime Minister of the United Kingdom during World War II and again from 1951 to 1955.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Winston Churchill was a British statesman, orator, and author who served as Prime Minister of the United Kingdom during World War II and again from 1951 to 1955.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770639752626-kf9p0o": true,
      "results_trace-1770639788837-njqbi": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Products in the AI/ML category include machine learning platforms, AI-powered analytics tools, natural language processing systems, computer vision software, and automated machine learning solutions.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "QUANTITATIVE",
            "response": "The revenue trend for AI/ML products shows consistent growth from 2020 to 2021. The top-performing product, MedAssist AI, increased its revenue from $6,518,196.66 in 2020 to $8,204,443.56 in 2021, representing a growth of approximately 25.8%. VisionAI Edge maintained steady revenue at $4,649,767.56 in both years, while VisionAI Platform generated $3,719,876.00 in 2020 but did not appear in the 2021 results (possibly due to the LIMIT 1000 constraint or actual sales performance). Overall, the AI/ML product line demonstrates positive revenue momentum, with MedAssist AI driving the majority of growth.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"product_name\":\"MedAssist AI\",\"fiscal_year\":2020,\"total_revenue\":\"6518196.66\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"product_name\":\"VisionAI Edge\",\"fiscal_year\":2020,\"total_revenue\":\"4649767.56\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"product_name\":\"VisionAI Platform\",\"fiscal_year\":2020,\"total_revenue\":\"3719876.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 4",
                "content": "{\"product_name\":\"MedAssist AI\",\"fiscal_year\":2021,\"total_revenue\":\"8204443.56\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 5",
                "content": "{\"product_name\":\"VisionAI Edge\",\"fiscal_year\":2021,\"total_revenue\":\"4649767.56\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 6",
                "content": "{\"product_name\":\"VisionAI Platform\",\"fiscal_year\":2021,\"total_revenue\":\"3719876.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 7",
                "content": "{\"product_name\":\"MedAssist AI\",\"fiscal_year\":2022,\"total_revenue\":\"9890690.48\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 8",
                "content": "{\"product_name\":\"VisionAI Edge\",\"fiscal_year\":2022,\"total_revenue\":\"4649767.56\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 9",
                "content": "{\"product_name\":\"VisionAI Platform\",\"fiscal_year\":2022,\"total_revenue\":\"3719876.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 10",
                "content": "{\"product_name\":\"MedAssist AI\",\"fiscal_year\":2023,\"total_revenue\":\"11576937.39\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Products in the AI/ML category include machine learning platforms, AI-powered analytics tools, natural language processing systems, computer vision software, and automated machine learning solutions.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "QUANTITATIVE",
            "response": "The revenue trend for AI/ML products shows consistent growth from 2020 to 2021. The top-performing product, MedAssist AI, increased its revenue from $6,518,196.66 in 2020 to $8,204,443.56 in 2021, representing a growth of approximately 25.8%. VisionAI Edge maintained steady revenue at $4,649,767.56 in both years, while VisionAI Platform generated $3,719,876.00 in 2020 but did not appear in the 2021 results (possibly due to the LIMIT 1000 constraint or actual sales performance). Overall, the AI/ML product line demonstrates positive revenue momentum, with MedAssist AI driving the majority of growth.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770639788837-njqbi": true,
      "results_trace-1770640435568-h8bale": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The total debt amount for HealthPlus Labs is $770,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_debt_amount\":\"770000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The total debt amount for HealthPlus Labs is $770,000,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770640435568-h8bale": true,
      "results_trace-1770640490635-7j6vkg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "GreenEnergy Corp sells solar panels, wind turbines, and energy storage systems.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "GreenEnergy Corp sells solar panels, wind turbines, and energy storage systems.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770640490635-7j6vkg": true,
      "results_trace-1770640619691-w9np8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The technology that preceded the Internet was the ARPANET, developed in the late 1960s by the U.S. Department of Defense's Advanced Research Projects Agency (ARPA).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The technology that preceded the Internet was the ARPANET, developed in the late 1960s by the U.S. Department of Defense's Advanced Research Projects Agency (ARPA).",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770640619691-w9np8": true,
      "results_trace-1770640656998-j43eac": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "DNA, or deoxyribonucleic acid, is the hereditary material in humans and almost all other organisms that carries genetic instructions for development, functioning, growth, and reproduction.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "DNA, or deoxyribonucleic acid, is the hereditary material in humans and almost all other organisms that carries genetic instructions for development, functioning, growth, and reproduction.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770640656998-j43eac": true,
      "results_trace-1770641073994-tu2kba": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "CERN is located in Geneva, Switzerland, straddling the Franco-Swiss border.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "CERN studies fundamental particles and their interactions by accelerating particles to high energies and colliding them, using advanced detectors to analyze the resulting particle showers and test theories like the Standard Model.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "CERN is located in Geneva, Switzerland, straddling the Franco-Swiss border.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "CERN studies fundamental particles and their interactions by accelerating particles to high energies and colliding them, using advanced detectors to analyze the resulting particle showers and test theories like the Standard Model.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770641073994-tu2kba": true,
      "results_trace-1770641236837-y2o0q9": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Vaccination protects against diseases such as measles, mumps, rubella, polio, tetanus, diphtheria, pertussis, hepatitis B, influenza, and pneumococcal infections.",
            "sources": [],
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag_called": "STANDARD",
            "response": "The number of medical employees at HealthPlus is not provided in the given context.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Vaccination protects against diseases such as measles, mumps, rubella, polio, tetanus, diphtheria, pertussis, hepatitis B, influenza, and pneumococcal infections.",
            "confidence": 0.5
          },
          {
            "task_id": 2,
            "rag": "STANDARD",
            "response": "The number of medical employees at HealthPlus is not provided in the given context.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770641236837-y2o0q9": true,
      "results_trace-1770641314397-iam96": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The ozone layer is a region of Earth's stratosphere containing a high concentration of ozone (O3) molecules, which absorb most of the sun's harmful ultraviolet radiation, protecting life on Earth from its damaging effects.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The ozone layer is a region of Earth's stratosphere containing a high concentration of ozone (O3) molecules, which absorb most of the sun's harmful ultraviolet radiation, protecting life on Earth from its damaging effects.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770641314397-iam96": true,
      "results_trace-1770641351837-zv682n": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "Based on the SQL query results, HealthPlus Labs (company_id: healthplus) has the highest revenue growth between 2020 and 2023, with a growth rate of 260%.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_id\":\"healthplus\",\"company_name\":\"HealthPlus Labs\",\"revenue_growth_percentage\":\"260.0000000000000000\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "Based on the SQL query results, HealthPlus Labs (company_id: healthplus) has the highest revenue growth between 2020 and 2023, with a growth rate of 260%.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770641351837-zv682n": true,
      "results_trace-1770642359083-hfhqlc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642359083-hfhqlc": true,
      "results_trace-1770642365154-nccpb": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642365154-nccpb": true,
      "results_trace-1770642369322-e7z8th": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642369322-e7z8th": true,
      "results_trace-1770642374804-beb2kp": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642374804-beb2kp": true,
      "results_trace-1770642378731-7gkokh": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642378731-7gkokh": true,
      "results_trace-1770642382787-z3n3bs": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642382787-z3n3bs": true,
      "results_trace-1770642388331-h089g": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642388331-h089g": true,
      "results_trace-1770642392433-jxx4s": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642392433-jxx4s": true,
      "results_trace-1770642396413-sic1cf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642396413-sic1cf": true,
      "results_trace-1770642400472-paqfs": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642400472-paqfs": true,
      "results_trace-1770642404532-ed5qf5": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642404532-ed5qf5": true,
      "results_trace-1770642408534-rdk95m": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642408534-rdk95m": true,
      "results_trace-1770642412863-2bz9qd": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642412863-2bz9qd": true,
      "results_trace-1770642417101-zyngfm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642417101-zyngfm": true,
      "results_trace-1770642421006-dkwdm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642421006-dkwdm": true,
      "results_trace-1770642425044-mafls": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642425044-mafls": true,
      "results_trace-1770642430462-4zg0yv": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642430462-4zg0yv": true,
      "results_trace-1770642434538-eigq6u": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642434538-eigq6u": true,
      "results_trace-1770642438831-gitchh": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642438831-gitchh": true,
      "results_trace-1770642442876-genp5v": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642442876-genp5v": true,
      "results_trace-1770642446876-x9auv": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642446876-x9auv": true,
      "results_trace-1770642450665-m4awkq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642450665-m4awkq": true,
      "results_trace-1770642454527-x4t6ye": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642454527-x4t6ye": true,
      "results_trace-1770642458544-ri9i8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642458544-ri9i8": true,
      "results_trace-1770642462466-gmecwe": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642462466-gmecwe": true,
      "results_trace-1770642466529-dr4vro": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642466529-dr4vro": true,
      "results_trace-1770642470409-i9zdzv": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642470409-i9zdzv": true,
      "results_trace-1770642474480-xqjmuf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642474480-xqjmuf": true,
      "results_trace-1770642478513-5mgt2a": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642478513-5mgt2a": true,
      "results_trace-1770642482385-55t74m": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642482385-55t74m": true,
      "results_trace-1770642486359-ym8ytyl": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642486359-ym8ytyl": true,
      "results_trace-1770642490371-8mf01a": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642490371-8mf01a": true,
      "results_trace-1770642494458-el3uwn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642494458-el3uwn": true,
      "results_trace-1770642498582-dd8n1b": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642498582-dd8n1b": true,
      "results_trace-1770642502768-ap32rk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642502768-ap32rk": true,
      "results_trace-1770642506702-385op": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642506702-385op": true,
      "results_trace-1770642510718-ry5pmb": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642510718-ry5pmb": true,
      "results_trace-1770642514574-2ibyec": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642514574-2ibyec": true,
      "results_trace-1770642518357-yyvrhe": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642518357-yyvrhe": true,
      "results_trace-1770642522218-hghw0r": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642522218-hghw0r": true,
      "results_trace-1770642526148-o43jgf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642526148-o43jgf": true,
      "results_trace-1770642530095-w0x71k": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642530095-w0x71k": true,
      "results_trace-1770642534289-8lbp1": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642534289-8lbp1": true,
      "results_trace-1770642538228-ngl8r5": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642538228-ngl8r5": true,
      "results_trace-1770642542811-yr1vxq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642542811-yr1vxq": true,
      "results_trace-1770642546853-bq0hqg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642546853-bq0hqg": true,
      "results_trace-1770642550965-0ppha": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642550965-0ppha": true,
      "results_trace-1770642554780-xexq1": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642554780-xexq1": true,
      "results_trace-1770642570059-dh0ev2": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770642570059-dh0ev2": true,
      "results_trace-1770645021189-u3aosh": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770645021189-u3aosh": true,
      "results_trace-1770645373934-xulzo8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770645373934-xulzo8": true,
      "results_trace-1770646399976-wrvsa6": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The sum of 2 + 2 is 4.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"sum_result\":4}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The sum of 2 + 2 is 4.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770646399976-wrvsa6": true,
      "results_trace-1770653392132-qu87eg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770653392132-qu87eg": true,
      "results_trace-1770658454118-wpyb5k": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770658454118-wpyb5k": true,
      "results_trace-1770658918383-eoma2p": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770658918383-eoma2p": true,
      "results_trace-1770659962933-4glqm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770659962933-4glqm": true,
      "results_trace-1770659973613-ik5en": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770659973613-ik5en": true,
      "results_trace-1770659983333-zfdz8t": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770659983333-zfdz8t": true,
      "results_trace-1770659993529-i35li": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770659993529-i35li": true,
      "results_trace-1770660002569-wvvj4s": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660002569-wvvj4s": true,
      "results_trace-1770660014192-0g91p": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660014192-0g91p": true,
      "results_trace-1770660024029-2u1nmq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660024029-2u1nmq": true,
      "results_trace-1770660034203-ud5emf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660034203-ud5emf": true,
      "results_trace-1770660045018-3v9juvd": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660045018-3v9juvd": true,
      "results_trace-1770660055125-9qc529": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660055125-9qc529": true,
      "results_trace-1770660064372-15n32k": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660064372-15n32k": true,
      "results_trace-1770660074245-h9vabi": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660074245-h9vabi": true,
      "results_trace-1770660083987-8caaa": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660083987-8caaa": true,
      "results_trace-1770660093972-1kiwrs": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660093972-1kiwrs": true,
      "results_trace-1770660103385-anyfdu": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660103385-anyfdu": true,
      "results_trace-1770660112382-a5jzkc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660112382-a5jzkc": true,
      "results_trace-1770660122729-8abe0h": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660122729-8abe0h": true,
      "results_trace-1770660132116-nxl1mm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660132116-nxl1mm": true,
      "results_trace-1770660141514-dgbrm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660141514-dgbrm": true,
      "results_trace-1770660151068-ru8ms": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660151068-ru8ms": true,
      "results_trace-1770660161014-n08k4": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660161014-n08k4": true,
      "results_trace-1770660171698-ye3a83": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660171698-ye3a83": true,
      "results_trace-1770660182159-ojno": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660182159-ojno": true,
      "results_trace-1770660192905-l64y6k": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660192905-l64y6k": true,
      "results_trace-1770660202701-9s1nv": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660202701-9s1nv": true,
      "results_trace-1770660211841-1hkpgy": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660211841-1hkpgy": true,
      "results_trace-1770660220945-ddiemk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660220945-ddiemk": true,
      "results_trace-1770660230291-p7b3v": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660230291-p7b3v": true,
      "results_trace-1770660239868-1bv8yr": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660239868-1bv8yr": true,
      "results_trace-1770660249270-v6rvuk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660249270-v6rvuk": true,
      "results_trace-1770660258732-1wl8q": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660258732-1wl8q": true,
      "results_trace-1770660268544-4fm9am": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660268544-4fm9am": true,
      "results_trace-1770660278591-fy3j2": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660278591-fy3j2": true,
      "results_trace-1770660288918-opoib7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660288918-opoib7": true,
      "results_trace-1770660300580-u8gqz": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660300580-u8gqz": true,
      "results_trace-1770660330705-zhhbl3l": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660330705-zhhbl3l": true,
      "results_trace-1770660339814-nz15ng": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660339814-nz15ng": true,
      "results_trace-1770660349196-aadlln": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660349196-aadlln": true,
      "results_trace-1770660359414-zxkgv": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660359414-zxkgv": true,
      "results_trace-1770660368935-qd1wk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660368935-qd1wk": true,
      "results_trace-1770660378128-ap0nua": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660378128-ap0nua": true,
      "results_trace-1770660387363-240h3n": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660387363-240h3n": true,
      "results_trace-1770660396810-9hctln": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660396810-9hctln": true,
      "results_trace-1770660406215-5fxgyg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660406215-5fxgyg": true,
      "results_trace-1770660415590-ol342": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660415590-ol342": true,
      "results_trace-1770660425405-v8kacl": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660425405-v8kacl": true,
      "results_trace-1770660435388-spp6n": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660435388-spp6n": true,
      "results_trace-1770660445533-2euwyf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660445533-2euwyf": true,
      "results_trace-1770660455484-3xw0gq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770660455484-3xw0gq": true,
      "results_trace-1770661051557-b9zop": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661051557-b9zop": true,
      "results_trace-1770661067020-iulhrn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661067020-iulhrn": true,
      "results_trace-1770661081875-2extcf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661081875-2extcf": true,
      "results_trace-1770661096806-pkbiar": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661096806-pkbiar": true,
      "results_trace-1770661112384-l2nod": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661112384-l2nod": true,
      "results_trace-1770661127694-bjbco": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661127694-bjbco": true,
      "results_trace-1770661143283-prd53": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661143283-prd53": true,
      "results_trace-1770661159333-oxb0ai": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661159333-oxb0ai": true,
      "results_trace-1770661178108-gdqnqg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661178108-gdqnqg": true,
      "results_trace-1770661193165-exqzef": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661193165-exqzef": true,
      "results_trace-1770661337058-mllyrzn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770661337058-mllyrzn": true,
      "results_trace-1770662939227-n3eped": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770662939227-n3eped": true,
      "results_trace-1770663511251-fdjgv9": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770663511251-fdjgv9": true,
      "results_trace-1770663976411-mrl2k": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The Q4 2023 revenue for GreenEnergy Corp is $1,021,500,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The Q4 2023 revenue for GreenEnergy Corp is $1,021,500,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770663976411-mrl2k": true,
      "results_trace-1770664542714-hsqykg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770664542714-hsqykg": true,
      "results_trace-1770665375943-6c210g": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of France is Paris.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of France is Paris.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770665375943-6c210g": true,
      "results_trace-1770665842159-8yz663": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770665842159-8yz663": true,
      "results_trace-1770666286582-9nyoy": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer - retrieval and LLM both unavailable",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770666286582-9nyoy": true,
      "results_trace-1770669697207-ow9uk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770669697207-ow9uk": true,
      "results_trace-1770669748999-eaztig": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $13,490,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_revenue\":\"13490000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $13,490,000,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770669748999-eaztig": true,
      "results_trace-1770669818415-my99f8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770669818415-my99f8": true,
      "results_trace-1770670771697-ebbgei": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770670771697-ebbgei": true,
      "results_trace-1770671208474-jfb2d5": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770671208474-jfb2d5": true,
      "results_trace-1770671458838-zj58h4": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields, physics in 1903 and chemistry in 1911.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields, physics in 1903 and chemistry in 1911.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770671458838-zj58h4": true,
      "results_trace-1770672282361-vyknc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of France is Paris.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of France is Paris.",
            "confidence": 0.5
          }
        ]
      },
      "complete_trace-1770672282361-vyknc": true,
      "results_trace-1770672346921-pi9r57": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.996527777777777778%, or approximately 52%.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"fiscal_year\":2023,\"gross_profit\":\"599000000.00\",\"revenue\":\"1152000000.00\",\"gross_profit_margin\":\"0.51996527777777777778\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.996527777777777778%, or approximately 52%.",
            "confidence": 0.7
          }
        ]
      },
      "complete_trace-1770672346921-pi9r57": true,
      "results_trace-1770675301013-m1cdcn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 45%.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 45%.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770675530164-ok7lrv": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 was $6,745,000,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 was $6,745,000,000.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770675580355-urcypy": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The document does not provide information about scientists connected to the University of Cambridge or the total employee count at TechVision.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The document does not provide information about scientists connected to the University of Cambridge or the total employee count at TechVision.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770675747283-qzrkwh": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Artificial Intelligence as a field was created by John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon in 1956, and it is used by companies like Google, Amazon, IBM, Microsoft, and Apple.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Artificial Intelligence as a field was created by John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon in 1956, and it is used by companies like Google, Amazon, IBM, Microsoft, and Apple.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770675838638-qmmb1r": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770675873566-dfv7a7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields (Physics in 1903 and Chemistry in 1911).",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770675941875-lqfk2": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Machine learning is a subset of artificial intelligence that enables computer systems to automatically learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Machine learning is a subset of artificial intelligence that enables computer systems to automatically learn and improve from experience without being explicitly programmed, by identifying patterns in data and making predictions or decisions based on those patterns.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770675993838-h214m": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "Based on the SQL query results, here's a comparison of R&D spending for the three companies in 2023:\n\n1. TechVision Inc: $1,349,000,000.00\n2. GreenEnergy Corp: $365,000,000.00\n3. HealthPlus Labs: $288,000,000.00\n\nTechVision Inc has the highest R&D spending among the three companies, investing over $1.3 billion in research and development. GreenEnergy Corp follows with $365 million, while HealthPlus Labs has the lowest R&D spending at $288 million.\n\nThe data shows a significant difference in R&D investment between TechVision Inc and the other two companies, with TechVision Inc spending nearly 3.7 times more than GreenEnergy Corp and about 4.7 times more than HealthPlus Labs.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"TechVision Inc\",\"research_development\":\"1349000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_name\":\"GreenEnergy Corp\",\"research_development\":\"365000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"research_development\":\"288000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "Based on the SQL query results, here's a comparison of R&D spending for the three companies in 2023:\n\n1. TechVision Inc: $1,349,000,000.00\n2. GreenEnergy Corp: $365,000,000.00\n3. HealthPlus Labs: $288,000,000.00\n\nTechVision Inc has the highest R&D spending among the three companies, investing over $1.3 billion in research and development. GreenEnergy Corp follows with $365 million, while HealthPlus Labs has the lowest R&D spending at $288 million.\n\nThe data shows a significant difference in R&D investment between TechVision Inc and the other two companies, with TechVision Inc spending nearly 3.7 times more than GreenEnergy Corp and about 4.7 times more than HealthPlus Labs.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770676048157-mo56vf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The net income for TechVision Inc in fiscal year 2022 is $1,337,550,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"net_income\":\"1337550000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The net income for TechVision Inc in fiscal year 2022 is $1,337,550,000.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770676081805-nub6sg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alfred Hitchcock, Stanley Kubrick, and Christopher Nolan are notable film directors who have worked in London.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alfred Hitchcock, Stanley Kubrick, and Christopher Nolan are notable film directors who have worked in London.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770676147809-r4ocjt": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "NASA studies a wide range of research areas including aeronautics, space exploration, Earth science, planetary science, astrophysics, heliophysics, and human spaceflight.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "NASA studies a wide range of research areas including aeronautics, space exploration, Earth science, planetary science, astrophysics, heliophysics, and human spaceflight.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770676196011-c2exe7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure (1 atm or 101.325 kPa).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The boiling point of water is 100¬∞C (212¬∞F) at standard atmospheric pressure (1 atm or 101.325 kPa).",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770676230319-0nxek": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The total operating income for all companies in Q1 2023 is 698,751,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_operating_income\":\"698751000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The total operating income for all companies in Q1 2023 is 698,751,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770676358499-j892sl": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The World Health Organization (WHO) is a specialized agency of the United Nations (UN) that is responsible for international public health.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The World Health Organization (WHO) is a specialized agency of the United Nations (UN) that is responsible for international public health.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770676435651-krqu5t": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Winston Churchill was a British statesman who served as Prime Minister of the United Kingdom during World War II and again from 1951 to 1955. He was born on November 30, 1874, at Blenheim Palace in Oxfordshire, England, and died on January 24, 1965, at the age of 90. Churchill was known for his leadership during the war, his powerful speeches, and his prolific writing career, which earned him the Nobel Prize in Literature in 1953.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Winston Churchill was a British statesman who served as Prime Minister of the United Kingdom during World War II and again from 1951 to 1955. He was born on November 30, 1874, at Blenheim Palace in Oxfordshire, England, and died on January 24, 1965, at the age of 90. Churchill was known for his leadership during the war, his powerful speeches, and his prolific writing career, which earned him the Nobel Prize in Literature in 1953.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770676477123-eilj0w": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The knowledge graph contains Nobel Prize winners such as Marie Curie (discovered radioactivity), Albert Einstein (theory of relativity), and Martin Luther King Jr. (civil rights movement).",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The knowledge graph contains Nobel Prize winners such as Marie Curie (discovered radioactivity), Albert Einstein (theory of relativity), and Martin Luther King Jr. (civil rights movement).",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770676561206-wv6xw": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The query successfully retrieved operating income data for 3 companies in Q1 2023. The results show:\n\n1. GreenEnergy Corp: $184,690,000\n2. HealthPlus Labs: $48,153,000  \n3. TechVision Inc: $465,908,000\n\nThese are the only companies in the 'benchmark' tenant with available operating income data for Q1 2023. The data appears to be complete for the specified criteria, with no missing values in the operating_income field for these companies.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_id\":\"greenenergy\",\"company_name\":\"GreenEnergy Corp\",\"fiscal_year\":2023,\"period\":\"Q1\",\"operating_income\":\"184690000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_id\":\"healthplus\",\"company_name\":\"HealthPlus Labs\",\"fiscal_year\":2023,\"period\":\"Q1\",\"operating_income\":\"48153000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_id\":\"techvision\",\"company_name\":\"TechVision Inc\",\"fiscal_year\":2023,\"period\":\"Q1\",\"operating_income\":\"465908000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The query successfully retrieved operating income data for 3 companies in Q1 2023. The results show:\n\n1. GreenEnergy Corp: $184,690,000\n2. HealthPlus Labs: $48,153,000  \n3. TechVision Inc: $465,908,000\n\nThese are the only companies in the 'benchmark' tenant with available operating income data for Q1 2023. The data appears to be complete for the specified criteria, with no missing values in the operating_income field for these companies.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770676605255-7jjum8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770676655538-8zo9x": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770676869721-yoyqlc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The Q4 2023 revenue for GreenEnergy Corp is $1,021,500,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The Q4 2023 revenue for GreenEnergy Corp is $1,021,500,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770677006997-z0gp2": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The scientists connected to the University of Cambridge are not specified in the provided context, and the total employee count at TechVision is also not mentioned.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The scientists connected to the University of Cambridge are not specified in the provided context, and the total employee count at TechVision is also not mentioned.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770677070496-acz7ym": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of France is Paris.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of France is Paris.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770677101285-shypdw": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.996527777777777778%.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"fiscal_year\":2023,\"gross_profit\":\"599000000.00\",\"revenue\":\"1152000000.00\",\"gross_profit_margin\":\"0.51996527777777777778\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The gross profit margin for HealthPlus Labs in 2023 is 51.996527777777777778%.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770677151455-b1u1eu": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Artificial Intelligence as a field was created by John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon in 1956 at the Dartmouth Conference. Companies that use AI include Google, Amazon, Microsoft, IBM, Facebook, Apple, Tesla, and many others across various industries.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Artificial Intelligence as a field was created by John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon in 1956 at the Dartmouth Conference. Companies that use AI include Google, Amazon, Microsoft, IBM, Facebook, Apple, Tesla, and many others across various industries.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770677220254-2td8ie": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Machine learning is a branch of artificial intelligence that enables computer systems to learn and improve from experience without being explicitly programmed, using algorithms to analyze data, identify patterns, and make decisions or predictions.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Machine learning is a branch of artificial intelligence that enables computer systems to learn and improve from experience without being explicitly programmed, using algorithms to analyze data, identify patterns, and make decisions or predictions.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770677247197-1h57o": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The SQL query results show the R&D spending of three companies in 2023. TechVision Inc appears twice with different R&D spending amounts: $1,349,000,000.00 and $370,300,000.00. GreenEnergy Corp has an R&D spending of $365,000,000.00. The results are ordered by R&D spending in descending order. It's worth noting that TechVision Inc's duplicate entry with significantly different R&D spending amounts might indicate an error in the data or a need for further investigation into the company's financial records.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"TechVision Inc\",\"rd_spending\":\"1349000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_name\":\"TechVision Inc\",\"rd_spending\":\"370300000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_name\":\"GreenEnergy Corp\",\"rd_spending\":\"365000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The SQL query results show the R&D spending of three companies in 2023. TechVision Inc appears twice with different R&D spending amounts: $1,349,000,000.00 and $370,300,000.00. GreenEnergy Corp has an R&D spending of $365,000,000.00. The results are ordered by R&D spending in descending order. It's worth noting that TechVision Inc's duplicate entry with significantly different R&D spending amounts might indicate an error in the data or a need for further investigation into the company's financial records.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770677315901-oz2c5": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The net income figure for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"net_income\":\"1337550000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The net income figure for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_test-fix-v2": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "GRAPH",
            "response": "John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon.",
            "sources": [
              {
                "source": "graph_rag_llm_synthesis",
                "content": "",
                "type": "graph"
              }
            ],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "GRAPH",
            "response": "John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770679076174-gvfyu": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The field of Artificial Intelligence was created by John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon, who organized the Dartmouth Summer Research Project on Artificial Intelligence in 1956.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The field of Artificial Intelligence was created by John McCarthy, Marvin Minsky, Nathaniel Rochester, and Claude Shannon, who organized the Dartmouth Summer Research Project on Artificial Intelligence in 1956.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770679531486-7tjp9": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields, Physics and Chemistry.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie was the first woman to win a Nobel Prize and remains the only person to have won Nobel Prizes in two different scientific fields, Physics and Chemistry.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770679576446-t0v67": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The net income for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"net_income\":\"1337550000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The net income for TechVision Inc in fiscal year 2022 is $1,337,550,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770679617922-lh9fbl": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's revenue for the year 2023 is $6,745,000,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770679647151-tetmc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Alexander Fleming discovered penicillin in 1928.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770679682465-5xbgy": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"revenue\":\"1021500000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The Q4 2023 revenue figure for GreenEnergy Corp is $1,021,500,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770680638780-b1jhfh": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "GRAPH",
            "response": "Alfred Hitchcock, Stanley Kubrick, Ridley Scott, Christopher Nolan, Danny Boyle, Mike Leigh",
            "sources": [
              {
                "source": "graph_rag_llm_synthesis",
                "content": "",
                "type": "graph"
              }
            ],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "GRAPH",
            "response": "Alfred Hitchcock, Stanley Kubrick, Ridley Scott, Christopher Nolan, Danny Boyle, Mike Leigh",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770680693232-r7a0lq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "NASA studies a wide range of scientific fields including Earth science, planetary science, astrophysics, heliophysics, and biological and physical sciences, as well as aeronautics and space technology development.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "NASA studies a wide range of scientific fields including Earth science, planetary science, astrophysics, heliophysics, and biological and physical sciences, as well as aeronautics and space technology development.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770680763480-icmom": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Products in the AI/ML category include machine learning platforms, AI-powered analytics tools, natural language processing systems, computer vision software, and automated machine learning solutions.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Products in the AI/ML category include machine learning platforms, AI-powered analytics tools, natural language processing systems, computer vision software, and automated machine learning solutions.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770680838663-xwdhbi": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The total debt amount for HealthPlus Labs varies across different records, with values of $240,000,000.00, $215,000,000.00, $175,000,000.00, and $140,000,000.00. This suggests that the data represents different time periods or reporting instances for the company.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"total_debt\":\"240000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 2",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"total_debt\":\"215000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 3",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"total_debt\":\"175000000.00\"}",
                "type": "sql"
              },
              {
                "source": "SQL Result 4",
                "content": "{\"company_name\":\"HealthPlus Labs\",\"total_debt\":\"140000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The total debt amount for HealthPlus Labs varies across different records, with values of $240,000,000.00, $215,000,000.00, $175,000,000.00, and $140,000,000.00. This suggests that the data represents different time periods or reporting instances for the company.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770680889063-5xcs59": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "GreenEnergy Corp sells solar panels, wind turbines, and energy storage systems.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "GreenEnergy Corp sells solar panels, wind turbines, and energy storage systems.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770680961320-8g0bs4": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The technology that preceded the Internet was the ARPANET, developed in the late 1960s as a precursor to modern internet protocols.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The technology that preceded the Internet was the ARPANET, developed in the late 1960s as a precursor to modern internet protocols.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770681010529-vum8r": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "DNA, or deoxyribonucleic acid, is a molecule that carries the genetic instructions used in the growth, development, functioning, and reproduction of all known living organisms and many viruses.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "DNA, or deoxyribonucleic acid, is a molecule that carries the genetic instructions used in the growth, development, functioning, and reproduction of all known living organisms and many viruses.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770681067031-cxt2t": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "The basic earnings per share (EPS) for TechVision Inc in 2023 is 16.17.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"basic_eps\":\"16.1700\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "The basic earnings per share (EPS) for TechVision Inc in 2023 is 16.17.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770681126690-ugn99r": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "CERN is located in Geneva, Switzerland, straddling the Franco-Swiss border near the city.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "CERN is located in Geneva, Switzerland, straddling the Franco-Swiss border near the city.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770681176819-rrq1g6": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Vaccination protects against diseases such as measles, mumps, rubella, polio, diphtheria, tetanus, pertussis, hepatitis B, influenza, and pneumococcal infections.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Vaccination protects against diseases such as measles, mumps, rubella, polio, diphtheria, tetanus, pertussis, hepatitis B, influenza, and pneumococcal infections.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701115382-ibdenk": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701120087-9gjcme": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701124091-l8chop": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701128228-fn9ir": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701132522-8hj6ml3": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701136716-3w43na": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701141179-qlf9ur": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701145620-qmqoir": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701150783-zmp6jo": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770701156022-49d9l8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710885505-5zn03": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710892098-xatmkj": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710896714-2keqb": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710901315-yquzcq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710905772-9jfgli": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710910305-b882": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710915157-hb3gd": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710920011-wsf2pq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710924994-ako1w": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770710930564-9xn5to": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714007923-hszzbj": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714013619-us4pgf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714018863-8tuvqu": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714023683-yw37zc": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714028552-y5hja4": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714033630-o0m9ai": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714038546-6p1umd": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714043505-p4x0t": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714048998-1mutms": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714053728-fjkpv": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714058666-k9brde": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714068222-tguq8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714073314-mjigmn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714078382-auuos7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714083047-cg0qt7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714087971-nwj5gm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714092730-o7lgj": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714098719-5tcevr": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714103406-uxppwi": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714109484-z5pveh": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714114358-0cmjwe": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714118991-k8jil9": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714123926-ydvdz": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714128794-4pdoa": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714135048-rlv8en": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714139793-qei2gn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714144401-rw1bqq": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714149405-t8yg0c": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714154065-yqdp4": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714158978-5ntsp": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714163800-4tj0g7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714168804-wgh27": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714173547-90yg66": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714178354-c3tp1": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714182935-qtsm3j": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714187792-m3n894": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714192513-p8q6ml": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714197351-wmvh3w": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714202116-lf6uve": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714206847-ngz09g": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714211883-yssn6g": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714217004-9vjty": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714223420-2ufi3": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714228183-zsq15": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714232893-5g9ly7": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714237950-a946p": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714242518-qow92": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714247158-toubn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714251803-jbc0n": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770714256541-ku966h": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770716046667-yiwbze": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770716528976-lbxzuf": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770717007578-s4ymt": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770717038260-pgm9j": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $6,745,000,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $6,745,000,000.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770717071129-klfk8o": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770718038045-7ktfor": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Unable to generate answer",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Unable to generate answer",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770718332380-74qt55": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The capital city of Japan is Tokyo.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719216645-pkeru8": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719251720-dc2amb": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 is $6,745,000,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 is $6,745,000,000.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770719292514-7kmjj3": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719324460-u7r7nd": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Leonardo da Vinci painted the Mona Lisa.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Leonardo da Vinci painted the Mona Lisa.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719361723-g4d4rl": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The Pacific Ocean is the largest ocean by size, covering approximately 165.25 million square kilometers.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The Pacific Ocean is the largest ocean by size, covering approximately 165.25 million square kilometers.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719632624-fzj3go": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719647523-bu0xpj": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $13,490,000,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_revenue\":\"13490000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $13,490,000,000.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770719669013-3t8lkm": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics (1903) for her work on radioactivity and in Chemistry (1911) for discovering radium and polonium.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719691417-5aujg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Leonardo da Vinci painted the Mona Lisa.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Leonardo da Vinci painted the Mona Lisa.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770719713004-1lqin": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The Pacific Ocean is the largest ocean by size, covering approximately 165.25 million square kilometers.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The Pacific Ocean is the largest ocean by size, covering approximately 165.25 million square kilometers.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770720916008-f6hbnl": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for fiscal year 2023 is $6,745,000,000.00.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for fiscal year 2023 is $6,745,000,000.00.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770721197935-54tdrg": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Tokyo is the capital city of Japan.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770721217949-yluaqn": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $6,745,000,000.",
            "sources": [
              {
                "source": "SQL Result 1",
                "content": "{\"total_revenue\":\"6745000000.00\"}",
                "type": "sql"
              }
            ],
            "confidence": 0.7
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "QUANTITATIVE",
            "response": "TechVision Inc's total revenue for 2023 was $6,745,000,000.",
            "confidence": 0.7
          }
        ]
      },
      "results_trace-1770721245997-81ovfh": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics in 1903 for her work on radioactivity and in Chemistry in 1911 for discovering radium and polonium.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Marie Curie won Nobel Prizes in Physics in 1903 for her work on radioactivity and in Chemistry in 1911 for discovering radium and polonium.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770721270077-kx78a": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "Leonardo da Vinci painted the Mona Lisa.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "Leonardo da Vinci painted the Mona Lisa.",
            "confidence": 0.5
          }
        ]
      },
      "results_trace-1770721287873-nz6n5p": {
        "completed_tasks": [
          {
            "task_id": 1,
            "rag_called": "STANDARD",
            "response": "The Pacific Ocean is the largest ocean by size, covering approximately 165.25 million square kilometers.",
            "sources": [],
            "confidence": 0.5
          }
        ],
        "error_tasks": [],
        "skipped_tasks": [],
        "all_responses": [
          {
            "task_id": 1,
            "rag": "STANDARD",
            "response": "The Pacific Ocean is the largest ocean by size, covering approximately 165.25 million square kilometers.",
            "confidence": 0.5
          }
        ]
      }
    }
  },
  "meta": null,
  "pinData": null,
  "versionId": "b67bc702-0805-4604-a294-da92ebc4a503",
  "activeVersionId": "b67bc702-0805-4604-a294-da92ebc4a503",
  "versionCounter": 364,
  "triggerCount": 2,
  "shared": [
    {
      "updatedAt": "2026-02-09T04:28:15.677Z",
      "createdAt": "2026-02-09T04:28:15.677Z",
      "role": "workflow:owner",
      "workflowId": "ALd4gOEqiKL5KR1p",
      "projectId": "JV7MbqBbWPTstXIo",
      "project": {
        "updatedAt": "2026-01-07T13:20:26.996Z",
        "createdAt": "2026-01-07T13:20:21.870Z",
        "id": "JV7MbqBbWPTstXIo",
        "name": "Alexis Moret <alexis.moret6@outlook.fr>",
        "type": "personal",
        "icon": null,
        "description": null,
        "creatorId": "215767e0-958a-4c74-a67a-e335807eba64",
        "projectRelations": [
          {
            "updatedAt": "2026-01-07T13:20:21.870Z",
            "createdAt": "2026-01-07T13:20:21.870Z",
            "userId": "215767e0-958a-4c74-a67a-e335807eba64",
            "projectId": "JV7MbqBbWPTstXIo",
            "user": {
              "updatedAt": "2026-02-09T23:01:37.000Z",
              "createdAt": "2026-01-07T13:20:20.003Z",
              "id": "215767e0-958a-4c74-a67a-e335807eba64",
              "email": "alexis.moret6@outlook.fr",
              "firstName": "Alexis",
              "lastName": "Moret",
              "personalizationAnswers": null,
              "settings": {
                "userActivated": true,
                "userClaimedAiCredits": true,
                "easyAIWorkflowOnboarded": true,
                "firstSuccessfulWorkflowId": "e3_89vptJG7PPA-OHyAg3",
                "userActivatedAt": 1767837780144,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1768407850905
                }
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2026-02-09",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [],
  "activeVersion": {
    "updatedAt": "2026-02-09T22:58:54.208Z",
    "createdAt": "2026-02-09T22:58:54.208Z",
    "versionId": "b67bc702-0805-4604-a294-da92ebc4a503",
    "workflowId": "ALd4gOEqiKL5KR1p",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "92217bb8-ffc8-459a-8331-3f553812c3d0",
          "responseMode": "responseNode",
          "options": {
            "rawBody": false
          }
        },
        "id": "f744daf0-5a48-444c-800a-b1b3cc4ae510",
        "name": "Webhook V8",
        "type": "n8n-nodes-base.webhook",
        "position": [
          16768,
          22288
        ],
        "typeVersion": 2.1,
        "webhookId": "92217bb8-ffc8-459a-8331-3f553812c3d0"
      },
      {
        "parameters": {
          "public": true,
          "initialMessages": "üß† Bienvenue! Je suis l'assistant RAG SOTA 2026 **V8.0 CoT**.\n\n‚ú® Nouveaut√©s:\n- Chain-of-Thought reasoning\n- Adaptive retrieval\n- Meilleure planification\n\nPosez-moi vos questions!",
          "options": {
            "responseMode": "responseNode"
          }
        },
        "id": "ad2972dd-a8f8-4368-8546-aeb5f5449ca8",
        "name": "Chat Trigger V8",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "typeVersion": 1.1,
        "position": [
          16768,
          22080
        ],
        "webhookId": "95045bc0-7635-45e7-9cbb-5e96b93b32af"
      },
      {
        "parameters": {
          "jsCode": "// INPUT MERGER V8 - Unifie Webhook et Chat Trigger\nconst inputItem = $input.first().json;\nconst startTime = Date.now();\n\nlet source = 'unknown';\nlet body = {};\nlet rawQuery = '';\n\nif (inputItem.headers !== undefined && inputItem.body !== undefined) {\n  source = 'webhook';\n  body = inputItem.body || {};\n  rawQuery = body.query || '';\n} else if (inputItem.chatInput !== undefined || inputItem.sessionId !== undefined) {\n  source = 'chat';\n  rawQuery = inputItem.chatInput || inputItem.message || '';\n  body = {\n    query: rawQuery,\n    conversation_id: inputItem.sessionId || 'chat-' + Date.now(),\n    tenant_id: 'chat-user',\n    user_groups: ['chat-user'],\n    roles: ['viewer']\n  };\n} else if (inputItem.query) {\n  source = 'direct';\n  body = inputItem;\n  rawQuery = inputItem.query;\n} else {\n  throw new Error('INPUT_ERROR: No valid input detected');\n}\n\nif (!rawQuery || rawQuery.trim().length === 0) {\n  throw new Error('VALIDATION_ERROR: query is required');\n}\n\nreturn [{\n  json: {\n    source: source,\n    body: body,\n    query: rawQuery.trim(),\n    session_id: body.conversation_id || inputItem.sessionId,\n    is_chat: source === 'chat',\n    is_webhook: source === 'webhook' || source === 'direct',\n    _perf: { start_time: startTime }\n  }\n}];"
        },
        "id": "935fb493-3928-400b-b87a-53a312b97015",
        "name": "Input Merger V8",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          16960,
          22192
        ]
      },
      {
        "parameters": {
          "jsCode": "// INIT V8 - Security Gate + Pre-Classification + CoT Prep + Query Hash\nconst body = $node[\"Input Merger V8\"].json.body || {};\nconst inputMerger = $node[\"Input Merger V8\"].json;\nconst startTime = Date.now();\n\n// Crypto pour hash\nconst crypto = require('crypto');\n\n// Extraction query\nlet rawQuery = body.query || inputMerger.query || '';\nconst query = rawQuery.trim();\n\n// G√©n√©rer query_hash pour cache\nconst queryHash = crypto.createHash('sha256')\n  .update(query.toLowerCase().trim())\n  .digest('hex').substring(0, 16);\n\n// Trace ID\nconst traceId = body.conversation_id || inputMerger.conversation_id || \n  `trace-${Date.now()}-${Math.random().toString(36).substring(7)}`;\n\n// Security checks\nconst isSuspicious = /(<script|javascript:|onerror=|eval\\()/i.test(query);\nconst isEmpty = query.length < 2;\n\nreturn {\n  trace_id: traceId,\n  query: query,\n  query_hash: queryHash,\n  conversation_id: body.conversation_id || traceId,\n  session_id: body.session_id || body.conversation_id || traceId,\n  tenant_id: body.tenant_id || 'default',\n  user_groups: body.user_groups || ['default'],\n  metadata: body.metadata || {},\n  is_suspicious: isSuspicious,\n  is_empty: isEmpty,\n  timestamp: startTime,\n  source: inputMerger.source || 'unknown'\n};\n"
        },
        "id": "3e534116-e58f-4aff-802c-66b4c5db2b2e",
        "name": "Init V8 Security & Analysis",
        "type": "n8n-nodes-base.code",
        "position": [
          17152,
          22192
        ],
        "typeVersion": 2
      },
      {
        "parameters": {
          "operation": "get",
          "key": "={{ 'conv:' + $node['Init V8 Security & Analysis'].json.conversation_id }}",
          "options": {}
        },
        "id": "a9f97e14-db82-4bd7-b0db-51b6eca8f667",
        "name": "Redis: Fetch Conversation",
        "type": "n8n-nodes-base.redis",
        "position": [
          17296,
          22384
        ],
        "typeVersion": 1,
        "credentials": {
          "redis": {
            "id": "O2KEPiv7VzgDG5ZX",
            "name": "Redis Upstash"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "SELECT \n  COALESCE(entities_json, '{}'::jsonb) as entities_json,\n  COALESCE(last_intent, 'UNKNOWN') as last_intent,\n  COALESCE(updated_at, NOW()) as updated_at\nFROM conversation_context \nWHERE conversation_id = $1 AND tenant_id = $2\nLIMIT 1",
          "options": {
            "queryReplacement": "=={{ [$json.conversation_id, $json.user_context.tenant_id] }}"
          }
        },
        "id": "da7327db-154d-4cea-9020-96650b124966",
        "name": "Postgres L2/L3 Memory",
        "type": "n8n-nodes-base.postgres",
        "position": [
          17344,
          21904
        ],
        "typeVersion": 2.4,
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "LnTqRX4LZlI009Ks-3Jnp",
            "mode": "id"
          },
          "workflowInputs": {
            "value": {
              "query": "={{ $node['‚öôÔ∏è Execution Engine V10'].json.current_task?.query || $node['‚öôÔ∏è Execution Engine V10'].json.task_query || $node['Init V8 Security & Analysis'].json.query }}",
              "trace_id": "={{ $node['Init V8 Security & Analysis'].json.trace_id }}",
              "user_context": "={{ JSON.stringify({ tenant_id: $node['Init V8 Security & Analysis'].json.tenant_id || 'default', groups: $node['Init V8 Security & Analysis'].json.user_groups || ['default'] }) }}",
              "topK": 20
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "query",
                "displayName": "query",
                "type": "string"
              },
              {
                "id": "trace_id",
                "displayName": "trace_id",
                "type": "string"
              },
              {
                "id": "user_context",
                "displayName": "user_context",
                "type": "string"
              },
              {
                "id": "topK",
                "displayName": "topK",
                "type": "number"
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true,
            "mappingMode": "defineBelow"
          },
          "options": {
            "waitForSubWorkflow": true
          }
        },
        "id": "72c191ac-677e-4f9c-a64f-1cc328680e31",
        "name": "Invoke WF5: Standard",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          21840,
          22224
        ],
        "typeVersion": 1.2,
        "alwaysOutputData": false,
        "continueOnFail": true,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "95x2BBAbJlLWZtWEJn6rb",
            "mode": "id",
            "cachedResultUrl": "/workflow/95x2BBAbJlLWZtWEJn6rb"
          },
          "workflowInputs": {
            "value": {
              "query": "={{ $node['‚öôÔ∏è Execution Engine V10'].json.current_task?.query || $node['‚öôÔ∏è Execution Engine V10'].json.task_query || $node['Init V8 Security & Analysis'].json.query }}",
              "trace_id": "={{ $node['Init V8 Security & Analysis'].json.trace_id }}",
              "user_context": "={{ JSON.stringify({ tenant_id: $node['Init V8 Security & Analysis'].json.tenant_id || 'default', groups: $node['Init V8 Security & Analysis'].json.user_groups || ['default'] }) }}",
              "topK": 20
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "query",
                "displayName": "query",
                "type": "string"
              },
              {
                "id": "trace_id",
                "displayName": "trace_id",
                "type": "string"
              },
              {
                "id": "user_context",
                "displayName": "user_context",
                "type": "string"
              },
              {
                "id": "topK",
                "displayName": "topK",
                "type": "number"
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true,
            "mappingMode": "defineBelow"
          },
          "options": {
            "waitForSubWorkflow": true
          }
        },
        "id": "e3d043ea-96ab-4413-a1a5-683b090596a4",
        "name": "Invoke WF2: Graph",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          21840,
          22656
        ],
        "typeVersion": 1.2,
        "alwaysOutputData": true,
        "continueOnFail": true,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "E19NZG9WfM7FNsxr",
            "mode": "id"
          },
          "workflowInputs": {
            "value": {
              "query": "={{ $node['‚öôÔ∏è Execution Engine V10'].json.current_task?.query || $node['‚öôÔ∏è Execution Engine V10'].json.task_query || $node['Init V8 Security & Analysis'].json.query }}",
              "trace_id": "={{ $node['Init V8 Security & Analysis'].json.trace_id }}",
              "user_context": "={{ JSON.stringify({ tenant_id: $node['Init V8 Security & Analysis'].json.tenant_id || 'default', groups: $node['Init V8 Security & Analysis'].json.user_groups || ['default'] }) }}",
              "topK": 20
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "query",
                "displayName": "query",
                "type": "string"
              },
              {
                "id": "trace_id",
                "displayName": "trace_id",
                "type": "string"
              },
              {
                "id": "user_context",
                "displayName": "user_context",
                "type": "string"
              },
              {
                "id": "topK",
                "displayName": "topK",
                "type": "number"
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true,
            "mappingMode": "defineBelow"
          },
          "options": {
            "waitForSubWorkflow": true
          }
        },
        "id": "8d682938-416e-4a7c-915e-b9a02cca209a",
        "name": "Invoke WF4: Quantitative",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          21856,
          22416
        ],
        "typeVersion": 1.2,
        "alwaysOutputData": true,
        "continueOnFail": true,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "jsCode": "// Safe accessor for sub-workflow results\nfunction safe_access(nodeRef, defaultVal) {\n  try { return nodeRef || defaultVal; }\n  catch(e) { return defaultVal; }\n}\n\n\n// ITER2 FIX: Better response extraction from diverse sub-workflow outputs\nfunction extractResponseText(result) {\n  if (!result) return '';\n  const j = result.json || result;\n  // Try multiple response field names used by different sub-workflows\n  return j.final_response || j.response || j.interpretation ||\n         j.answer || j.chat_message || j.result || '';\n}\n// ============================================\n// PATCH - Response Builder V9.6\n// FIX: Lit correctement les donn√©es depuis Execution Engine\n// ============================================\n//\n// PROBL√àME: Response Builder ne recevait pas les donn√©es car il lisait\n// depuis des nodes qui n'√©taient pas dans son flux direct.\n//\n// SOLUTION: Lire depuis $json qui vient directement de l'IF node\n// qui lui-m√™me vient de Execution Engine.\n// ============================================\n\nconst inputData = $json;\nconst traceId = inputData.trace_id || $node['Init V8 Security & Analysis']?.json?.trace_id || 'unknown';\nconst isChat = inputData.is_chat || $node['Input Merger V8']?.json?.is_chat || false;\nconst originalQuery = inputData.original_query || $node['Init V8 Security & Analysis']?.json?.query || '';\n\nconsole.log(`[${traceId}] Response Builder V9.6 starting...`);\nconsole.log(`[${traceId}] Input keys: ${Object.keys(inputData).join(', ')}`);\n\n// === 1. R√âCUP√âRER LES R√âSULTATS ===\n// Priorit√© 1: Donn√©es directes depuis Execution Engine (via IF node)\nlet completedTasks = inputData.completed_tasks || [];\nlet allResponses = inputData.all_responses || [];\nlet finalResponse = inputData.final_response || '';\nlet confidence = inputData.confidence || 0;\n\nconsole.log(`[${traceId}] From input: ${completedTasks.length} completed, ${allResponses.length} responses`);\nconsole.log(`[${traceId}] Pre-computed final_response: ${finalResponse.length} chars`);\n\n// === 2. SI PAS DE R√âPONSE PR√â-CALCUL√âE, CONSTRUIRE ===\nif (!finalResponse || finalResponse.length < 10) {\n    console.log(`[${traceId}] Building response from completed_tasks...`);\n    \n    if (allResponses.length > 0) {\n        // Trier par confidence\n        const sorted = allResponses.sort((a, b) => (b.confidence || 0) - (a.confidence || 0));\n        \n        if (sorted.length === 1) {\n            finalResponse = sorted[0].response;\n            confidence = sorted[0].confidence || 0.5;\n        } else {\n            // Combiner les r√©ponses de diff√©rents RAGs\n            const usedRags = new Set(sorted.map(r => r.rag));\n            \n            if (usedRags.size > 1) {\n                // R√©ponses de diff√©rents RAGs\n                finalResponse = sorted.map(r => {\n                    const icon = r.rag === 'STANDARD' ? 'üìö' : r.rag === 'GRAPH' ? 'üîó' : 'üìä';\n                    return `${icon} **${r.rag}:**\\n${r.response}`;\n                }).join('\\n\\n---\\n\\n');\n                \n                confidence = sorted.reduce((sum, r) => sum + (r.confidence || 0), 0) / sorted.length;\n            } else {\n                // M√™me RAG - prendre la meilleure\n                finalResponse = sorted[0].response;\n                confidence = sorted[0].confidence || 0.5;\n            }\n        }\n        \n        console.log(`[${traceId}] Built response: ${finalResponse.length} chars`);\n    }\n}\n\n// === 3. FALLBACK SI TOUJOURS VIDE ===\nif (!finalResponse || finalResponse.length < 10) {\n    // Essayer de lire depuis completed_tasks directement\n    if (completedTasks.length > 0) {\n        const tasksWithResponse = completedTasks.filter(t => t.response && t.response.length > 10);\n        if (tasksWithResponse.length > 0) {\n            // Prendre la meilleure\n            const best = tasksWithResponse.sort((a, b) => (b.confidence || 0) - (a.confidence || 0))[0];\n            finalResponse = best.response;\n            confidence = best.confidence || 0.5;\n            console.log(`[${traceId}] Fallback: used completed_tasks response`);\n        }\n    }\n}\n\n// === 4. DERNIER FALLBACK ===\nif (!finalResponse || finalResponse.length < 10) {\n    finalResponse = \"Je n'ai pas pu trouver d'information pertinente pour r√©pondre √† votre question. Pourriez-vous reformuler ?\";\n    confidence = 0.1;\n    console.log(`[${traceId}] Using default fallback message`);\n}\n\n// === 5. AJOUTER LES SOURCES ===\nlet sources = [];\ncompletedTasks.forEach(t => {\n    if (t.sources && Array.isArray(t.sources)) {\n        sources.push(...t.sources);\n    }\n});\n\n// D√©dupliquer\nconst uniqueSources = [];\nconst seenIds = new Set();\nfor (const s of sources) {\n    const id = s.id || s.source || JSON.stringify(s);\n    if (!seenIds.has(id)) {\n        seenIds.add(id);\n        uniqueSources.push(s);\n    }\n}\n\n// Formater avec sources\nlet formattedResponse = finalResponse;\nif (uniqueSources.length > 0) {\n    formattedResponse += '\\n\\n---\\n**Sources:**\\n';\n    formattedResponse += uniqueSources.slice(0, 5).map((s, i) => {\n        const name = s.source || s.id || 'Document';\n        const score = s.score ? ` (${(s.score * 100).toFixed(0)}%)` : '';\n        return `[${i + 1}] ${name}${score}`;\n    }).join('\\n');\n}\n\n// Note si confiance faible\nif (confidence < 0.4) {\n    formattedResponse += '\\n\\n*‚ö†Ô∏è Confiance mod√©r√©e - v√©rifiez les informations.*';\n}\n\nconsole.log(`[${traceId}] Final response: ${formattedResponse.length} chars, confidence: ${confidence.toFixed(2)}`);\n\n// === 6. OUTPUT ===\nreturn {\n    final_response: formattedResponse,\n    chat_message: formattedResponse,  // Pour Chat: Final V8\n    confidence: confidence,\n    sources: uniqueSources.slice(0, 10),\n    sources_count: uniqueSources.length,\n    trace_id: traceId,\n    is_chat: isChat,\n    original_query: originalQuery,\n    \n    // Stats\n    tasks_completed: completedTasks.length,\n    responses_merged: allResponses.length,\n    \n    // Debug\n    _debug: {\n        input_had_final_response: !!inputData.final_response,\n        input_completed_count: inputData.completed_tasks?.length || 0,\n        input_responses_count: inputData.all_responses?.length || 0\n    }\n};\n"
        },
        "id": "161210a8-05be-4341-b5ac-b58a79026c32",
        "name": "Response Builder V9",
        "type": "n8n-nodes-base.code",
        "position": [
          24144,
          22112
        ],
        "typeVersion": 2,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "INSERT INTO rlhf_training_data (conversation_id, query, response, feedback_score, feedback_type, reasoning_path, is_good_example, is_bad_example, needs_review) \nVALUES ($1, $2, $3, $4, 'implicit', $5, $6, $7, $8) \nON CONFLICT DO NOTHING",
          "options": {
            "queryReplacement": "={{ [\n  $('Init V8 Security & Analysis').item.json.conversation_id,\n  $('Init V8 Security & Analysis').item.json.query,\n  $('Response Builder V9').item.json.final_response,\n  $('Response Builder V9').item.json.confidence || 0.5,\n  JSON.stringify($('Response Builder V9').item.json.reasoning_path || {}),\n  ($('Response Builder V9').item.json.confidence || 0.5) > 0.7,\n  ($('Response Builder V9').item.json.confidence || 0.5) < 0.3,\n  true\n] }}"
          }
        },
        "id": "9b24efe5-41c2-42ea-889a-b704ece3b592",
        "name": "Store RLHF Data V8",
        "type": "n8n-nodes-base.postgres",
        "position": [
          24400,
          22512
        ],
        "typeVersion": 2.4,
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "operation": "set",
          "key": "={{ 'conv:' + $node['Init V8 Security & Analysis'].json.conversation_id }}",
          "value": "={{ JSON.stringify({ history: [...(($node['üì¶ Context Compression V10.1'].json?.compressed_history) || []), { query: $node['Init V8 Security & Analysis'].json.query, response: $node['Response Builder V9'].json.final_response, timestamp: new Date().toISOString() }].slice(-10), cache: { [$node['Init V8 Security & Analysis'].json.query_hash]: { response: $node['Response Builder V9'].json.final_response, timestamp: new Date().toISOString() } } }) }}"
        },
        "id": "d5455c64-0042-471f-88f1-d8a64c8d26ff",
        "name": "Redis: Store Conv V8",
        "type": "n8n-nodes-base.redis",
        "position": [
          24384,
          21984
        ],
        "typeVersion": 1,
        "credentials": {
          "redis": {
            "id": "O2KEPiv7VzgDG5ZX",
            "name": "Redis Upstash"
          }
        }
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "INSERT INTO conversation_context (conversation_id, tenant_id, entities_json, last_intent, updated_at) VALUES ($1, $2, $3, $4, NOW()) ON CONFLICT (conversation_id, tenant_id) DO UPDATE SET entities_json = $3, last_intent = $4, updated_at = NOW()",
          "options": {
            "queryReplacement": "={{ [\n  $('Init V8 Security & Analysis').first().json.conversation_id,\n  $('Init V8 Security & Analysis').first().json.tenant_id || 'default',\n  JSON.stringify($('üì¶ Context Compression V10.1').first().json.entities_of_interest || {}),\n  $('üîç Query Classifier V10.1').first().json.query_route || 'UNKNOWN'\n] }}"
          }
        },
        "id": "8fe8eadb-9f5d-421c-bbb5-798d1966e937",
        "name": "Postgres: Update Context V8",
        "type": "n8n-nodes-base.postgres",
        "position": [
          24384,
          22240
        ],
        "typeVersion": 2.4,
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "loose",
              "version": 1
            },
            "conditions": [
              {
                "id": "is-chat-final",
                "leftValue": "={{ $('Response Builder V9').item.json.is_chat }}",
                "rightValue": true,
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {
            "looseTypeValidation": true
          }
        },
        "id": "fcc058cf-79a3-4c2c-a27a-e57e4b7d0c5b",
        "name": "Output Router (Final)",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          25088,
          22192
        ]
      },
      {
        "parameters": {
          "respondWith": "text",
          "responseBody": "={{ $('Response Builder V9').item.json.chat_message }}",
          "options": {}
        },
        "id": "55f180e4-5489-47b0-97fe-de50a127cc48",
        "name": "Chat: Final V8",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          25264,
          22048
        ]
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"success\": true,\n  \"response\": {{ $('Response Builder V9').item.json.final_response ? JSON.stringify($('Response Builder V9').item.json.final_response) : '\"\"' }},\n  \"confidence\": {{ $('Response Builder V9').item.json.confidence || 0 }},\n  \"trace_id\": {{ $('Response Builder V9').item.json.trace_id ? JSON.stringify($('Response Builder V9').item.json.trace_id) : '\"\"' }},\n  \"version\": \"V8.0-CoT\",\n  \"perf\": {{ $('Response Builder V9').item.json.perf ? JSON.stringify($('Response Builder V9').item.json.perf) : '{}' }},\n  \"reasoning_path\": {{ $('Response Builder V9').item.json.reasoning_path ? JSON.stringify($('Response Builder V9').item.json.reasoning_path) : '{}' }}\n}",
          "options": {}
        },
        "id": "906694a2-098b-480b-9705-8c9f6fa397f3",
        "name": "Return Response V8",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          25264,
          22256
        ],
        "typeVersion": 1.1
      },
      {
        "parameters": {},
        "id": "3b1040f3-8d0e-4a98-9bf1-6a54193a3aa9",
        "name": "Error Handler V8",
        "type": "n8n-nodes-base.errorTrigger",
        "position": [
          16528,
          22544
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "jsCode": "// Error Payload Builder V8\nconst error = $json.error || { message: 'Unknown error' };\nlet traceId = 'unknown';\ntry { traceId = $node['Init V8 Security & Analysis'].json?.trace_id; } catch(e) {}\n\nreturn {\n  event_id: `err-${Date.now()}`,\n  trace_id: traceId,\n  timestamp: new Date().toISOString(),\n  level: 'error',\n  message: error.message,\n  stack: error.stack?.substring(0, 1000),\n  context: {\n    workflow: $workflow.name,\n    node: $prevNode?.name,\n    execution_id: $execution.id\n  },\n  user_input: '[REDACTED]',\n  version: 'V8.0-CoT'\n};"
        },
        "id": "3a540e97-79d1-4d12-ac5b-ca731b3374b8",
        "name": "Error Payload V8",
        "type": "n8n-nodes-base.code",
        "position": [
          16704,
          22544
        ],
        "typeVersion": 2
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $vars.SENTRY_DSN || 'https://sentry.io/api/ingest' }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ $json }}",
          "options": {
            "timeout": 5000
          }
        },
        "id": "f7a8b350-4099-442a-b35e-fa2e64e74c32",
        "name": "Export Error V8",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          16896,
          22544
        ],
        "typeVersion": 4.3,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"success\": false,\n  \"response\": \"An error occurred while processing your request. Please try again.\",\n  \"error\": {{ JSON.stringify($json.message || 'Internal workflow error') }},\n  \"trace_id\": {{ JSON.stringify($json.trace_id || '') }},\n  \"version\": \"V8.0-CoT\"\n}",
          "options": {
            "responseCode": 200
          }
        },
        "id": "err-respond-v8-001",
        "name": "Return: Error Response",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          17088,
          22544
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1/chat/completions' }}",
          "authentication": "none",
          "nodeCredentialType": "openRouterApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"{{ $vars.LLM_INTENT_MODEL || 'meta-llama/llama-3.3-70b-instruct:free' }}\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are the INTENT ANALYZER of a sophisticated multi-engine RAG system.\\n\\n=== YOUR MISSION ===\\n1. Analyze the user query\\n2. Identify ALL intents (explicit AND implicit)\\n3. Determine DEPENDENCIES between intents\\n4. Assign the optimal RAG engine for each intent\\n\\n=== AVAILABLE RAG ENGINES ===\\n\\n**STANDARD (Pinecone + BM25)**\\n- Hybrid document retrieval (dense + sparse)\\n- topK=20, Cohere reranking\\n- Latency: ~3s\\n- Strengths: facts, procedures, definitions, technical documentation\\n- Weaknesses: poor for precise numbers, complex relationships\\n\\n**GRAPH (Neo4j)**\\n- Multi-hop traversal (4 levels max)\\n- Community detection, intelligent pruning\\n- Latency: ~5s\\n- Strengths: relationships, hierarchies, impacts, multi-hop reasoning, bridging facts across entities\\n- Weaknesses: no quantitative data, slow for simple queries\\n- USE FOR ANY question that requires CHAINING 2+ facts across different entities or documents:\\n  * 'Who voices the character named after X?' (chain: X -> character -> voice actor)\\n  * 'In what year did the founder of X die?' (chain: X -> founder -> death year)\\n  * 'What country is the birthplace of the director of film Y located in?' (chain: Y -> director -> birthplace -> country)\\n  * 'Which film has the director who died first?' (chain: film -> director -> death date, compare)\\n  * Any question mentioning a person/place/org indirectly through another entity\\n- CRITICAL: If answering requires looking up entity A to find entity B, then looking up entity B to find the answer, this is GRAPH, NOT STANDARD\\n- When in doubt between STANDARD and GRAPH, prefer GRAPH for questions about people, places, organizations, or historical facts that involve indirect references\\n\\n**QUANTITATIVE (PostgreSQL)**\\n- Automatic SQL generation with self-healing\\n- Access to tables: sales, employees, products, kpis\\n- Latency: ~4s\\n- Strengths: numbers, totals, averages, comparisons, KPIs, trends\\n- Weaknesses: no narrative text, requires structured data\\n\\n=== PRIORITIZATION RULES ===\\n1. Numbers/totals/averages/KPIs -> QUANTITATIVE\\n2. Simple factual lookups (single entity, direct answer) -> STANDARD\\n3. Multi-hop chains (answer requires 2+ fact lookups) -> GRAPH\\n4. If the question refers to an entity INDIRECTLY (e.g. 'the founder of X', 'the director of Y', 'the birthplace of Z') -> GRAPH\\n5. Comparisons between entities (which is older, who died first) -> GRAPH\\n6. Questions about people, places, orgs connected through events/works -> GRAPH\\n7. If two intents are INDEPENDENT, mark 'can_parallelize': true\\n8. When unsure between STANDARD and GRAPH, choose GRAPH\\n\\n=== STRICT JSON FORMAT ===\\nRespond ONLY with this JSON, no text before/after:\\n{\\n  \\\"reasoning\\\": \\\"<your step-by-step analysis in 2-3 sentences>\\\",\\n  \\\"intents\\\": [\\n    {\\n      \\\"id\\\": \\\"intent-1\\\",\\n      \\\"description\\\": \\\"<what the user wants to know>\\\",\\n      \\\"type\\\": \\\"FACTUAL|QUANTITATIVE|RELATIONAL|PROCEDURAL|COMPARATIVE\\\",\\n      \\\"suggested_rag\\\": \\\"STANDARD|GRAPH|QUANTITATIVE\\\",\\n      \\\"priority\\\": 1,\\n      \\\"depends_on\\\": [],\\n      \\\"can_parallelize_with\\\": [\\\"intent-X\\\"]\\n    }\\n  ],\\n  \\\"execution_order\\\": [\\\"intent-1\\\"],\\n  \\\"has_parallel_intents\\\": false,\\n  \\\"complexity\\\": \\\"SIMPLE|MODERATE|COMPLEX\\\"\\n}\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"=== QUERY TO ANALYZE ===\\n{{ $node['Init V8 Security & Analysis'].json.query }}\"\n    }\n  ],\n  \"temperature\": 0.1,\n  \"max_tokens\": 800\n}",
          "options": {
            "timeout": 8000,
            "retry": {
              "maxTries": 1,
              "waitBetweenTries": 1000
            }
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
              }
            ]
          }
        },
        "id": "5a69dda9-8989-4837-87f4-69f6ea39e462",
        "name": "üß† LLM 1: Intent Analyzer",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          19840,
          22304
        ],
        "credentials": {},
        "continueOnFail": true,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "jsCode": "// Intent Parser V9.1 - Parse LLM 1 output avec support parall√©lisation\nconst llmResponse = $json;\nconst initData = $node['Init V8 Security & Analysis'].json;\nconst guardrailData = $node['üõ°Ô∏è Advanced Guardrails'].json;\n\nlet intentsData;\ntry {\n  const content = llmResponse.body?.choices?.[0]?.message?.content \n               || llmResponse.choices?.[0]?.message?.content || '{}';\n  intentsData = JSON.parse(content);\n} catch (e) {\n  // Fallback: single intent based on router\n  intentsData = {\n    reasoning: 'Fallback due to parsing error: ' + e.message,\n    intents: [{\n      id: 'intent-1',\n      description: initData.query,\n      type: 'FACTUAL',\n      suggested_rag: guardrailData.engine || 'STANDARD',\n      priority: 1,\n      depends_on: [],\n      can_parallelize_with: []\n    }],\n    execution_order: ['intent-1'],\n    has_parallel_intents: false,\n    complexity: 'SIMPLE'\n  };\n}\n\n// Validate intents\nconst validRags = ['STANDARD', 'GRAPH', 'QUANTITATIVE'];\nintentsData.intents = (intentsData.intents || []).map((intent, idx) => ({\n  ...intent,\n  id: intent.id || `intent-${idx + 1}`,\n  suggested_rag: validRags.includes(intent.suggested_rag) ? intent.suggested_rag : 'STANDARD',\n  priority: intent.priority || idx + 1,\n  depends_on: Array.isArray(intent.depends_on) ? intent.depends_on : [],\n  can_parallelize_with: Array.isArray(intent.can_parallelize_with) ? intent.can_parallelize_with : []\n}));\n\n// Determine if parallel execution is possible\nconst hasParallel = intentsData.has_parallel_intents || \n  intentsData.intents.some(i => i.can_parallelize_with?.length > 0);\n\n// Output format for LLM 2\nreturn {\n  trace_id: initData.trace_id,\n  original_query: initData.query,\n  user_context: initData.user_context,\n  \n  // Intent analysis\n  intents: intentsData.intents,\n  execution_order: intentsData.execution_order || intentsData.intents.map(i => i.id),\n  reasoning: intentsData.reasoning,\n  complexity: intentsData.complexity || 'MODERATE',\n  \n  // Parallelization info\n  has_parallel_intents: hasParallel,\n  \n  // Pass through\n  is_chat: $node['Input Merger V8'].json.is_chat,\n  is_webhook: $node['Input Merger V8'].json.is_webhook,\n  conversation_id: initData.conversation_id\n};"
        },
        "id": "bdea704a-e190-4948-b5df-8452da164e03",
        "name": "Intent Parser V9",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          20032,
          22304
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1/chat/completions' }}",
          "authentication": "none",
          "nodeCredentialType": "openRouterApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"{{ $vars.LLM_PLANNER_MODEL || 'meta-llama/llama-3.3-70b-instruct:free' }}\",\n  \"temperature\": 0.2,\n  \"max_tokens\": 500,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": {{ JSON.stringify(`You are the TASK PLANNER of a multi-engine RAG system. You receive analyzed intents and must create an optimal execution plan.\n\n=== DETAILED RAG ENGINE CAPABILITIES ===\n\n**STANDARD (RAG Multi-Index V3.4)**\n- Technology: Pinecone (1536 dims) + BM25 sparse\n- Retrieval: HyDE (hypothetical document), optional Query Decomposition\n- Reranking: Cohere rerank-multilingual-v3\n- topK: 20 chunks, ~500 tokens/chunk\n- Latency: 2-4 seconds\n- OPTIMAL FOR: Factual questions, procedures, definitions, technical documentation\n- AVOID FOR: precise numbers, hierarchical relationships\n\n**GRAPH (Neo4j Graph RAG V3.3)**\n- Technology: Neo4j + 4-hop traversal\n- Capabilities: community detection, path finding, pruning\n- Entities: Person, Team, Project, Document, Skill\n- Relations: WORKS_IN, MANAGES, REPORTS_TO, CONTRIBUTES_TO\n- Latency: 3-6 seconds\n- OPTIMAL FOR: Relationships, hierarchies, impacts, org charts, multi-hop reasoning, entity traversal, comparison between entities\n- AVOID FOR: numbers, long narrative text\n\n**QUANTITATIVE (SQL RAG V2.0)**\n- Technology: PostgreSQL + Text-to-SQL (CoT)\n- Self-healing: automatic SQL correction\n- Tables: sales, employees, products, kpis\n- Latency: 2-5 seconds\n- OPTIMAL FOR: Totals, averages, comparisons, KPIs, trends\n- AVOID FOR: text, non-numeric relationships\n\n=== PLANNING RULES ===\n1. PARALLELIZATION: If two tasks have NO dependency, same parallel_group (max 3)\n2. DEPENDENCIES: A task needing another's result -> depends_on\n3. SKIP CONDITIONS: If one answer can cover multiple intents -> if_success_covers\n4. FALLBACKS: Always provide a fallback_rag DIFFERENT from target_rag\n\n=== RECEIVED INTENTS ===\n${JSON.stringify($json.intents, null, 2)}\n\n=== SUGGESTED ORDER ===\n${$json.execution_order.join(' -> ')}\n\n=== PARALLELIZABLE INTENTS ===\n${$json.has_parallel_intents ? 'YES' : 'NO'}\n\n=== ORIGINAL QUERY ===\n${$json.original_query}\n\n=== STRICT JSON FORMAT ===\nRespond ONLY with this JSON:\n{\n  \"plan_id\": \"plan-<timestamp>\",\n  \"reasoning\": \"<your reasoning in 2-3 sentences>\",\n  \"execution_mode\": \"SEQUENTIAL|PARALLEL|MIXED\",\n  \"parallel_groups\": [{\"group_id\": 1, \"task_ids\": [1, 2], \"reason\": \"...\"}],\n  \"tasks\": [\n    {\n      \"task_id\": 1,\n      \"intent_id\": \"intent-1\",\n      \"query\": \"<query OPTIMIZED for this RAG>\",\n      \"target_rag\": \"STANDARD|GRAPH|QUANTITATIVE\",\n      \"fallback_rag\": \"STANDARD|GRAPH|QUANTITATIVE\",\n      \"parallel_group\": null,\n      \"depends_on_task\": null,\n      \"success_criteria\": {\"min_confidence\": 0.6, \"min_sources\": 1},\n      \"if_success_covers\": []\n    }\n  ],\n  \"total_tasks\": 1,\n  \"estimated_latency_ms\": 3000\n}`) }}\n    }\n  ]\n}",
          "options": {
            "timeout": 10000,
            "retry": {
              "maxTries": 1,
              "waitBetweenTries": 1000
            }
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
              }
            ]
          }
        },
        "id": "a2123ca5-27d8-41d5-85c1-a8c6dd96c1d2",
        "name": "üéØ LLM 2: Task Planner",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          20256,
          22304
        ],
        "credentials": {},
        "continueOnFail": true,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "content": "# üîß CONFIGURATION SOTA 2026\n## Variables d'environnement requises\n\n### APIs (cl√©s requises)\n- `DEEPSEEK_API_KEY` - api.deepseek.com\n- `ANTHROPIC_API_KEY` - planning complexe\n- `GOOGLE_API_KEY` - Gemini Flash (optionnel)\n\n### Mod√®les LLM (optionnel, d√©fauts inclus)\n- `SQL_MODEL` = deepseek-chat (BIRD-SQL 72.3%)\n- `INTENT_MODEL` = deepseek-chat\n- `PLANNING_MODEL` = claude-sonnet-4-5\n- `GENERATION_MODEL` = deepseek-chat\n- `ROUTER_MODEL` = gemini-2.0-flash\n\n### Embedding (FORTEMENT RECOMMAND√â)\n- `EMBEDDING_API_URL` ‚Üí self-hosted Qwen3\n- `EMBEDDING_MODEL` = Qwen3-Embedding-8B\n- Impact: +15 pts MTEB vs text-embedding-3-small\n\n### Reranking (FORTEMENT RECOMMAND√â)\n- `RERANKER_API_URL` ‚Üí self-hosted Qwen3\n- `RERANKER_MODEL` = Qwen3-Reranker-8B\n- Impact: +2 pts BEIR, $0 vs $2/1k\n\n### Impact √©conomique estim√©:\n- Ingestion: -89% co√ªt\n- Requ√™tes: -95% co√ªt\n- Qualit√© SQL: +3%\n- Qualit√© retrieval: +15%",
          "height": 804,
          "width": 188
        },
        "id": "dae9fb50-b9e9-44c8-9f01-82fe249bb3ed",
        "name": "üìã Config SOTA 2026",
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          16320,
          21360
        ]
      },
      {
        "parameters": {
          "jsCode": "// === RATE LIMIT GUARD - Post Redis Cache ===\nconst redisData = $json;\nconst initData = $node['Init V8 Security & Analysis'].json;\nconst conversationHistory = redisData.conversation_history || [];\nconst now = Date.now();\nconst traceId = initData.trace_id;\n\n// Analyser les timestamps des messages r√©cents\nconst recentWindow = 60000; // 1 minute\nconst recentMessages = conversationHistory.filter(msg => \n  msg.timestamp && (now - msg.timestamp) < recentWindow\n);\n\n// Rate limit: max 10 messages par minute\nconst MAX_REQUESTS_PER_MINUTE = 10;\nconst isRateLimited = recentMessages.length >= MAX_REQUESTS_PER_MINUTE;\n\n// Pattern abuse detection: plus de 5 messages en 10 secondes\nconst veryRecentMessages = conversationHistory.filter(msg =>\n  msg.timestamp && (now - msg.timestamp) < 10000\n);\nconst isAbuse = veryRecentMessages.length > 5;\n\nif (isRateLimited || isAbuse) {\n  console.log(`[${traceId}] RATE LIMITED: ${recentMessages.length} req/min, ${veryRecentMessages.length} req/10s`);\n  \n  return {\n    rate_limited: true,\n    blocked_until: now + recentWindow,\n    message: \"Rate limit exceeded. Please slow down your requests.\",\n    recent_count: recentMessages.length,\n    abuse_detected: isAbuse,\n    trace_id: traceId\n  };\n}\n\n// Pas de rate limit - passer les donn√©es\nreturn {\n  rate_limited: false,\n  ...redisData,\n  trace_id: traceId\n};\n"
        },
        "id": "f5371300-cc52-4f1b-aad6-f95d8d67eaf3",
        "name": "üõ°Ô∏è Rate Limit Guard",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          17520,
          22384
        ]
      },
      {
        "parameters": {
          "conditions": {
            "boolean": [
              {
                "value1": "={{ $json.rate_limited }}",
                "value2": true
              }
            ]
          },
          "options": {}
        },
        "id": "479a0220-29c2-42a9-8374-ccf4ca47c4aa",
        "name": "IF: Rate Limited?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          17696,
          22384
        ]
      },
      {
        "parameters": {
          "respondWith": "text",
          "responseBody": "={{ $json.message }}",
          "options": {}
        },
        "id": "e84e2158-ce59-4d66-90af-07526b4fb5da",
        "name": "Return: Rate Limited",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          17904,
          22400
        ]
      },
      {
        "parameters": {
          "jsCode": "// === CACHE PARSER - V√©rifie hit/miss ===\nconst redisResult = $json;\nconst initData = $node['Init V8 Security & Analysis'].json;\n\nlet cacheHit = false;\nlet cachedResponse = null;\n\ntry {\n    if (redisResult && redisResult.value) {\n        const cached = JSON.parse(redisResult.value);\n        const cacheAge = Date.now() - (cached.timestamp || 0);\n        \n        // Cache valide si < 1h\n        if (cacheAge < 3600000) {\n            cacheHit = true;\n            cachedResponse = cached.response;\n            console.log(`[${initData.trace_id}] Cache HIT: ${initData.query_hash}`);\n        } else {\n            console.log(`[${initData.trace_id}] Cache expired: ${cacheAge}ms old`);\n        }\n    }\n} catch (e) {\n    console.log(`[${initData.trace_id}] Cache parse error: ${e.message}`);\n}\n\nreturn {\n    cache_hit: cacheHit,\n    cached_response: cachedResponse,\n    query: initData.query,\n    query_hash: initData.query_hash,\n    trace_id: initData.trace_id\n};\n"
        },
        "id": "6afac6d0-4023-43ae-9b7e-76fd1f199862",
        "name": "Cache Parser",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          19072,
          21888
        ]
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "id": "e0d9ad14-ed75-46a4-a1bf-d804801bd1c0",
                "leftValue": "={{ $json.cached_response }}",
                "rightValue": "Null",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              },
              {
                "id": "a61487b3-0cc9-470c-af6b-e4e5b57f1538",
                "leftValue": "",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "id": "cd442267-b982-44c2-af3e-cd85bad12a24",
        "name": "IF: Cache Hit?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          19216,
          21888
        ]
      },
      {
        "parameters": {
          "respondWith": "text",
          "responseBody": "={{ $json.cached_response + '\\n\\n_üöÄ R√©ponse en cache_' }}",
          "options": {}
        },
        "id": "4fbc2f9b-57a0-4004-9305-ae5b50045464",
        "name": "Return: Cached",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          19408,
          21888
        ]
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "CREATE TABLE IF NOT EXISTS rag_task_executions (\n  id SERIAL PRIMARY KEY,\n  trace_id VARCHAR(255) NOT NULL,\n  task_id INTEGER NOT NULL,\n  intent_id VARCHAR(255),\n  status VARCHAR(50) DEFAULT 'pending',\n  rag_called VARCHAR(50),\n  attempt INTEGER DEFAULT 1,\n  query TEXT,\n  response TEXT,\n  error_message TEXT,\n  sources JSONB,\n  confidence FLOAT,\n  created_at TIMESTAMP DEFAULT NOW(),\n  updated_at TIMESTAMP DEFAULT NOW(),\n  UNIQUE(trace_id, task_id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_task_status ON rag_task_executions(trace_id, status);\nCREATE INDEX IF NOT EXISTS idx_task_attempt ON rag_task_executions(trace_id, task_id, attempt);\n",
          "options": {}
        },
        "id": "ea82be59-7036-4626-acfd-11822f852c0f",
        "name": "Postgres: Init Tasks Table",
        "type": "n8n-nodes-base.postgres",
        "typeVersion": 2.5,
        "position": [
          20592,
          22448
        ],
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "continueOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// FORMAT & DISPATCH V10.2 - MULTI-INTENT FIXED\n// ============================================\n\nvar plannerRawOutput = $json;\nvar traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nvar originalQuery = $node['Init V8 Security & Analysis'].json.query;\n\nvar RAG_MAPPING = {\n  'standard': 'STANDARD',\n  'graph': 'GRAPH',\n  'quantitative': 'QUANTITATIVE'\n};\n\nfunction normalizeRAGName(ragName) {\n  if (!ragName) return 'STANDARD';\n  var key = String(ragName).toLowerCase().trim();\n  if (RAG_MAPPING[key]) return RAG_MAPPING[key];\n  return String(ragName).toUpperCase();\n}\n\nvar tasks = [];\nvar plannerData = null;\n\n// === 1. PARSER LA R√âPONSE LLM 2 ===\ntry {\n  var contentString = '';\n  \n  // Support OpenRouter format\n  if (plannerRawOutput.choices && plannerRawOutput.choices[0] && \n      plannerRawOutput.choices[0].message && plannerRawOutput.choices[0].message.content) {\n    contentString = plannerRawOutput.choices[0].message.content;\n  }\n  // Support Anthropic format\n  else if (plannerRawOutput.content && plannerRawOutput.content[0] && \n           plannerRawOutput.content[0].text) {\n    contentString = plannerRawOutput.content[0].text;\n  }\n  \n  // Nettoyer les markdown code blocks\n  contentString = contentString.replace(/```json/g, '').replace(/```/g, '').trim();\n  \n  // Parser le JSON\n  plannerData = JSON.parse(contentString);\n  \n  if (plannerData && plannerData.tasks && Array.isArray(plannerData.tasks)) {\n    tasks = plannerData.tasks;\n    console.log('[' + traceId + '] Parsed ' + tasks.length + ' tasks from LLM 2');\n  }\n  \n} catch (parseError) {\n  console.error('[' + traceId + '] LLM 2 parse error: ' + parseError.message);\n  // Continue vers le fallback\n}\n\n// === 2. FALLBACK : CR√âER UNE T√ÇCHE PAR INTENT ===\nif (tasks.length === 0) {\n  console.log('[' + traceId + '] Fallback: creating tasks from Intent Parser');\n  \n  var intentData = $node['Intent Parser V9'].json;\n  var intents = intentData.intents || [];\n  \n  if (intents.length > 0) {\n    // Cr√©er une t√¢che pour CHAQUE intent\n    for (var i = 0; i < intents.length; i++) {\n      var intent = intents[i];\n      \n      tasks.push({\n        task_id: i + 1,\n        intent_id: intent.id || ('intent-' + (i + 1)),\n        // Utiliser la description de l'intent OU la query optimis√©e\n        query: intent.query || intent.description || originalQuery,\n        target_rag: intent.suggested_rag || 'STANDARD',\n        fallback_rag: 'STANDARD',\n        parallel_group: intent.can_parallelize_with && intent.can_parallelize_with.length > 0 ? 1 : null\n      });\n    }\n    \n    console.log('[' + traceId + '] Created ' + tasks.length + ' tasks from ' + intents.length + ' intents');\n  } else {\n    // Dernier fallback : une seule t√¢che g√©n√©rique\n    tasks = [{\n      task_id: 1,\n      intent_id: 'intent-1',\n      query: originalQuery,\n      target_rag: 'STANDARD',\n      fallback_rag: 'GRAPH'\n    }];\n    \n    console.log('[' + traceId + '] Ultimate fallback: single generic task');\n  }\n}\n\n// === 3. CONSTRUIRE tasksToInsert ===\nvar tasksToInsert = [];\n\nfor (var i = 0; i < tasks.length; i++) {\n  var task = tasks[i];\n  \n  // R√©cup√©rer le RAG cible\n  var targetRag = task.target_rag || task.rag || 'STANDARD';\n  var normalizedRAG = normalizeRAGName(targetRag);\n  \n  // √âchapper les quotes pour PostgreSQL\n  var cleanQuery = String(task.query || originalQuery).replace(/'/g, \"''\");\n  \n  tasksToInsert.push({\n    trace_id: traceId,\n    task_id: task.task_id || (i + 1),\n    intent_id: task.intent_id || ('intent-' + (i + 1)),\n    status: 'pending',\n    rag_called: normalizedRAG,\n    attempt: 1,\n    query: cleanQuery,\n    response: null,\n    error_message: null,\n    sources: null,\n    confidence: task.success_criteria ? task.success_criteria.min_confidence : 0.8\n  });\n}\n\nconsole.log('[' + traceId + '] Final output: ' + tasksToInsert.length + ' tasks ready for DB');\n\n// === 4. OUTPUT ===\nreturn {\n  trace_id: traceId,\n  tasks_to_insert: tasksToInsert,\n  total_tasks: tasksToInsert.length,\n  execution_mode: plannerData ? (plannerData.execution_mode || 'SEQUENTIAL') : 'SEQUENTIAL',\n  parallel_groups: plannerData ? (plannerData.parallel_groups || []) : [],\n  // Debug info\n  _debug: {\n    parser_success: plannerData !== null,\n    fallback_used: tasks.length === 0,\n    original_task_count: tasks.length\n  }\n};"
        },
        "id": "6e28b992-6c41-495d-a21d-812ec7120d63",
        "name": "üìù Format & Dispatch (Plan‚ÜíDB)",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          20832,
          22304
        ]
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "INSERT INTO rag_task_executions \n  (trace_id, task_id, intent_id, status, rag_called, attempt, query, confidence)\nVALUES {{ $json.tasks_to_insert.map(t => \n  `('${t.trace_id}', ${t.task_id}, '${t.intent_id}', '${t.status}', '${t.rag_called}', ${t.attempt}, '${t.query}', ${t.confidence})`\n).join(', ') }}\nON CONFLICT (trace_id, task_id) DO UPDATE \nSET status = 'pending', updated_at = NOW();\n",
          "options": {}
        },
        "id": "dd492a5d-32aa-4a72-9d90-7c9253e6f228",
        "name": "Postgres: Insert Tasks",
        "type": "n8n-nodes-base.postgres",
        "typeVersion": 2.5,
        "position": [
          21024,
          22304
        ],
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "continueOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// PATCH - Execution Engine V10.9\n// FIX 1: Passe correctement les donn√©es √† Response Builder\n// FIX 2: Marque le workflow comme termin√© pour √©viter re-trigger\n// ============================================\n\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nconst originalQuery = $node['Init V8 Security & Analysis'].json.query;\nconst isChat = $node['Input Merger V8'].json.is_chat || false;\n\n// === 1. ANTI-LOOP avec staticData ===\nconst staticData = $getWorkflowStaticData('global');\n\n// Check si d√©j√† termin√©\nconst completeKey = `complete_${traceId}`;\nif (staticData[completeKey]) {\n    console.log(`[${traceId}] ‚ö†Ô∏è Workflow d√©j√† termin√© - ignoring re-trigger`);\n    // Retourner un objet vide pour ne pas continuer\n    return [];\n}\n\n// Counter de boucle\nif (!staticData.loopCounters) {\n    staticData.loopCounters = {};\n}\nconst loopKey = `loop_${traceId}`;\nif (!staticData.loopCounters[loopKey]) {\n    staticData.loopCounters[loopKey] = 0;\n}\nstaticData.loopCounters[loopKey]++;\n\nconst currentIteration = staticData.loopCounters[loopKey];\nconst MAX_ITERATIONS = 10;\n\nconsole.log(`[${traceId}] Execution Engine V10.9 - iteration ${currentIteration}/${MAX_ITERATIONS}`);\n\n// === 2. SAFETY - Max iterations ===\nif (currentIteration > MAX_ITERATIONS) {\n    console.error(`[${traceId}] MAX ITERATIONS - Breaking!`);\n    staticData[completeKey] = true;  // Marquer comme termin√©\n    delete staticData.loopCounters[loopKey];\n    \n    return {\n        all_complete: true,\n        trace_id: traceId,\n        is_chat: isChat,\n        original_query: originalQuery,\n        completed_tasks: [],\n        all_responses: [],\n        final_response: \"Erreur: limite d'it√©rations atteinte.\",\n        error: \"MAX_ITERATIONS_EXCEEDED\"\n    };\n}\n\n// === 3. LECTURE DES T√ÇCHES ===\nlet dbTasks = [];\nlet currentTask = null;\nlet isFromFallback = false;\n\n// Check fallback\ntry {\n    const fallbackData = $node['üîÑ Fallback Dispatch']?.json;\n    if (fallbackData?.current_task?.status === 'pending') {\n        currentTask = fallbackData.current_task;\n        isFromFallback = true;\n        console.log(`[${traceId}] From fallback: task ${currentTask.task_id}`);\n    }\n} catch (e) {}\n\n// Lecture depuis input\nif (!currentTask) {\n    try {\n        const allItems = $input.all();\n        if (allItems?.length > 0) {\n            dbTasks = allItems.map(item => item.json).filter(t => t && t.task_id);\n            console.log(`[${traceId}] Read ${dbTasks.length} tasks from input`);\n        }\n    } catch (e) {\n        const inputData = $json;\n        if (Array.isArray(inputData)) {\n            dbTasks = inputData;\n        } else if (inputData?.task_id) {\n            dbTasks = [inputData];\n        }\n    }\n    \n    // Fallback premi√®re ex√©cution\n    if (dbTasks.length === 0) {\n        try {\n            dbTasks = $node['üìù Format & Dispatch (Plan‚ÜíDB)'].json.tasks_to_insert || [];\n            console.log(`[${traceId}] First run: ${dbTasks.length} tasks`);\n        } catch (e) {}\n    }\n}\n\n// === 4. ANALYSE DES T√ÇCHES ===\nif (!currentTask && dbTasks.length > 0) {\n    const pendingTasks = dbTasks.filter(t => t.status === 'pending');\n    const completedTasks = dbTasks.filter(t => t.status === 'complete');\n    const errorTasks = dbTasks.filter(t => t.status === 'error');\n    const skippedTasks = dbTasks.filter(t => t.status === 'skipped');\n    \n    const total = dbTasks.length;\n    \n    console.log(`[${traceId}] Tasks: ${pendingTasks.length} pending, ${completedTasks.length} complete, ${skippedTasks.length} skipped, ${errorTasks.length} error`);\n    \n    // === 5. ALL COMPLETE ===\n    if (pendingTasks.length === 0) {\n        console.log(`[${traceId}] ‚úÖ ALL COMPLETE - routing to Response Builder`);\n        \n        // MARQUER COMME TERMIN√â pour √©viter re-trigger\n        staticData[completeKey] = true;\n        delete staticData.loopCounters[loopKey];\n        \n        // Formatter les r√©sultats pour Response Builder\n        const formattedCompleted = completedTasks.map(t => {\n            let sources = t.sources || [];\n            if (typeof sources === 'string') {\n                try { sources = JSON.parse(sources); } catch (e) { sources = []; }\n            }\n            return {\n                task_id: t.task_id,\n                rag_called: t.rag_called,\n                query: t.query,\n                response: t.response || '',\n                confidence: parseFloat(t.confidence) || 0.5,\n                sources: sources\n            };\n        });\n        \n        // Construire all_responses\n        const allResponses = formattedCompleted\n            .filter(t => t.response && t.response.length > 10)\n            .map(t => ({\n                task_id: t.task_id,\n                rag: t.rag_called,\n                response: t.response,\n                confidence: t.confidence\n            }));\n        \n        // Calculer la meilleure r√©ponse\n        let bestResponse = '';\n        let bestConfidence = 0;\n        for (const resp of allResponses) {\n            if (resp.confidence > bestConfidence) {\n                bestConfidence = resp.confidence;\n                bestResponse = resp.response;\n            }\n        }\n        \n        console.log(`[${traceId}] Best response: ${bestResponse.length} chars, confidence ${bestConfidence}`);\n        \n        // === OUTPUT COMPLET POUR RESPONSE BUILDER ===\n        return {\n            all_complete: true,\n            trace_id: traceId,\n            is_chat: isChat,\n            original_query: originalQuery,\n            \n            // Donn√©es pour Response Builder\n            completed_tasks: formattedCompleted,\n            all_responses: allResponses,\n            pending_tasks: [],\n            error_tasks: errorTasks.map(t => ({\n                task_id: t.task_id,\n                rag_called: t.rag_called,\n                error_message: t.error_message || 'Unknown'\n            })),\n            skipped_tasks: skippedTasks.map(t => ({\n                task_id: t.task_id,\n                rag_called: t.rag_called\n            })),\n            \n            // Pr√©-calculer pour Response Builder\n            final_response: bestResponse,\n            confidence: bestConfidence,\n            \n            // Stats\n            total_tasks: total,\n            summary: {\n                completed: completedTasks.length,\n                pending: 0,\n                errors: errorTasks.length,\n                skipped: skippedTasks.length\n            }\n        };\n    }\n    \n    // === 6. NEXT TASK ===\n    currentTask = pendingTasks[0];\n    console.log(`[${traceId}] Next: task ${currentTask.task_id} ‚Üí ${currentTask.rag_called}`);\n}\n\n// === 7. VALIDATION ===\nif (!currentTask?.rag_called) {\n    console.error(`[${traceId}] No valid task found`);\n    staticData[completeKey] = true;\n    \n    return {\n        all_complete: true,\n        trace_id: traceId,\n        is_chat: isChat,\n        original_query: originalQuery,\n        completed_tasks: [],\n        all_responses: [],\n        final_response: \"Aucune t√¢che valide trouv√©e.\",\n        error: \"NO_VALID_TASK\"\n    };\n}\n\n// === 8. NORMALIZE RAG ===\nconst ragName = String(currentTask.rag_called).toUpperCase().trim();\nconst validRags = ['STANDARD', 'GRAPH', 'QUANTITATIVE'];\nconst normalizedRag = validRags.includes(ragName) ? ragName : 'STANDARD';\n\nconsole.log(`[${traceId}] Executing: ${normalizedRag}`);\n\n// === 9. OUTPUT POUR DYNAMIC SWITCH ===\nreturn {\n    all_complete: false,\n    trace_id: traceId,\n    is_chat: isChat,\n    original_query: originalQuery,\n    \n    current_task: {\n        ...currentTask,\n        rag_called: normalizedRag,\n        trace_id: traceId\n    },\n    route_to: normalizedRag,\n    task_id: currentTask.task_id,\n    task_query: currentTask.query,\n    attempt: currentTask.attempt || 1,\n    is_fallback: isFromFallback,\n    iteration: currentIteration\n};\n"
        },
        "id": "e234ca05-5574-404b-b92b-43f9db307ae7",
        "name": "‚öôÔ∏è Execution Engine V10",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          21376,
          22288
        ]
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.route_to }}",
                      "rightValue": "STANDARD",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "a54bbcc1-b6ef-4975-b887-1b300668f194"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.route_to }}",
                      "rightValue": "GRAPH",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "21dd21c6-f1b2-4d94-addf-2480f828b96f"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.route_to }}",
                      "rightValue": "QUANTITATIVE",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "06843e71-20ab-456a-a49f-4f17db5ff26e"
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {
            "fallbackOutput": "none"
          }
        },
        "id": "2813f987-c594-4ae1-9942-9fbeadd78b9d",
        "name": "üîÄ Dynamic Switch V10",
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          21616,
          22400
        ]
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// PATCH - Task Result Handler V10.1.3\n// FIX: Parsing robuste multi-format + fallback_response\n// ============================================\n//\n// PROBL√àMES R√âSOLUS:\n// 1. Ne lisait pas le format fallback_response du Standard RAG\n// 2. Graph RAG: pas de v√©rification du flag fallback\n// 3. Confidence toujours √† 0 car mauvais parsing\n//\n// INSTRUCTIONS:\n// 1. Ouvrir workflow \"V10.1 orchestrator copy\" (FZxkpldDbgV8AD_cg7IWG)\n// 2. √âditer le n≈ìud \"üì• Task Result Handler\"\n// 3. Remplacer tout le code par celui-ci\n// 4. Sauvegarder et tester\n// ============================================\n\nconst workflowResult = $json;\nconst currentTask = $node['‚öôÔ∏è Execution Engine V10'].json.current_task;\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\n\nlet response = '';\nlet sources = [];\nlet confidence = 0;\nlet error = null;\nlet success = false;\nlet formatDetected = 'unknown';\n\n// === FORMAT 0: Fallback Response (Standard RAG skip_llm=true) ===\nif (workflowResult.fallback_response) {\n  formatDetected = 'fallback_response';\n  response = workflowResult.fallback_response.response || '';\n  sources = workflowResult.fallback_response.sources || [];\n  confidence = workflowResult.fallback_response.confidence || 0.1;\n  success = response.length > 10;\n}\n// === FORMAT 1: Standard RAG direct (avec engine marker) ===\nelse if (workflowResult.engine === 'STANDARD' && workflowResult.response) {\n  formatDetected = 'standard_rag';\n  response = workflowResult.response;\n  sources = (workflowResult.sources || []).map(s => ({\n    source: s.source || 'document',\n    content: s.excerpt || s.content || '',\n    score: s.score || s.combined_score || 0\n  }));\n  confidence = workflowResult.confidence || 0.5;\n  success = response.length > 10;\n}\n// === FORMAT 2: Graph RAG nested (budgeted_context) ===\nelse if (workflowResult.status === 'SUCCESS' && workflowResult.response) {\n  const nestedResponse = workflowResult.response;\n  \n  if (nestedResponse.budgeted_context) {\n    formatDetected = 'graph_rag';\n    const ctx = nestedResponse.budgeted_context;\n    \n    // Check for fallback mode (no real graph traversal)\n    const isFallback = nestedResponse.fallback === true;\n    const traversalDepth = nestedResponse.traversal_depth || 0;\n    const hasGraphData = ctx.graph && ctx.graph.length > 0;\n    const hasRelationships = ctx.relationships && ctx.relationships.length > 10;\n    const hasValidData = hasGraphData || hasRelationships;\n    \n    if (isFallback || (!hasValidData && traversalDepth === 0)) {\n      // Graph traversal failed - mark as failure to trigger fallback\n      success = false;\n      error = `Graph RAG fallback: no data (fallback=${isFallback}, depth=${traversalDepth})`;\n      console.log(`[${traceId}] Graph RAG returned no useful data - will trigger fallback`);\n    } else {\n      response = ctx.relationships || '';\n      \n      // Combine graph and vector sources\n      const graphSources = (ctx.graph || []).map(s => ({\n        source: s.source || s.id || 'graph_entity',\n        content: s.content || s.properties || '',\n        type: 'graph'\n      }));\n      const vectorSources = (ctx.vector || []).map(s => ({\n        source: s.source || s.id || 'vector_doc',\n        content: s.content || '',\n        type: 'vector'\n      }));\n      sources = [...graphSources, ...vectorSources];\n      confidence = 0.6;\n      success = response.length > 10 || sources.length > 0;\n    }\n  } else {\n    // Graph RAG returned SUCCESS with direct response (no budgeted_context wrapper)\n    formatDetected = 'graph_rag_direct';\n    if (typeof nestedResponse === 'string') {\n      response = nestedResponse;\n    } else if (typeof nestedResponse === 'object') {\n      response = nestedResponse.text || nestedResponse.answer || nestedResponse.content || JSON.stringify(nestedResponse);\n    }\n    const meta = workflowResult.metadata || {};\n    confidence = meta.confidence || 0.5;\n    sources = [];\n    // If metadata has source info, create a source entry\n    if (meta.source) {\n      sources.push({ source: meta.source, content: '', type: 'graph' });\n    }\n    success = response && String(response).trim().length > 10;\n  }\n}\n// === FORMAT 3: Quantitative RAG (SQL interpretation) ===\nelse if (workflowResult.interpretation) {\n  formatDetected = 'quantitative_rag';\n  response = workflowResult.interpretation;\n  sources = (workflowResult.raw_results || []).map((r, i) => ({\n    source: `SQL Result ${i + 1}`,\n    content: JSON.stringify(r).substring(0, 500),\n    type: 'sql'\n  }));\n  confidence = 0.7;\n  success = true;\n}\n// === FORMAT 4: Generic response (simple format) ===\nelse if (workflowResult.response) {\n  formatDetected = 'generic';\n  response = typeof workflowResult.response === 'string' \n    ? workflowResult.response \n    : JSON.stringify(workflowResult.response);\n  sources = workflowResult.sources || [];\n  confidence = workflowResult.confidence || 0.5;\n  success = response.length > 10;\n}\n// === FORMAT 5: Answer field (some workflows) ===\nelse if (workflowResult.answer) {\n  formatDetected = 'answer_field';\n  response = workflowResult.answer;\n  sources = [];\n  confidence = 0.5;\n  success = response.length > 10;\n}\n// === FORMAT 6: Explicit error ===\nelse if (workflowResult.error || workflowResult.errorMessage) {\n  formatDetected = 'error';\n  error = workflowResult.error || workflowResult.errorMessage;\n  if (typeof error === 'object') {\n    error = error.message || JSON.stringify(error);\n  }\n  success = false;\n}\n// === FORMAT 7: Empty result (no documents) ===\nelse if (workflowResult.result_count === 0 || workflowResult.has_results === false) {\n  formatDetected = 'empty_result';\n  response = \"Aucun document pertinent trouv√©.\";\n  confidence = 0.1;\n  success = false; // Trigger fallback\n}\n// === FORMAT 8: Unrecognized ===\nelse {\n  formatDetected = 'unrecognized';\n  console.log(`[${traceId}] Unrecognized format. Keys: ${Object.keys(workflowResult).join(', ')}`);\n  \n  // Try to extract anything useful\n  const possibleResponse = workflowResult.text || workflowResult.content || workflowResult.output || '';\n  if (possibleResponse && possibleResponse.length > 10) {\n    response = possibleResponse;\n    confidence = 0.3;\n    success = true;\n  } else {\n    success = false;\n    error = 'Unrecognized response format';\n  }\n}\n\n// === VALIDATION FINALE ===\nconst hasValidResponse = response && String(response).trim().length > 10;\nconst finalSuccess = success && (hasValidResponse || sources.length > 0);\n\n// Ensure confidence is a valid number\nif (typeof confidence !== 'number' || isNaN(confidence)) {\n  confidence = finalSuccess ? 0.5 : 0.1;\n}\n\nconsole.log(`[${traceId}] Task ${currentTask.task_id} (${currentTask.rag_called}): ${finalSuccess ? 'SUCCESS' : 'FAILED'}`);\nconsole.log(`[${traceId}]   Format: ${formatDetected}, Response: ${response.length} chars, Sources: ${sources.length}, Confidence: ${confidence.toFixed(4)}`);\n\nif (error) {\n  console.log(`[${traceId}]   Error: ${error}`);\n}\n\n// === OUTPUT ===\nreturn {\n  task: currentTask,\n  success: finalSuccess,\n  response: response,\n  sources: sources.slice(0, 10),\n  confidence: confidence,\n  error_message: error,\n  trace_id: traceId,\n  format_detected: formatDetected,\n  raw_result: workflowResult // Pour debug\n};"
        },
        "id": "69968841-95e5-4717-9acd-9a80d2b3a215",
        "name": "üì• Task Result Handler",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          22128,
          22336
        ]
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "UPDATE rag_task_executions\nSET \n  status = $1,\n  response = $2,\n  error_message = $3,\n  sources = $4::jsonb,\n  updated_at = NOW()\nWHERE trace_id = $5 \n  AND task_id = $6",
          "options": {
            "queryReplacement": "={{ [$json.success ? 'complete' : 'error', $json.response || '', $json.error_message || '', JSON.stringify($json.sources || []), $json.trace_id, $json.task.task_id] }}"
          }
        },
        "id": "6bd0234e-efea-4e89-8cf5-3448af22cbda",
        "name": "Postgres: Update Task",
        "type": "n8n-nodes-base.postgres",
        "typeVersion": 2.5,
        "position": [
          22224,
          21744
        ],
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "continueOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// === FALLBACK MONITOR V10.2 - SIMPLIFIED: Accept any response with content ===\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nconst taskHandlerData = $node['üì• Task Result Handler'].json;\nconst currentTask = taskHandlerData.task || {};\n\nconst response = taskHandlerData.response || '';\nconst confidence = taskHandlerData.confidence || 0;\nconst attempt = currentTask.attempt || 1;\nconst taskId = currentTask.task_id;\nconst originalSuccess = taskHandlerData.success || false;\n\n// SIMPLIFIED: Accept if we have ANY response text, regardless of length or confidence\nconst hasAnyResponse = response && String(response).trim().length > 0;\nconst success = hasAnyResponse || originalSuccess;\n\nconsole.log(`[${traceId}] Task ${taskId} - success=${success}, response_len=${String(response).length}, confidence=${confidence}, attempt=${attempt}`);\n\nif (success) {\n  // No fallback needed\n  return {\n    fallback_needed: false,\n    task_id: taskId,\n    current_rag: currentTask.rag_called,\n    response: response,\n    confidence: confidence,\n    trace_id: traceId,\n    task: currentTask\n  };\n}\n\n// Only fallback if truly no response AND first attempt\nif (attempt >= 2) {\n  console.log(`[${traceId}] Task ${taskId} - Max attempts reached, accepting even empty response`);\n  return {\n    fallback_needed: false,\n    task_id: taskId,\n    current_rag: currentTask.rag_called,\n    response: response || \"Unable to retrieve information\",\n    confidence: 0.1,\n    trace_id: traceId,\n    task: currentTask\n  };\n}\n\n// Determine fallback RAG\nconst currentRag = currentTask.rag_called || 'STANDARD';\nconst FALLBACK_MAP = {\n  'QUANTITATIVE': 'STANDARD',\n  'GRAPH': 'STANDARD',\n  'STANDARD': 'GRAPH'\n};\nconst nextRag = FALLBACK_MAP[currentRag] || 'STANDARD';\n\nreturn {\n  fallback_needed: true,\n  task_id: taskId,\n  current_rag: currentRag,\n  next_rag: nextRag,\n  attempt: attempt + 1,\n  failure_reason: 'empty_response',\n  original_query: $node['Init V8 Security & Analysis'].json.query,\n  trace_id: traceId,\n  task: currentTask\n};"
        },
        "id": "760a5d3c-6e1e-4d91-aff1-eb0cf96a1c4e",
        "name": "üîÑ Fallback Monitor V10",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          22400,
          21744
        ]
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "id": "id-1",
                "leftValue": "={{ $json.fallback_needed }}",
                "rightValue": true,
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "id": "67332e02-80d8-4dfc-9d94-d1427dcefd26",
        "name": "IF: Fallback Needed?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          22576,
          21744
        ]
      },
      {
        "parameters": {
          "jsCode": "// === FALLBACK DISPATCH V10.1.2 - Pr√©paration compl√®te pour retry ===\nconst fb = $json;\nconst traceId = fb.trace_id;\n\nconsole.log(`[${traceId}] Dispatching fallback: task ${fb.task_id} ‚Üí ${fb.next_rag} (attempt ${fb.attempt})`);\n\n// Construire une t√¢che compl√®te pour le retry\nconst retriedTask = {\n  task_id: fb.task_id,\n  trace_id: traceId,\n  intent_id: fb.task?.intent_id || 'fallback',\n  status: 'pending',\n  rag_called: fb.next_rag,\n  attempt: fb.attempt,\n  query: fb.original_query,\n  confidence: 0.8,\n  // M√©tadonn√©es de fallback\n  is_fallback: true,\n  previous_rag: fb.current_rag,\n  failure_reason: fb.failure_reason\n};\n\nreturn {\n  // Pour Postgres: Update Fallback\n  trace_id: traceId,\n  task_id: fb.task_id,\n  new_status: 'pending',\n  new_rag: fb.next_rag,\n  new_attempt: fb.attempt,\n  \n  // Pour Dynamic Switch (route_to)\n  route_to: fb.next_rag,\n  \n  // T√¢che compl√®te pour Execution Engine\n  current_task: retriedTask,\n  task_query: fb.original_query,\n  \n  // Pour debug\n  fallback_chain: [fb.current_rag, fb.next_rag],\n  all_complete: false\n};"
        },
        "id": "2aaeab2f-9a91-421e-b4a2-b9c9ab19b7be",
        "name": "üîÑ Fallback Dispatch",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          22800,
          21776
        ]
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "UPDATE rag_task_executions\nSET \n  status = 'pending',\n  rag_called = '{{ $json.new_rag }}',\n  attempt = {{ $json.new_attempt }},\n  updated_at = NOW()\nWHERE trace_id = '{{ $json.trace_id }}' \n  AND task_id = {{ $json.task_id }};\n",
          "options": {}
        },
        "id": "960461ba-c688-4993-98ec-1ea16be7d883",
        "name": "Postgres: Update Fallback",
        "type": "n8n-nodes-base.postgres",
        "typeVersion": 2.5,
        "position": [
          22960,
          21776
        ],
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "continueOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// === CACHE STORAGE - Stocke les r√©ponses simples ===\nconst finalResponse = $node['Response Builder V9'].json.final_response;\nconst initData = $node['Init V8 Security & Analysis'].json;\n\n// Pr√©parer les donn√©es de cache\nconst cacheKey = `faq:${initData.query_hash}`;\nconst cacheValue = JSON.stringify({\n  response: finalResponse,\n  timestamp: Date.now(),\n  query: initData.query\n});\n\nconsole.log(`[${initData.trace_id}] Storing in cache: ${cacheKey}`);\n\nreturn {\n  cache_key: cacheKey,\n  cache_value: cacheValue,\n  ttl: 3600,\n  trace_id: initData.trace_id\n};"
        },
        "id": "ca85038c-26c6-4002-b9c1-b231dc51e10f",
        "name": "üíæ Cache Storage",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          24320,
          22816
        ]
      },
      {
        "parameters": {
          "operation": "set",
          "key": "={{ $json.cache_key }}",
          "value": "={{ $json.cache_value }}",
          "keyType": "string",
          "expire": true,
          "ttl": "={{ $json.ttl }}"
        },
        "id": "c295072a-deaf-494d-84c7-6b569fc810e4",
        "name": "Redis: Set Cache",
        "type": "n8n-nodes-base.redis",
        "typeVersion": 1,
        "position": [
          24512,
          22816
        ],
        "credentials": {
          "redis": {
            "id": "O2KEPiv7VzgDG5ZX",
            "name": "Redis Upstash"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// NODE: üß† Memory Merger V10.1 (FIXED)\n// PURPOSE: Fusion Redis + Postgres avec gestion erreurs\n// ============================================\n\n// === 1. R√âCUP√âRER REDIS DATA ===\nlet redisData = {};\ntry {\n  redisData = $node['üõ°Ô∏è Redis Failure Handler V10.1']?.json || {};\n} catch(e) {\n  console.log('Redis Failure Handler not found, trying raw Redis');\n  try {\n    redisData = $node['Redis: Fetch Conversation']?.json || {};\n    // Fallback parsing\n    if (redisData.data) {\n      try {\n        const parsed = JSON.parse(redisData.data || '{}');\n        redisData = {\n          conversation_history: parsed.history || [],\n          redis_available: true\n        };\n      } catch(e2) {\n        redisData = { conversation_history: [], redis_available: true };\n      }\n    }\n  } catch(e2) {\n    redisData = { conversation_history: [], redis_available: false };\n  }\n}\n\nconst initData = $node['Init V8 Security & Analysis'].json;\nconst traceId = redisData.trace_id || initData.trace_id;\n\n// Historique court terme (Redis)\nconst shortTermHistory = redisData.conversation_history || [];\n\n// === 2. R√âCUP√âRER POSTGRES DATA (AVEC GESTION ERREURS) ===\nlet postgresData = {};\nlet postgresAvailable = false;\n\ntry {\n  const pgResult = $node['Postgres L2/L3 Memory']?.json;\n  \n  // V√©rifications multiples\n  if (pgResult && \n      !pgResult.error && \n      pgResult.entities_json !== null && \n      pgResult.entities_json !== undefined) {\n    \n    postgresData = pgResult;\n    postgresAvailable = true;\n    console.log(`[${traceId}] Postgres L2/L3 OK`);\n    \n  } else if (pgResult?.error) {\n    console.warn(`[${traceId}] Postgres L2/L3 ERROR:`, pgResult.error.message || pgResult.error);\n  } else {\n    console.log(`[${traceId}] Postgres L2/L3 empty (new user)`);\n  }\n  \n} catch (e) {\n  console.error(`[${traceId}] Postgres L2/L3 exception:`, e.message);\n}\n\n// === 3. FUSIONNER INTELLIGEMMENT ===\nlet entitiesJson = {};\nif (postgresData.entities_json) {\n  if (typeof postgresData.entities_json === 'string') {\n    try {\n      entitiesJson = JSON.parse(postgresData.entities_json);\n    } catch(e) {\n      entitiesJson = {};\n    }\n  } else {\n    entitiesJson = postgresData.entities_json;\n  }\n}\n\nconst lastIntent = postgresData.last_intent || 'UNKNOWN';\n\n// Construire contexte fusionn√©\nconst mergedContext = {\n  recent_messages: shortTermHistory.slice(-10),\n  user_profile: postgresData.user_context || {},\n  user_preferences: postgresData.preferences || {},\n  entities_of_interest: entitiesJson,\n  last_intent: lastIntent,\n  conversation_id: initData.conversation_id,\n  session_id: initData.session_id,\n  trace_id: traceId,\n  query: initData.query,\n  query_hash: initData.query_hash,\n  redis_available: redisData.redis_available !== false,\n  postgres_available: postgresAvailable,\n  context_status: redisData.context_status || 'UNKNOWN'\n};\n\nconsole.log(`[${traceId}] Memory merged: ${shortTermHistory.length} msgs (Redis), ${postgresAvailable ? 'Postgres OK' : 'Postgres unavailable'}`);\n\nreturn mergedContext;"
        },
        "id": "771afac4-90da-4e02-a8e8-d4032075bb64",
        "name": "üß† Memory Merger (Redis + Postgres)",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          17696,
          21888
        ]
      },
      {
        "parameters": {
          "jsCode": "// === ADVANCED GUARDRAILS - Prompt Injection, Jailbreak, Content Safety ===\nconst mergedContext = $json;\nconst query = mergedContext.query || '';\nconst traceId = mergedContext.trace_id;\n\n// Patterns de prompt injection\nconst INJECTION_PATTERNS = [\n  /ignore (previous|all) (instructions|prompts)/i,\n  /you are now|pretend (you are|to be)/i,\n  /system:|<\\|im_start\\|>|<\\|im_end\\|>/i,\n  /\\n\\nHuman:|\\n\\nAssistant:/i,\n  /<script|javascript:|onerror=|eval\\(/i,\n  /forget (everything|all)|disregard (previous|all)/i\n];\n\n// Patterns de jailbreak\nconst JAILBREAK_PATTERNS = [\n  /DAN|Do Anything Now/i,\n  /evil mode|developer mode/i,\n  /sudo mode|admin mode/i,\n  /without any (restrictions|limitations|ethical)/i\n];\n\n// Patterns de contenu sensible\nconst SENSITIVE_PATTERNS = [\n  /how to (make|create|build) (bomb|weapon|explosive)/i,\n  /hack|exploit|vulnerability|backdoor/i,\n  /(illegal|illicit) (drugs|substances)/i\n];\n\n// V√©rifications\nconst hasInjection = INJECTION_PATTERNS.some(p => p.test(query));\nconst hasJailbreak = JAILBREAK_PATTERNS.some(p => p.test(query));\nconst hasSensitive = SENSITIVE_PATTERNS.some(p => p.test(query));\n\nconst isBlocked = hasInjection || hasJailbreak || hasSensitive;\n\nlet blockReason = null;\nif (hasInjection) blockReason = \"prompt_injection\";\nif (hasJailbreak) blockReason = \"jailbreak_attempt\";\nif (hasSensitive) blockReason = \"sensitive_content\";\n\nif (isBlocked) {\n  console.log(`[${traceId}] BLOCKED: ${blockReason}`);\n}\n\nreturn {\n  ...mergedContext,\n  guardrail_passed: !isBlocked,\n  guardrail_blocked: isBlocked,\n  block_reason: blockReason,\n  injection_detected: hasInjection,\n  jailbreak_detected: hasJailbreak,\n  sensitive_detected: hasSensitive\n};\n"
        },
        "id": "5195d53f-ba51-4531-a015-08d5a22b67ed",
        "name": "üõ°Ô∏è Advanced Guardrails",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          17888,
          21888
        ]
      },
      {
        "parameters": {
          "conditions": {
            "boolean": [
              {
                "value1": "={{ $json.guardrail_passed }}",
                "value2": true
              }
            ]
          },
          "options": {}
        },
        "id": "dac0a336-6e67-4b4c-b5ae-80ff733d4414",
        "name": "IF: Guardrail Passed?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          18080,
          21888
        ]
      },
      {
        "parameters": {
          "respondWith": "text",
          "responseBody": "I cannot respond to this request because it contains inappropriate or potentially harmful content.",
          "options": {}
        },
        "id": "b6bd01b0-8d5f-47d3-9c7d-98de8d2e77ae",
        "name": "Return: Guardrail Blocked",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          18256,
          21952
        ]
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.query_route }}",
                      "rightValue": "conversational",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "09b9e899-fec1-4e05-a4ba-58262fb5c072"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.query_route }}",
                      "rightValue": "cache_check",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "52bd6b24-bf82-48ff-b1aa-4d8266ade86f"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "dae8b9a1-a47c-490e-93d2-549bf166c3ab",
                      "leftValue": "={{ $json.query_route }}",
                      "rightValue": "direct_llm",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {
            "fallbackOutput": "extra"
          }
        },
        "id": "3a29a41a-fe91-4c3d-bce6-ddc3206f734b",
        "name": "üîÄ Query Router",
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          18528,
          21808
        ]
      },
      {
        "parameters": {
          "jsCode": "// === CONVERSATIONAL HANDLER - R√©ponses directes conversationnelles ===\nconst context = $json;\nconst query = context.query.toLowerCase().trim();\nconst traceId = context.trace_id;\n\n// R√©ponses template\nconst RESPONSES = {\n  'hi': \"Bonjour ! Comment puis-je vous aider aujourd'hui ?\",\n  'hello': \"Hello! How can I assist you today?\",\n  'bonjour': \"Bonjour ! Je suis l√† pour vous aider. Que puis-je faire pour vous ?\",\n  'thanks': \"De rien ! N'h√©sitez pas si vous avez d'autres questions.\",\n  'thank you': \"You're welcome! Feel free to ask if you need anything else.\",\n  'merci': \"Avec plaisir ! Je reste √† votre disposition.\",\n  'bye': \"Au revoir ! √Ä bient√¥t.\",\n  'goodbye': \"Goodbye! Have a great day!\",\n  'ok': \"D'accord ! Y a-t-il autre chose ?\",\n  'yes': \"Parfait ! Que puis-je faire d'autre pour vous ?\",\n  'no': \"D'accord, n'h√©sitez pas si vous changez d'avis.\"\n};\n\n// Trouver la r√©ponse\nlet response = \"Je suis l√† pour vous aider. Que puis-je faire pour vous ?\";\nfor (const [pattern, resp] of Object.entries(RESPONSES)) {\n  if (query.includes(pattern)) {\n    response = resp;\n    break;\n  }\n}\n\nconsole.log(`[${traceId}] Conversational response generated`);\n\nreturn {\n  trace_id: traceId,\n  query: context.query,\n  response: response,\n  is_conversational: true,\n  conversation_id: context.conversation_id\n};\n"
        },
        "id": "b7212bb1-ec8d-45c3-b19a-919acd65f460",
        "name": "üí¨ Conversational Handler",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          18768,
          21712
        ]
      },
      {
        "parameters": {
          "respondWith": "text",
          "responseBody": "={{ $json.response }}",
          "options": {}
        },
        "id": "bb985081-d04e-41eb-a725-5169e456ad02",
        "name": "Return: Conversational",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          18928,
          21744
        ]
      },
      {
        "parameters": {
          "jsCode": "// === CACHE SEMANTIC SEARCH - Trouve questions similaires ===\nconst context = $json;\nconst query = context.query;\nconst queryHash = context.query_hash;\nconst traceId = context.trace_id;\n\n// Note: Ici on simule une recherche s√©mantique\n// En production, on utiliserait un vector store (Pinecone, Qdrant, etc.)\n// ou Redis avec RedisSearch/RediSearch VSS\n\n// Pour l'instant, on checke juste le hash exact\n// Le node Redis suivant fera le vrai travail\n\nreturn {\n  ...context,\n  cache_search_query: queryHash,\n  semantic_search_enabled: true\n};\n"
        },
        "id": "8211b2d7-c032-4617-adcf-037d1b8c0b27",
        "name": "üîé Cache Semantic Search",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          18768,
          21920
        ]
      },
      {
        "parameters": {
          "operation": "get",
          "key": "={{ 'faq:' + $json.query_hash }}",
          "options": {}
        },
        "id": "97a611eb-b47f-4066-b00d-6b0a6cda5650",
        "name": "Redis: Cache + Generator",
        "type": "n8n-nodes-base.redis",
        "typeVersion": 1,
        "position": [
          18944,
          21920
        ],
        "credentials": {
          "redis": {
            "id": "O2KEPiv7VzgDG5ZX",
            "name": "Redis Upstash"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1/chat/completions' }}",
          "authentication": "none",
          "nodeCredentialType": "openRouterApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ {\n  \"model\": $vars.LLM_AGENT_MODEL || 'meta-llama/llama-3.3-70b-instruct:free',\n  \"max_tokens\": 500,\n  \"temperature\": 0.3,\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are the JUDGE of a multi-engine RAG system. Your role is to decide if the obtained results are sufficient to answer the user's question.\\n\\n=== YOUR ROLE ===\\n1. Analyze the user's ORIGINAL QUERY\\n2. Examine the OBTAINED RESPONSES from completed tasks\\n3. JUDGE whether these responses are sufficient to answer the query\\n4. Decide what to do with remaining pending tasks\\n\\n=== YOUR POSSIBLE DECISIONS ===\\n\\n**all_tasks_complete: true** ‚Üí The obtained responses are sufficient to answer the user\\n- Set all pending tasks to SKIP\\n- The workflow will generate the final response\\n\\n**all_tasks_complete: false** ‚Üí Information is still missing\\n- KEEP necessary pending tasks\\n- SKIP redundant pending tasks\\n- Optional: ADD new tasks\\n\\n=== JSON RESPONSE FORMAT ===\\n{\\n  \\\"all_tasks_complete\\\": true/false,\\n  \\\"judgment\\\": \\\"Explanation of why responses are sufficient or not\\\",\\n  \\\"actions\\\": [\\n    {\\\"action\\\": \\\"SKIP\\\", \\\"task_id\\\": 2, \\\"reason\\\": \\\"...\\\"},\\n    {\\\"action\\\": \\\"KEEP\\\", \\\"task_id\\\": 3, \\\"reason\\\": \\\"...\\\"}\\n  ],\\n  \\\"missing_info\\\": \\\"What is missing if all_tasks_complete=false\\\"\\n}\\n\\n=== RULES ===\\n- You MUST provide an action for EVERY pending task\\n- If all_tasks_complete=true, ALL pending tasks must be SKIP\\n- Do NOT handle fallbacks/errors (another system handles that)\\n- Respond ONLY with valid JSON\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"=== USER'S ORIGINAL QUERY ===\\n\" + $node['Init V8 Security & Analysis'].json.query + \"\\n\\n=== OBTAINED RESPONSES (completed tasks) ===\\n\" + JSON.stringify($node['üìä Task Status Aggregator'].json.completed_tasks || [], null, 2) + \"\\n\\n=== PENDING TASKS ===\\n\" + JSON.stringify($node['üìä Task Status Aggregator'].json.pending_tasks || [], null, 2) + \"\\n\\n=== ERROR TASKS ===\\n\" + JSON.stringify($node['üìä Task Status Aggregator'].json.error_tasks || [], null, 2) + \"\\n\\nAnalyze whether the obtained responses are sufficient to answer the original query. Return your decision in JSON.\"\n    }\n  ]\n} }}",
          "options": {
            "timeout": 8000,
            "retry": {
              "maxTries": 1,
              "waitBetweenTries": 1000
            }
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
              }
            ]
          }
        },
        "id": "65630655-5b38-4faa-9a4d-a30faa4ce90a",
        "name": "üéØ LLM 3: Agent Harness (Opus 4.5)",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          22944,
          22096
        ],
        "credentials": {},
        "continueOnFail": true,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// NODE: üìä Agent Decision Parser V10.3\n// PURPOSE: Parse LLM3 Agent Harness (JUGE) response\n// ============================================\n\nconst agentResponse = $json;\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\n\nlet decisions = null;\n\ntry {\n    // === 1. EXTRACT CONTENT FROM API RESPONSE ===\n    let content = '';\n    \n    // OpenRouter format: choices[0].message.content\n    if (agentResponse.choices?.[0]?.message?.content) {\n        content = agentResponse.choices[0].message.content;\n        console.log(`[${traceId}] Detected OpenRouter format`);\n    }\n    // Anthropic format: content[0].text\n    else if (agentResponse.content?.[0]?.text) {\n        content = agentResponse.content[0].text;\n        console.log(`[${traceId}] Detected Anthropic format`);\n    }\n    // Body wrapper (some API configs)\n    else if (agentResponse.body?.choices?.[0]?.message?.content) {\n        content = agentResponse.body.choices[0].message.content;\n        console.log(`[${traceId}] Detected wrapped OpenRouter format`);\n    }\n    // Anthropic body wrapper\n    else if (agentResponse.body?.content?.[0]?.text) {\n        content = agentResponse.body.content[0].text;\n        console.log(`[${traceId}] Detected wrapped Anthropic format`);\n    }\n    \n    if (!content) {\n        throw new Error('No content found in LLM response. Available keys: ' + Object.keys(agentResponse).join(', '));\n    }\n    \n    // === 2. CLEAN AND PARSE JSON ===\n    let cleanedContent = content.trim();\n    \n    // Remove markdown code blocks if present\n    cleanedContent = cleanedContent.replace(/```json\\s*/g, '').replace(/```\\s*/g, '');\n    \n    // Try to extract JSON object\n    const jsonMatch = cleanedContent.match(/\\{[\\s\\S]*\\}/);\n    if (jsonMatch) {\n        decisions = JSON.parse(jsonMatch[0]);\n    } else {\n        decisions = JSON.parse(cleanedContent);\n    }\n    \n    console.log(`[${traceId}] LLM3 Agent Harness parsed successfully`);\n    \n} catch (e) {\n    console.error(`[${traceId}] Agent parsing error: ${e.message}`);\n    console.error(`[${traceId}] Response structure: ${JSON.stringify(agentResponse, null, 2).substring(0, 500)}`);\n    \n    // Fallback: continue without modifications\n    decisions = {\n        all_tasks_complete: false,\n        judgment: 'Parse error - continuing with existing tasks',\n        actions: [],\n        missing_info: 'Unable to parse LLM3 response: ' + e.message\n    };\n}\n\n// === 3. EXTRACT DECISIONS ===\nconst allTasksComplete = decisions.all_tasks_complete === true;\nconst judgment = decisions.judgment || 'No judgment provided';\nconst actions = Array.isArray(decisions.actions) ? decisions.actions : [];\nconst missingInfo = decisions.missing_info || '';\n\n// === 4. LOGGING ===\nconsole.log(`[${traceId}] === LLM3 JUDGMENT ===`);\nconsole.log(`[${traceId}] all_tasks_complete: ${allTasksComplete}`);\nconsole.log(`[${traceId}] judgment: ${judgment}`);\nconsole.log(`[${traceId}] actions: ${actions.length}`);\n\nif (allTasksComplete) {\n    console.log(`[${traceId}] ‚úÖ LLM3 says: Responses are sufficient!`);\n} else {\n    console.log(`[${traceId}] ‚è≥ LLM3 says: Missing info: ${missingInfo}`);\n}\n\nactions.forEach((action, idx) => {\n    console.log(`[${traceId}]   Action ${idx + 1}: ${action.action} task_id=${action.task_id} - ${action.reason || 'no reason'}`);\n});\n\n// === 5. OUTPUT ===\nreturn {\n    trace_id: traceId,\n    \n    // Main signal for Task Updater\n    all_tasks_complete: allTasksComplete,\n    judgment: judgment,\n    missing_info: missingInfo,\n    \n    // Actions array for Task Updater\n    actions: actions,\n    \n    // Compatibility with old format\n    plan_updated: actions.length > 0,\n    reasoning: judgment,\n    \n    // Debug info\n    _debug: {\n        actions_count: actions.length,\n        has_skip_actions: actions.some(a => a.action === 'SKIP'),\n        has_keep_actions: actions.some(a => a.action === 'KEEP'),\n        has_add_actions: actions.some(a => a.action === 'ADD')\n    }\n};"
        },
        "id": "4e969cfa-9585-4d55-b7dc-3809bd6b3284",
        "name": "üìä Agent Decision Parser",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          23104,
          22096
        ]
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// PATCH - Task Updater V10.6\n// FIX: Ne reboucle PAS quand all_tasks_complete=true\n// ============================================\n//\n// PROBL√àME R√âSOLU:\n// Avant: Task Updater ‚Üí Postgres: Apply Skips ‚Üí Postgres: Get Current Tasks ‚Üí Execution Engine\n// Cela causait une boucle m√™me apr√®s que Response Builder ait fini!\n//\n// SOLUTION:\n// Quand all_tasks_complete=true, on NE FAIT PAS de skip dans la DB\n// car Execution Engine a d√©j√† rout√© vers Response Builder.\n// Les t√¢ches pending seront ignor√©es, pas besoin de les skipper.\n//\n// CHANGEMENT ARCHITECTURAL REQUIS:\n// Ajouter un IF node apr√®s Task Updater:\n// - Si all_tasks_complete=true ‚Üí NE PAS connecter √† Postgres: Apply Skips\n// - Si all_tasks_complete=false ‚Üí Connecter normalement\n// ============================================\n\nconst parsed = $json;\nconst traceId = parsed.trace_id;\n\nconst allTasksComplete = parsed.all_tasks_complete === true;\nconst judgment = parsed.judgment || '';\nconst actions = parsed.actions || [];\n\nconsole.log(`[${traceId}] Task Updater V10.6`);\nconsole.log(`[${traceId}] all_tasks_complete: ${allTasksComplete}`);\n\n// === CAS 1: TERMINAISON - NE PAS REBOUCLER ===\nif (allTasksComplete) {\n    console.log(`[${traceId}] ‚úÖ TERMINAISON D√âTECT√âE`);\n    console.log(`[${traceId}] Judgment: ${judgment}`);\n    console.log(`[${traceId}] ‚ö†Ô∏è NE PAS reboucler - Response Builder va g√©rer`);\n    \n    // IMPORTANT: On ne fait PAS de skip_updates\n    // Car on ne veut PAS trigger Postgres: Apply Skips ‚Üí Get Current Tasks ‚Üí Execution Engine\n    // Execution Engine a d√©j√† rout√© vers Response Builder via le IF node\n    \n    return {\n        trace_id: traceId,\n        all_tasks_complete: true,\n        should_loop: false,  // FLAG IMPORTANT pour le IF node\n        judgment: judgment,\n        skip_updates: [],    // VIDE - pas de reboucle\n        new_tasks: [],\n        total_skipped: 0,\n        total_added: 0,\n        has_pending_after: false\n    };\n}\n\n// === CAS 2: TRAVAIL RESTANT - Appliquer les actions ===\nconsole.log(`[${traceId}] ‚è≥ Travail restant, ${actions.length} actions`);\n\n// R√©cup√©rer les t√¢ches pending\nlet pendingTasks = [];\nlet maxTaskId = 0;\ntry {\n    const dbResult = $('Postgres : Get Current Tasks').all();\n    const dbTasks = dbResult.map(item => item.json);\n    pendingTasks = dbTasks.filter(t => t.status === 'pending');\n    dbTasks.forEach(t => {\n        if (t.task_id > maxTaskId) maxTaskId = t.task_id;\n    });\n} catch (e) {\n    console.log(`[${traceId}] DB read error: ${e.message}`);\n}\n\nconst skips = [];\nconst newTasks = [];\n\nfor (const action of actions) {\n    if (action.action === 'SKIP') {\n        skips.push({\n            task_id: action.task_id,\n            trace_id: traceId,\n            reason: action.reason || 'LLM3 decision',\n            new_status: 'skipped'\n        });\n        console.log(`[${traceId}] SKIP task ${action.task_id}`);\n        \n    } else if (action.action === 'KEEP') {\n        console.log(`[${traceId}] KEEP task ${action.task_id}`);\n        \n    } else if (action.action === 'ADD' && action.new_task) {\n        const newTaskId = maxTaskId + newTasks.length + 1;\n        newTasks.push({\n            trace_id: traceId,\n            task_id: newTaskId,\n            intent_id: 'llm3_added',\n            status: 'pending',\n            rag_called: action.new_task.rag || 'STANDARD',\n            attempt: 1,\n            query: (action.new_task.query || '').replace(/'/g, \"''\"),\n            confidence: 0.8\n        });\n        console.log(`[${traceId}] ADD task ${newTaskId}`);\n    }\n}\n\nconst skippedIds = new Set(skips.map(s => s.task_id));\nconst remainingPending = pendingTasks.filter(t => !skippedIds.has(t.task_id));\nconst hasPendingAfter = remainingPending.length > 0 || newTasks.length > 0;\n\nconsole.log(`[${traceId}] Result: ${skips.length} skips, ${newTasks.length} adds, ${remainingPending.length} remaining`);\n\nreturn {\n    trace_id: traceId,\n    all_tasks_complete: false,\n    should_loop: true,  // FLAG pour le IF node - continuer la boucle\n    judgment: judgment,\n    skip_updates: skips,\n    new_tasks: newTasks,\n    total_skipped: skips.length,\n    total_added: newTasks.length,\n    has_pending_after: hasPendingAfter\n};\n"
        },
        "id": "04172aae-947d-4181-b3ca-cac2102249b3",
        "name": "üîÑ Task Updater",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          23280,
          22080
        ]
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "={{ $json.skip_updates && $json.skip_updates.length > 0 ? \n  \"UPDATE rag_task_executions SET status = 'skipped', updated_at = NOW() WHERE \" +\n  $json.skip_updates.map(s => `(trace_id = '${s.trace_id}' AND task_id = ${s.task_id})`).join(' OR ')\n  : \"SELECT 1\" \n}}",
          "options": {}
        },
        "id": "ba3d7b7d-adfb-423f-a43c-ce2b670484a2",
        "name": "Postgres: Apply Skips",
        "type": "n8n-nodes-base.postgres",
        "typeVersion": 2.5,
        "position": [
          23696,
          22208
        ],
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "continueOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "={{ $json.new_tasks && $json.new_tasks.length > 0 ? \"INSERT INTO rag_task_executions (trace_id, task_id, intent_id, status, rag_called, attempt, query, confidence) VALUES \" + $json.new_tasks.map(t => `('${t.trace_id}', ${t.task_id}, '${t.intent_id}', '${t.status}', '${t.rag_called}', ${t.attempt}, '${t.query}', ${t.confidence})`).join(', ') + \" ON CONFLICT (trace_id, task_id) DO NOTHING\" : \"SELECT 1\" }}",
          "options": {}
        },
        "id": "3501e6a9-d1e6-41c8-8298-1b310f2f05f0",
        "name": "Postgres: Insert New Tasks",
        "type": "n8n-nodes-base.postgres",
        "typeVersion": 2.5,
        "position": [
          23680,
          22416
        ],
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        },
        "continueOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// PATCH - Task Status Aggregator V10.4\n// FIX: Accumulation robuste des r√©sultats pour Response Builder\n// ============================================\n//\n// PROBL√àME R√âSOLU:\n// Le Response Builder V9.3 lit depuis staticData[`results_${traceId}`]\n// mais le Task Status Aggregator ne stockait pas toujours les r√©sultats.\n//\n// SOLUTION:\n// 1. Toujours lire le r√©sultat depuis Task Result Handler\n// 2. Toujours stocker dans staticData m√™me si pas de fallback\n// 3. Ajouter des logs pour debug\n//\n// INSTRUCTIONS:\n// 1. Ouvrir workflow \"V10.1 orchestrator copy\" (FZxkpldDbgV8AD_cg7IWG)\n// 2. √âditer le n≈ìud \"üìä Task Status Aggregator\"\n// 3. Remplacer tout le code par celui-ci\n// 4. Sauvegarder et tester\n// ============================================\n\nconst traceId = $node['Init V8 Security & Analysis'].json.trace_id;\nconst inputData = $json; // Donn√©es du Fallback Monitor\n\nconsole.log(`[${traceId}] Task Status Aggregator V10.4 starting...`);\n\n// === 1. √âTAT GLOBAL POUR ACCUMULATION ===\nconst staticData = $getWorkflowStaticData('global');\n\nconst resultsKey = `results_${traceId}`;\nif (!staticData[resultsKey]) {\n  staticData[resultsKey] = {\n    completed_tasks: [],\n    error_tasks: [],\n    skipped_tasks: [],\n    all_responses: []\n  };\n  console.log(`[${traceId}] Initialized results storage`);\n}\n\nconst accumulated = staticData[resultsKey];\n\n// === 2. LIRE LE R√âSULTAT ACTUEL ===\n// IMPORTANT: Toujours lire depuis Task Result Handler\nlet currentResult = null;\n\ntry {\n  // Priorit√© 1: Lire directement depuis Task Result Handler\n  const taskHandlerData = $node['üì• Task Result Handler']?.json;\n  if (taskHandlerData) {\n    currentResult = {\n      task: taskHandlerData.task || {},\n      success: taskHandlerData.success || false,\n      response: taskHandlerData.response || '',\n      sources: taskHandlerData.sources || [],\n      confidence: taskHandlerData.confidence || 0,\n      error_message: taskHandlerData.error_message || null,\n      format_detected: taskHandlerData.format_detected || 'unknown'\n    };\n    console.log(`[${traceId}] Read from Task Result Handler: success=${currentResult.success}, format=${currentResult.format_detected}, response_length=${currentResult.response.length}`);\n  }\n} catch (e) {\n  console.log(`[${traceId}] Could not read Task Result Handler: ${e.message}`);\n}\n\n// Priorit√© 2: Fallback Monitor (si disponible dans input)\nif (!currentResult && inputData && inputData.success !== undefined) {\n  currentResult = {\n    task: inputData.task || { task_id: inputData.task_id },\n    success: inputData.success,\n    response: inputData.response || '',\n    sources: inputData.sources || [],\n    confidence: inputData.confidence || 0,\n    error_message: inputData.failure_reason || null\n  };\n  console.log(`[${traceId}] Read from Fallback Monitor input`);\n}\n\n// === 3. AJOUTER LE R√âSULTAT √Ä L'ACCUMULATION ===\nif (currentResult && currentResult.task) {\n  const taskId = currentResult.task.task_id;\n  const ragCalled = currentResult.task.rag_called || 'UNKNOWN';\n  \n  // √âviter les doublons\n  const existsCompleted = accumulated.completed_tasks.some(t => t.task_id === taskId);\n  const existsError = accumulated.error_tasks.some(t => t.task_id === taskId);\n  \n  if (!existsCompleted && !existsError) {\n    if (currentResult.success) {\n      const completedTask = {\n        task_id: taskId,\n        rag_called: ragCalled,\n        response: currentResult.response || '',\n        sources: currentResult.sources || [],\n        confidence: currentResult.confidence || 0.5\n      };\n      \n      accumulated.completed_tasks.push(completedTask);\n      \n      // Ajouter √† all_responses pour la fusion\n      if (currentResult.response && currentResult.response.length > 10) {\n        accumulated.all_responses.push({\n          task_id: taskId,\n          rag: ragCalled,\n          response: currentResult.response,\n          confidence: currentResult.confidence || 0.5\n        });\n      }\n      \n      console.log(`[${traceId}] ‚úÖ Accumulated completed task ${taskId} (${ragCalled}): ${currentResult.response.length} chars, confidence=${currentResult.confidence}`);\n    } else {\n      accumulated.error_tasks.push({\n        task_id: taskId,\n        rag_called: ragCalled,\n        error_message: currentResult.error_message || 'Unknown error'\n      });\n      \n      console.log(`[${traceId}] ‚ùå Accumulated error task ${taskId} (${ragCalled}): ${currentResult.error_message}`);\n    }\n  } else {\n    console.log(`[${traceId}] Task ${taskId} already accumulated, skipping`);\n  }\n} else {\n  console.log(`[${traceId}] No valid current result to accumulate`);\n}\n\n// === 4. LIRE LE PLAN ORIGINAL POUR LE TOTAL ===\nlet totalTasks = 1;\nlet pendingTasks = [];\n\ntry {\n  const planData = $node['üìù Format & Dispatch (Plan‚ÜíDB)'].json;\n  totalTasks = planData.total_tasks || planData.tasks_to_insert?.length || 1;\n  \n  // Calculer les pending\n  const completedIds = accumulated.completed_tasks.map(t => t.task_id);\n  const errorIds = accumulated.error_tasks.map(t => t.task_id);\n  const processedIds = [...completedIds, ...errorIds];\n  \n  const allTaskIds = (planData.tasks_to_insert || []).map(t => t.task_id);\n  pendingTasks = allTaskIds\n    .filter(id => !processedIds.includes(id))\n    .map(id => {\n      const task = planData.tasks_to_insert.find(t => t.task_id === id);\n      return {\n        task_id: id,\n        query: task?.query || '',\n        rag_called: task?.rag_called || 'STANDARD'\n      };\n    });\n    \n} catch (e) {\n  console.log(`[${traceId}] Could not read plan: ${e.message}`);\n}\n\n// === 5. CALCULER LES M√âTRIQUES ===\nconst completedCount = accumulated.completed_tasks.length;\nconst errorCount = accumulated.error_tasks.length;\nconst pendingCount = pendingTasks.length;\nconst processedCount = completedCount + errorCount;\n\nconst completionRate = totalTasks > 0 ? processedCount / totalTasks : 0;\nconst avgConfidence = completedCount > 0 \n  ? accumulated.completed_tasks.reduce((sum, t) => sum + (t.confidence || 0), 0) / completedCount\n  : 0;\n\nconsole.log(`[${traceId}] Aggregation summary:`);\nconsole.log(`[${traceId}]   Completed: ${completedCount}, Errors: ${errorCount}, Pending: ${pendingCount}`);\nconsole.log(`[${traceId}]   Total tasks: ${totalTasks}, Completion: ${Math.round(completionRate * 100)}%`);\nconsole.log(`[${traceId}]   Avg confidence: ${avgConfidence.toFixed(4)}`);\nconsole.log(`[${traceId}]   All responses count: ${accumulated.all_responses.length}`);\n\n// === 6. DEBUG: Afficher les r√©ponses accumul√©es ===\nif (accumulated.all_responses.length > 0) {\n  accumulated.all_responses.forEach((r, i) => {\n    console.log(`[${traceId}]   Response ${i+1} (${r.rag}): ${r.response.substring(0, 100)}...`);\n  });\n}\n\n// === 7. FLAG DE COMPL√âTION ===\nconst isComplete = pendingCount === 0;\n\n// === 8. OUTPUT ===\nreturn {\n  trace_id: traceId,\n  \n  // T√¢ches par statut\n  completed_tasks: accumulated.completed_tasks,\n  pending_tasks: pendingTasks,\n  error_tasks: accumulated.error_tasks,\n  \n  // R√©ponses pour fusion (crucial pour Response Builder!)\n  accumulated_results: accumulated.completed_tasks,\n  all_responses: accumulated.all_responses,\n  \n  // M√©triques\n  total_tasks: totalTasks,\n  completion_rate: completionRate,\n  average_confidence: avgConfidence,\n  \n  // Flags\n  has_failures: errorCount > 0,\n  has_pending: pendingCount > 0,\n  is_complete: isComplete,\n  \n  // R√©sum√©\n  summary: {\n    completed: completedCount,\n    pending: pendingCount,\n    errors: errorCount,\n    total: totalTasks,\n    completion_percentage: Math.round(completionRate * 100)\n  },\n  \n  // Debug info\n  _debug: {\n    results_key: resultsKey,\n    staticData_has_key: !!staticData[resultsKey],\n    responses_accumulated: accumulated.all_responses.length\n  }\n};\n"
        },
        "id": "11209e3f-7603-46d2-be3a-995b47251435",
        "name": "üìä Task Status Aggregator",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          22784,
          22112
        ]
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// NODE: Redis Failure Handler V10.1\n// PURPOSE: Graceful degradation si Redis down\n// ============================================\n\nconst redisData = $json;\nconst redisError = redisData.error || null;\n\n// R√©cup√©rer trace_id depuis Init\nlet traceId = 'unknown';\ntry {\n  traceId = $node['Init V8 Security & Analysis'].json.trace_id;\n} catch(e) {\n  traceId = `fallback-${Date.now()}`;\n}\n\n// === CAS 1: REDIS ERROR (service down) ===\nif (redisError) {\n  console.error(`[${traceId}] REDIS_FAILURE:`, {\n    error: redisError.message || 'Unknown',\n    timestamp: new Date().toISOString(),\n    trace_id: traceId\n  });\n  \n  return {\n    conversation_history: [],\n    context_status: 'DEGRADED',\n    redis_available: false,\n    warning: 'Redis unavailable - running in stateless mode',\n    trace_id: traceId\n  };\n}\n\n// === CAS 2: REDIS OK - Parser les donn√©es ===\ntry {\n  const rawData = redisData.data;\n  \n  // Si pas de data ‚Üí conversation nouvelle\n  if (!rawData || rawData === null || rawData === 'null') {\n    console.log(`[${traceId}] New conversation - no Redis data`);\n    return {\n      conversation_history: [],\n      context_status: 'NEW',\n      redis_available: true,\n      trace_id: traceId\n    };\n  }\n  \n  // Parser le JSON\n  const parsedData = JSON.parse(rawData);\n  const history = parsedData.history || [];\n  \n  console.log(`[${traceId}] Redis OK: ${history.length} messages in history`);\n  \n  return {\n    conversation_history: history,\n    context_status: 'FULL',\n    redis_available: true,\n    trace_id: traceId\n  };\n  \n} catch (parseError) {\n  // === CAS 3: REDIS DATA CORRUPTED ===\n  console.error(`[${traceId}] REDIS_PARSE_ERROR:`, parseError.message);\n  \n  return {\n    conversation_history: [],\n    context_status: 'CORRUPTED',\n    redis_available: true,\n    warning: 'Redis data corrupted - starting fresh',\n    trace_id: traceId\n  };\n}"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          17408,
          22624
        ],
        "id": "c7ee4ae3-47e2-44d7-b012-f138a2ed80c3",
        "name": "üõ°Ô∏è Redis Failure Handler V10.1"
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// NODE: Context Compression V10.1\n// ============================================\n\nconst mergedContext = $json;\nconst conversationHistory = mergedContext.recent_messages || [];\nconst traceId = mergedContext.trace_id;\n\n// 3 derniers messages seulement\nconst recentHistory = conversationHistory.slice(-3);\n\n// R√©sum√© compress√© des anciens\nlet compressedSummary = '';\nif (conversationHistory.length > 3) {\n  const olderHistory = conversationHistory.slice(0, -3);\n  compressedSummary = olderHistory\n    .map(h => h.query || h.message || '')\n    .filter(q => q.length > 0)\n    .join(' | ')\n    .substring(0, 500);\n}\n\n// D√©tecter changement d'intention\nconst lastIntent = mergedContext.last_intent;\nconst intentionShift = lastIntent && lastIntent !== 'UNKNOWN';\n\n// Tokens √©conomis√©s\nconst originalTokens = conversationHistory.reduce((sum, h) => \n  sum + (h.query?.length || 0) + (h.response?.length || 0), 0) / 4;\nconst compressedTokens = recentHistory.reduce((sum, h) => \n  sum + (h.query?.length || 0) + (h.response?.length || 0), 0) / 4;\nconst tokensSaved = Math.max(0, originalTokens - compressedTokens);\n\nconsole.log(`[${traceId}] Compressed: ${conversationHistory.length} ‚Üí ${recentHistory.length} msgs, ~${Math.round(tokensSaved)} tokens saved`);\n\nreturn {\n  ...mergedContext,\n  compressed_history: recentHistory,\n  compressed_summary: compressedSummary,\n  full_history_length: conversationHistory.length,\n  intention_shift: intentionShift,\n  tokens_saved: Math.round(tokensSaved)\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          17792,
          21728
        ],
        "id": "ee9b5dbc-f858-451d-bf3e-2dabf78bdffe",
        "name": "üì¶ Context Compression V10.1"
      },
      {
        "parameters": {
          "jsCode": "// ============================================\n// NODE: üîç Query Classifier V10.1 + Adaptive Retrieval Gate\n// ============================================\n\nconst context = $json;\nconst query = context.query || '';\nconst traceId = context.trace_id;\nconst recentMessages = context.compressed_history || context.recent_messages || [];\n\n// === 1. CONVERSATIONAL DETECTION ===\nconst CONVERSATIONAL_PATTERNS = [\n  /^(hi|hello|hey|bonjour|salut)/i,\n  /^(thanks|thank you|merci)/i,\n  /^(ok|okay|yes|no|oui|non)$/i,\n  /^(bye|goodbye|au revoir)/i,\n  /how are you|comment (vas-tu|allez-vous)/i,\n  /can you help me/i\n];\n\nconst isConversational = \n  CONVERSATIONAL_PATTERNS.some(p => p.test(query)) ||\n  query.length < 5 ||\n  (recentMessages.length > 0 && query.split(' ').length < 5);\n\n// === 2. CACHE CHECK ===\nconst shouldCheckCache = \n  !isConversational && \n  query.length > 10 && \n  query.length < 200;\n\n// === 3. ADAPTIVE RETRIEVAL GATE ===\nconst RETRIEVAL_REQUIRED = [\n  /combien|quel.*total|quelle.*somme/i,\n  /qui.*responsable|quelle.*relation/i,\n  /selon|d'apr√®s|dans.*document|notre/i,\n  /proc√©dure|process|√©tape|comment faire/i,\n  /politique|r√®gle|r√®glement/i\n];\n\nconst DIRECT_ANSWER = [\n  /qu'est-ce qu'un|d√©finition de|c'est quoi/i,\n  /explique.*concept|comment.*fonctionne/i\n];\n\nlet needsRetrieval = true;\nlet retrievalReason = 'DEFAULT';\n\nfor (const pattern of RETRIEVAL_REQUIRED) {\n  if (pattern.test(query)) {\n    needsRetrieval = true;\n    retrievalReason = 'DOMAIN_SPECIFIC';\n    break;\n  }\n}\n\nif (retrievalReason === 'DEFAULT') {\n  for (const pattern of DIRECT_ANSWER) {\n    if (pattern.test(query)) {\n      needsRetrieval = false;\n      retrievalReason = 'GENERAL_KNOWLEDGE';\n      break;\n    }\n  }\n}\n\n// === 4. ROUTE DECISION ===\nlet route = 'agent';\n\nif (isConversational) {\n  route = 'conversational';\n} else if (shouldCheckCache) {\n  route = 'cache_check';\n} else if (!needsRetrieval) {\n  route = 'direct_llm';\n}\n\nconsole.log(`[${traceId}] Route: ${route}, Retrieval: ${needsRetrieval} (${retrievalReason})`);\n\nreturn {\n  ...context,\n  query_route: route,\n  is_conversational: isConversational,\n  should_check_cache: shouldCheckCache,\n  needs_retrieval: needsRetrieval,\n  retrieval_reason: retrievalReason\n};\n"
        },
        "id": "9e99068a-a937-4369-99d4-b3b062c83ac4",
        "name": "üîç Query Classifier V10.1",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          18256,
          21904
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $vars.OPENROUTER_BASE_URL || 'https://openrouter.ai/api/v1' }}/chat/completions",
          "authentication": "none",
          "nodeCredentialType": "openRouterApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"{{ $vars.LLM_FAST_MODEL || 'google/gemma-3-27b-it:free' }}\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are the INTENT ANALYZER of a sophisticated multi-engine RAG system.\\n\\n=== YOUR MISSION ===\\n1. Analyzer la query utilisateur\\n2. Identifier TOUS les intents (explicites ET implicites)\\n3. D√©terminer les D√âPENDANCES entre intents\\n4. Assigner le moteur RAG optimal pour chaque intent\\n\\n=== MOTEURS RAG DISPONIBLES ===\\n\\n**STANDARD (Pinecone + BM25)**\\n- Forces: faits, proc√©dures, d√©finitions\\n\\n**GRAPH (Neo4j)**\\n- Forces: relations, hi√©rarchies, impacts\\n\\n**QUANTITATIVE (PostgreSQL)**\\n- Forces: chiffres, totaux, moyennes, KPIs\\n\\n=== FORMAT JSON STRICT ===\\n{\\n  \\\"reasoning\\\": \\\"<ton analyse>\\\",\\n  \\\"intents\\\": [{\\\"id\\\": \\\"intent-1\\\", \\\"type\\\": \\\"FACTUAL|QUANTITATIVE|RELATIONAL\\\", \\\"suggested_rag\\\": \\\"STANDARD|GRAPH|QUANTITATIVE\\\", \\\"priority\\\": 1}],\\n  \\\"execution_order\\\": [\\\"intent-1\\\"],\\n  \\\"complexity\\\": \\\"SIMPLE|MODERATE|COMPLEX\\\"\\n}\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"=== QUERY TO ANALYZE ===\\n{{ $node['Init V8 Security & Analysis'].json.query }}\"\n    }\n  ],\n  \"temperature\": 0.1,\n  \"max_tokens\": 800\n}",
          "options": {
            "timeout": 12000,
            "retry": {
              "maxTries": 3,
              "waitBetweenTries": 2000
            }
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $vars.OPENROUTER_API_KEY }}"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          19056,
          22496
        ],
        "id": "6bfcc7d3-9915-43c4-abd9-4c299b5dd4b1",
        "name": "HTTP Request",
        "credentials": {},
        "continueOnFail": true,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "operation": "executeQuery",
          "query": "SELECT task_id, intent_id, status, rag_called, attempt, query, response, confidence\nFROM rag_task_executions \nWHERE trace_id = '{{ $node[\"Init V8 Security & Analysis\"].json.trace_id }}'\nORDER BY task_id ASC",
          "options": {}
        },
        "type": "n8n-nodes-base.postgres",
        "typeVersion": 2.6,
        "position": [
          21216,
          22528
        ],
        "id": "7fa85861-eefe-48f9-a03c-7dad6fc40c94",
        "name": "Postgres : Get Current Tasks",
        "credentials": {
          "postgres": {
            "id": "zEr7jPswZNv6lWKu",
            "name": "Supabase PostgreSQL"
          }
        }
      },
      {
        "parameters": {
          "numberInputs": 4
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          24864,
          22160
        ],
        "id": "713d6797-3083-4119-a1b3-a86bcf0b5c77",
        "name": "Merge",
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 3
            },
            "conditions": [
              {
                "id": "ebee2253-8093-451a-bf3b-5b00e78fdc69",
                "leftValue": "={{ $json.all_complete }}",
                "rightValue": true,
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.3,
        "position": [
          21504,
          22816
        ],
        "id": "357e6360-0498-4633-b5f8-30061ecd941a",
        "name": "If"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 3
            },
            "conditions": [
              {
                "id": "f64b093e-7578-418f-aa48-03ebc26d5a02",
                "leftValue": "={{$json.all_tasks_complete}}",
                "rightValue": false,
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.3,
        "position": [
          23504,
          21984
        ],
        "id": "ea57ed6e-ec10-4c32-9600-d5859f56d625",
        "name": "If1"
      },
      {
        "parameters": {
          "jsCode": "// GitHub Error Logger for orchestrator\nconst errorData = $input.first().json;\nconst timestamp = new Date().toISOString();\nconst questionId = errorData.question_id || errorData.trace_id || 'q-' + Date.now();\nconst errorType = errorData.error_type || errorData.error_code || 'UNKNOWN';\nconst pipeline = 'orchestrator';\n\nconst logEntry = {\n  timestamp: timestamp,\n  pipeline: pipeline,\n  question_id: questionId,\n  error_type: errorType,\n  error_message: (errorData.error || errorData.message || 'No message').slice(0, 500),\n  input: {\n    query: (errorData.query || errorData.original_query || '').slice(0, 300),\n    tenant_id: errorData.tenant_id || 'benchmark'\n  },\n  partial_response: errorData.partial_response || errorData.response || null,\n  n8n_context: {\n    workflow_id: $workflow.id,\n    workflow_name: $workflow.name,\n    execution_id: $execution.id\n  },\n  performance: {\n    latency_ms: errorData.latency_ms || 0,\n    http_status: errorData.http_status || null\n  }\n};\n\nreturn [{ json: logEntry }];"
        },
        "id": "0a33eb42-654b-45ca-aaae-79a48360d408",
        "name": "GitHub Error Logger (orchestrator)",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          25564,
          0
        ],
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "jsCode": "// Execution Summary Logger for orchestrator\nconst input = $input.first().json;\nconst timestamp = new Date().toISOString();\n\nconst summary = {\n  timestamp: timestamp,\n  pipeline: 'orchestrator',\n  question_id: input.trace_id || input.question_id || 'q-' + Date.now(),\n  query: (input.query || input.original_query || '').slice(0, 300),\n  success: !!(input.response || input.final_response || input.answer),\n  response_length: (input.response || input.final_response || input.answer || '').length,\n  confidence: input.confidence || 0,\n  latency_ms: input.latency_ms || 0,\n  engine: input.engine || input.selected_engine || 'orchestrator',\n  n8n_context: {\n    workflow_id: $workflow.id,\n    execution_id: $execution.id\n  }\n};\n\nreturn [{ json: summary }];"
        },
        "id": "126ba97d-e08d-413b-9d0e-b6305ac0b2cd",
        "name": "Execution Summary (orchestrator)",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          25564,
          200
        ],
        "onError": "continueRegularOutput"
      }
    ],
    "connections": {
      "Webhook V8": {
        "main": [
          [
            {
              "node": "Input Merger V8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Chat Trigger V8": {
        "main": [
          [
            {
              "node": "Input Merger V8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Input Merger V8": {
        "main": [
          [
            {
              "node": "Init V8 Security & Analysis",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Init V8 Security & Analysis": {
        "main": [
          [
            {
              "node": "Redis: Fetch Conversation",
              "type": "main",
              "index": 0
            },
            {
              "node": "Postgres L2/L3 Memory",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Redis: Fetch Conversation": {
        "main": [
          [
            {
              "node": "üõ°Ô∏è Redis Failure Handler V10.1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üõ°Ô∏è Rate Limit Guard": {
        "main": [
          [
            {
              "node": "IF: Rate Limited?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Rate Limited?": {
        "main": [
          [
            {
              "node": "üß† Memory Merger (Redis + Postgres)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return: Rate Limited",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres L2/L3 Memory": {
        "main": [
          [
            {
              "node": "üß† Memory Merger (Redis + Postgres)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üß† Memory Merger (Redis + Postgres)": {
        "main": [
          [
            {
              "node": "üì¶ Context Compression V10.1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üõ°Ô∏è Advanced Guardrails": {
        "main": [
          [
            {
              "node": "IF: Guardrail Passed?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Guardrail Passed?": {
        "main": [
          [
            {
              "node": "üîç Query Classifier V10.1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return: Guardrail Blocked",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÄ Query Router": {
        "main": [
          [
            {
              "node": "üí¨ Conversational Handler",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "üîé Cache Semantic Search",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "üß† LLM 1: Intent Analyzer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üí¨ Conversational Handler": {
        "main": [
          [
            {
              "node": "Return: Conversational",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîé Cache Semantic Search": {
        "main": [
          [
            {
              "node": "Redis: Cache + Generator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Redis: Cache + Generator": {
        "main": [
          [
            {
              "node": "Cache Parser",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Cache Parser": {
        "main": [
          [
            {
              "node": "IF: Cache Hit?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Cache Hit?": {
        "main": [
          [
            {
              "node": "Return: Cached",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "üß† LLM 1: Intent Analyzer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üß† LLM 1: Intent Analyzer": {
        "main": [
          [
            {
              "node": "Intent Parser V9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Intent Parser V9": {
        "main": [
          [
            {
              "node": "Postgres: Init Tasks Table",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres: Init Tasks Table": {
        "main": [
          [
            {
              "node": "üìù Format & Dispatch (Plan‚ÜíDB)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìù Format & Dispatch (Plan‚ÜíDB)": {
        "main": [
          [
            {
              "node": "Postgres: Insert Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres: Insert Tasks": {
        "main": [
          [
            {
              "node": "Postgres : Get Current Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "‚öôÔ∏è Execution Engine V10": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÄ Dynamic Switch V10": {
        "main": [
          [
            {
              "node": "Invoke WF5: Standard",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Invoke WF2: Graph",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Invoke WF4: Quantitative",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Invoke WF5: Standard": {
        "main": [
          [
            {
              "node": "üì• Task Result Handler",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Invoke WF2: Graph": {
        "main": [
          [
            {
              "node": "üì• Task Result Handler",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Invoke WF4: Quantitative": {
        "main": [
          [
            {
              "node": "üì• Task Result Handler",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üì• Task Result Handler": {
        "main": [
          [
            {
              "node": "Postgres: Update Task",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres: Update Task": {
        "main": [
          [
            {
              "node": "üîÑ Fallback Monitor V10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÑ Fallback Monitor V10": {
        "main": [
          [
            {
              "node": "IF: Fallback Needed?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Fallback Needed?": {
        "main": [
          [
            {
              "node": "üîÑ Fallback Dispatch",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "üìä Task Status Aggregator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÑ Fallback Dispatch": {
        "main": [
          [
            {
              "node": "Postgres: Update Fallback",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres: Update Fallback": {
        "main": [
          [
            {
              "node": "Postgres : Get Current Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìä Task Status Aggregator": {
        "main": [
          [
            {
              "node": "Response Builder V9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres: Apply Skips": {
        "main": [
          [
            {
              "node": "Postgres : Get Current Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres: Insert New Tasks": {
        "main": [
          [
            {
              "node": "Postgres : Get Current Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Response Builder V9": {
        "main": [
          [
            {
              "node": "üíæ Cache Storage",
              "type": "main",
              "index": 0
            },
            {
              "node": "Store RLHF Data V8",
              "type": "main",
              "index": 0
            },
            {
              "node": "Redis: Store Conv V8",
              "type": "main",
              "index": 0
            },
            {
              "node": "Postgres: Update Context V8",
              "type": "main",
              "index": 0
            },
            {
              "node": "Execution Summary (orchestrator)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üíæ Cache Storage": {
        "main": [
          [
            {
              "node": "Redis: Set Cache",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Redis: Set Cache": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Store RLHF Data V8": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Redis: Store Conv V8": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "Postgres: Update Context V8": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Output Router (Final)": {
        "main": [
          [
            {
              "node": "Chat: Final V8",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return Response V8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Error Handler V8": {
        "main": [
          [
            {
              "node": "Error Payload V8",
              "type": "main",
              "index": 0
            },
            {
              "node": "GitHub Error Logger (orchestrator)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Error Payload V8": {
        "main": [
          [
            {
              "node": "Export Error V8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Export Error V8": {
        "main": [
          [
            {
              "node": "Return: Error Response",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return: Error Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üõ°Ô∏è Redis Failure Handler V10.1": {
        "main": [
          [
            {
              "node": "üõ°Ô∏è Rate Limit Guard",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üì¶ Context Compression V10.1": {
        "main": [
          [
            {
              "node": "üõ°Ô∏è Advanced Guardrails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîç Query Classifier V10.1": {
        "main": [
          [
            {
              "node": "üîÄ Query Router",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Intent Parser V9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres : Get Current Tasks": {
        "main": [
          [
            {
              "node": "‚öôÔ∏è Execution Engine V10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Output Router (Final)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Response Builder V9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "üîÄ Dynamic Switch V10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Alexis Moret",
    "name": null,
    "description": null,
    "autosaved": false,
    "workflowPublishHistory": [
      {
        "createdAt": "2026-02-09T22:58:54.894Z",
        "id": 830,
        "workflowId": "ALd4gOEqiKL5KR1p",
        "versionId": "b67bc702-0805-4604-a294-da92ebc4a503",
        "event": "activated",
        "userId": "215767e0-958a-4c74-a67a-e335807eba64"
      }
    ]
  }
}