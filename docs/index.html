<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RAG Test Runner — SOTA 2026</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
:root{--bg:#0b0f15;--s1:#111720;--s2:#171d28;--s3:#1e2533;--bd:#2a3140;--tx:#dce4f0;--tx2:#7f8da0;--tx3:#4e5a6d;--ac:#4f8efa;--gn:#2dd47a;--gn-bg:rgba(45,212,122,.1);--rd:#f05555;--rd-bg:rgba(240,85,85,.1);--yl:#e8b820;--yl-bg:rgba(232,184,32,.1);--or:#f08030;--pp:#a060f0;--cy:#20c0d8}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--tx);font-family:'Inter',system-ui,sans-serif;font-size:13px;line-height:1.5}
::selection{background:var(--ac);color:#fff}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--bd);border-radius:3px}
code,.mono{font-family:'JetBrains Mono',monospace;font-size:.92em}
a{color:var(--ac);text-decoration:none}
a:hover{text-decoration:underline}

/* Header */
.header{background:var(--s1);border-bottom:1px solid var(--bd);padding:12px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
.header h1{font-size:15px;font-weight:600;letter-spacing:-.02em;display:flex;align-items:center;gap:8px}
.header .meta{display:flex;gap:16px;align-items:center;font-size:12px;color:var(--tx2)}
.status-dot{width:7px;height:7px;border-radius:50%;display:inline-block}
.status-dot.ok{background:var(--gn);box-shadow:0 0 6px var(--gn)}
.status-dot.running{background:var(--yl);animation:blink 1.5s infinite}
.status-dot.error{background:var(--rd)}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

/* Tabs */
.tabs{display:flex;background:var(--s1);border-bottom:1px solid var(--bd);padding:0 24px;overflow-x:auto;gap:0}
.tab{padding:10px 20px;font-size:12.5px;font-weight:500;color:var(--tx2);cursor:pointer;border-bottom:2px solid transparent;white-space:nowrap;transition:all .15s}
.tab:hover{color:var(--tx)}
.tab.active{color:var(--ac);border-bottom-color:var(--ac)}
.panel{display:none;padding:20px 24px;max-width:1600px;margin:0 auto}
.panel.active{display:block}

/* Cards */
.card{background:var(--s2);border:1px solid var(--bd);border-radius:8px;padding:16px;overflow:hidden}
.card h3{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--tx2);margin-bottom:10px}
.grid{display:grid;gap:12px;margin:12px 0}
.g4{grid-template-columns:repeat(4,1fr)}
.g3{grid-template-columns:repeat(3,1fr)}
.g2{grid-template-columns:1fr 1fr}
.g1-2{grid-template-columns:1fr 2fr}
.g2-1{grid-template-columns:2fr 1fr}

/* Stat cards */
.stat{text-align:center}
.stat .value{font-size:28px;font-weight:700;font-family:'JetBrains Mono',monospace}
.stat .label{font-size:11px;color:var(--tx2);margin-top:2px}
.stat .delta{font-size:11px;font-weight:600;margin-top:2px}
.delta-up{color:var(--gn)}
.delta-down{color:var(--rd)}
.delta-flat{color:var(--tx3)}

/* Tags */
.tag{display:inline-block;padding:1px 7px;border-radius:4px;font-size:10.5px;font-weight:600;letter-spacing:.02em}
.tag-pass{background:var(--gn-bg);color:var(--gn)}
.tag-fail{background:var(--rd-bg);color:var(--rd)}
.tag-error{background:var(--yl-bg);color:var(--yl)}
.tag-skip{background:rgba(78,90,109,.15);color:var(--tx3)}
.tag-improving{background:rgba(45,212,122,.12);color:var(--gn)}
.tag-regressing{background:rgba(240,85,85,.12);color:var(--rd)}
.tag-stable{background:rgba(78,90,109,.12);color:var(--tx3)}

/* Tables */
table{width:100%;border-collapse:collapse;font-size:12.5px}
th{text-align:left;padding:8px 10px;background:var(--s3);color:var(--tx2);font-weight:600;font-size:11px;text-transform:uppercase;letter-spacing:.04em;position:sticky;top:0;z-index:2}
td{padding:7px 10px;border-top:1px solid var(--bd)}
tr:hover td{background:rgba(255,255,255,.02)}

/* Test matrix cells */
.cell-pass{background:rgba(45,212,122,.18);color:var(--gn);text-align:center;font-weight:600;font-size:11px;cursor:pointer;min-width:28px}
.cell-fail{background:rgba(240,85,85,.18);color:var(--rd);text-align:center;font-weight:600;font-size:11px;cursor:pointer}
.cell-error{background:rgba(232,184,32,.18);color:var(--yl);text-align:center;font-weight:600;font-size:11px;cursor:pointer}
.cell-skip{background:transparent;color:var(--tx3);text-align:center;font-size:10px}
.cell-pass:hover,.cell-fail:hover,.cell-error:hover{outline:2px solid var(--ac);outline-offset:-1px;z-index:1;position:relative}

/* Accuracy bar */
.acc-bar{height:6px;background:var(--s3);border-radius:3px;overflow:hidden;position:relative}
.acc-bar .fill{height:100%;border-radius:3px;transition:width .3s}
.acc-bar .target{position:absolute;top:-2px;height:10px;width:2px;background:var(--tx2)}

/* Search */
.search-box{display:flex;gap:8px;margin-bottom:12px;align-items:center}
.search-box input{background:var(--s2);border:1px solid var(--bd);border-radius:6px;padding:7px 12px;color:var(--tx);font-size:12.5px;flex:1;outline:none}
.search-box input:focus{border-color:var(--ac)}
.search-box select{background:var(--s2);border:1px solid var(--bd);border-radius:6px;padding:7px 10px;color:var(--tx);font-size:12.5px;outline:none}

/* Timeline */
.timeline{position:relative;padding-left:24px}
.timeline::before{content:'';position:absolute;left:7px;top:0;bottom:0;width:2px;background:var(--bd)}
.timeline-item{position:relative;margin-bottom:20px;padding:14px;background:var(--s2);border:1px solid var(--bd);border-radius:8px}
.timeline-item::before{content:'';position:absolute;left:-21px;top:18px;width:10px;height:10px;border-radius:50%;background:var(--ac);border:2px solid var(--bg)}
.timeline-item .time{font-size:11px;color:var(--tx3);margin-bottom:4px;font-family:'JetBrains Mono',monospace}
.timeline-item h4{font-size:14px;font-weight:600;margin-bottom:6px}
.timeline-item .changes{font-size:12px;color:var(--tx2);margin-bottom:8px}
.timeline-item .metrics{display:flex;gap:16px;flex-wrap:wrap}
.timeline-item .metric{font-size:12px}
.timeline-item .metric strong{color:var(--tx)}

/* Expandable */
.expandable{cursor:pointer}
.expandable::after{content:'';display:inline-block;width:0;height:0;border-left:4px solid transparent;border-right:4px solid transparent;border-top:5px solid var(--tx3);margin-left:6px;transition:transform .2s}
.expandable.open::after{transform:rotate(180deg)}
.expand-content{display:none;padding-top:10px}
.expand-content.open{display:block}

/* Detail panel */
.detail-panel{background:var(--s1);border:1px solid var(--bd);border-radius:8px;padding:16px;margin-top:8px}
.detail-panel .answer-block{background:var(--s3);border-radius:6px;padding:10px 12px;margin:6px 0;font-size:12.5px;white-space:pre-wrap;word-break:break-word;max-height:200px;overflow-y:auto}
.detail-panel .answer-block.expected{border-left:3px solid var(--gn)}
.detail-panel .answer-block.actual{border-left:3px solid var(--ac)}
.detail-panel .answer-block.error-block{border-left:3px solid var(--rd)}

/* Diff highlight */
.diff-added{background:rgba(45,212,122,.15);color:var(--gn)}
.diff-removed{background:rgba(240,85,85,.15);color:var(--rd)}

/* Tooltip */
.tooltip{position:relative}
.tooltip .tip{display:none;position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:var(--s1);border:1px solid var(--bd);border-radius:6px;padding:8px 12px;font-size:11.5px;white-space:nowrap;z-index:50;box-shadow:0 4px 12px rgba(0,0,0,.4)}
.tooltip:hover .tip{display:block}

/* Pipeline colors */
.pipe-standard{color:#4f8efa}
.pipe-graph{color:#a060f0}
.pipe-quantitative{color:#20c0d8}
.pipe-orchestrator{color:#f08030}
.dot-standard{background:#4f8efa}
.dot-graph{background:#a060f0}
.dot-quantitative{background:#20c0d8}
.dot-orchestrator{background:#f08030}

/* ==========================================
   Gauge — circular gauge component
   ========================================== */
.gauge{position:relative;width:120px;height:120px;display:flex;align-items:center;justify-content:center;flex-direction:column;margin:0 auto}
.gauge svg{position:absolute;top:0;left:0;width:100%;height:100%;transform:rotate(-90deg)}
.gauge .gauge-bg{fill:none;stroke:var(--s3);stroke-width:8}
.gauge .gauge-fill{fill:none;stroke-width:8;stroke-linecap:round;transition:stroke-dashoffset .6s ease}
.gauge .gauge-value{font-size:22px;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.gauge .gauge-label{font-size:10px;color:var(--tx2);margin-top:2px}
.gauge .gauge-target{font-size:9px;color:var(--tx3);margin-top:1px}

/* ==========================================
   Phase cards — phase tracker
   ========================================== */
.phase-card{background:var(--s2);border:1px solid var(--bd);border-radius:10px;padding:18px;position:relative;transition:all .2s}
.phase-card h4{font-size:14px;font-weight:600;margin-bottom:4px}
.phase-card .phase-number{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--tx2);margin-bottom:6px}
.phase-card .phase-desc{font-size:12px;color:var(--tx2);margin-bottom:12px;line-height:1.5}
.phase-active{border-color:var(--ac);box-shadow:0 0 20px rgba(79,142,250,.12)}
.phase-active .phase-number{color:var(--ac)}
.phase-active::before{content:'';position:absolute;top:12px;right:12px;width:8px;height:8px;border-radius:50%;background:var(--ac);box-shadow:0 0 8px var(--ac);animation:blink 1.5s infinite}
.phase-locked{opacity:.5}
.phase-locked::after{content:'';position:absolute;top:12px;right:12px;width:14px;height:14px;background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234e5a6d' stroke-width='2'%3E%3Crect x='3' y='11' width='18' height='11' rx='2'/%3E%3Cpath d='M7 11V7a5 5 0 0110 0v4'/%3E%3C/svg%3E") no-repeat center/contain}
.phase-completed{border-color:var(--gn);opacity:.85}
.phase-completed .phase-number{color:var(--gn)}

/* ==========================================
   Criteria list — exit criteria checklists
   ========================================== */
.criteria-list{list-style:none;padding:0;margin:8px 0 0 0}
.criteria-item{display:flex;align-items:flex-start;gap:8px;padding:5px 0;font-size:12px;color:var(--tx2);border-bottom:1px solid rgba(42,49,64,.4)}
.criteria-item:last-child{border-bottom:none}
.criteria-check{flex-shrink:0;width:16px;height:16px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;margin-top:1px}
.criteria-check.pass{background:var(--gn-bg);color:var(--gn)}
.criteria-check.pass::after{content:'\\2713'}
.criteria-miss{flex-shrink:0;width:16px;height:16px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;margin-top:1px}
.criteria-miss{background:var(--rd-bg);color:var(--rd)}
.criteria-miss::after{content:'\\2717'}

/* ==========================================
   Blocker items
   ========================================== */
.blocker-item{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;background:var(--s3);border-radius:6px;margin-bottom:8px;border-left:3px solid var(--rd)}
.blocker-item .blocker-severity{flex-shrink:0;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.04em;padding:2px 8px;border-radius:3px}
.blocker-item .blocker-severity.critical{background:var(--rd-bg);color:var(--rd)}
.blocker-item .blocker-severity.high{background:var(--or);color:#fff;background:rgba(240,128,48,.15);color:var(--or)}
.blocker-item .blocker-severity.medium{background:var(--yl-bg);color:var(--yl)}
.blocker-item .blocker-text{font-size:12.5px;color:var(--tx);line-height:1.5}
.blocker-item .blocker-text .blocker-detail{font-size:11.5px;color:var(--tx2);margin-top:2px}

/* ==========================================
   Insight cards — AI insight cards
   ========================================== */
.insight-card{background:var(--s2);border:1px solid var(--bd);border-radius:8px;padding:14px 16px;margin-bottom:10px;border-left:3px solid var(--ac)}
.insight-card.insight-positive{border-left-color:var(--gn)}
.insight-card.insight-negative{border-left-color:var(--rd)}
.insight-card.insight-warning{border-left-color:var(--yl)}
.insight-card.insight-info{border-left-color:var(--ac)}
.insight-card h4{font-size:13px;font-weight:600;margin-bottom:4px}
.insight-card p{font-size:12px;color:var(--tx2);line-height:1.6}
.insight-card .insight-meta{display:flex;gap:12px;margin-top:8px;font-size:10.5px;color:var(--tx3)}
.insight-card .insight-action{margin-top:8px;padding:8px 10px;background:var(--s3);border-radius:5px;font-size:12px;color:var(--tx);font-family:'JetBrains Mono',monospace}

/* ==========================================
   Progress ring — SVG circular progress
   ========================================== */
.progress-ring{position:relative;display:inline-flex;align-items:center;justify-content:center}
.progress-ring svg{transform:rotate(-90deg)}
.progress-ring .progress-ring-bg{fill:none;stroke:var(--s3);stroke-width:4}
.progress-ring .progress-ring-fill{fill:none;stroke-width:4;stroke-linecap:round;transition:stroke-dashoffset .5s ease}
.progress-ring .progress-ring-text{position:absolute;font-size:11px;font-weight:600;font-family:'JetBrains Mono',monospace}

/* ==========================================
   Error badge — error count badges
   ========================================== */
.error-badge{display:inline-flex;align-items:center;justify-content:center;min-width:20px;height:20px;padding:0 6px;border-radius:10px;font-size:10px;font-weight:700;font-family:'JetBrains Mono',monospace}
.error-badge.error-badge-red{background:var(--rd-bg);color:var(--rd)}
.error-badge.error-badge-yellow{background:var(--yl-bg);color:var(--yl)}
.error-badge.error-badge-green{background:var(--gn-bg);color:var(--gn)}
.error-badge.error-badge-zero{background:rgba(78,90,109,.12);color:var(--tx3)}

/* Responsive */
@media(max-width:1200px){.g4{grid-template-columns:repeat(2,1fr)}}
@media(max-width:768px){.g4,.g3,.g2{grid-template-columns:1fr}.panel{padding:12px}}

/* Print */
@media print{.header,.tabs{display:none}.panel{display:block!important}}
</style>
</head>
<body>

<div class="header">
  <h1>
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"/><rect x="9" y="3" width="6" height="4" rx="1"/><path d="M9 14l2 2 4-4"/></svg>
    RAG Test Runner
    <span id="statusDot" class="status-dot ok"></span>
  </h1>
  <div class="meta">
    <span id="metaPhase">Phase 1</span>
    <span id="metaIterations">0 iterations</span>
    <span id="metaQuestions">0 questions</span>
    <span id="metaRuns">0 test runs</span>
    <span id="metaUpdated" class="mono">--</span>
  </div>
</div>

<div class="tabs">
  <div class="tab active" data-tab="command">Command Center</div>
  <div class="tab" data-tab="matrix">Test Matrix</div>
  <div class="tab" data-tab="iterations">Iterations</div>
  <div class="tab" data-tab="pipelines">Pipelines</div>
  <div class="tab" data-tab="errors">Error Analysis</div>
  <div class="tab" data-tab="phases">Phase Tracker</div>
  <div class="tab" data-tab="questions">Questions</div>
  <div class="tab" data-tab="smoke">Smoke Tests</div>
  <div class="tab" data-tab="workflows">Workflows</div>
  <div class="tab" data-tab="insights">AI Insights</div>
</div>

<!-- TAB 1: COMMAND CENTER -->
<div id="tab-command" class="panel active">
  <div class="grid g4" id="cmdSummaryCards"></div>

  <div class="card" style="margin-top:12px">
    <h3>Phase Progress</h3>
    <div id="cmdPhaseProgress"></div>
  </div>

  <div class="grid g4" style="margin-top:12px" id="cmdPipeGauges"></div>

  <div class="grid g2" style="margin-top:12px">
    <div class="card" id="cmdBlockers">
      <h3>Active Blockers</h3>
      <div id="cmdBlockersList"></div>
    </div>
    <div class="card" id="cmdRecommendations">
      <h3>Top Recommendations</h3>
      <div id="cmdRecommendationsList"></div>
    </div>
  </div>
</div>

<!-- TAB 2: TEST MATRIX -->
<div id="tab-matrix" class="panel">
  <div class="grid g4" id="summaryCards"></div>

  <div class="card" style="margin-top:12px">
    <h3>Test Matrix: Questions x Iterations <span id="matrixFilterInfo" style="font-weight:400;text-transform:none;color:var(--tx3)"></span></h3>
    <div class="search-box">
      <select id="matrixPipeFilter">
        <option value="all">All pipelines</option>
        <option value="standard">Standard</option>
        <option value="graph">Graph</option>
        <option value="quantitative">Quantitative</option>
        <option value="orchestrator">Orchestrator</option>
      </select>
      <select id="matrixStatusFilter">
        <option value="all">All statuses</option>
        <option value="pass">Passing</option>
        <option value="fail">Failing</option>
        <option value="error">Errors</option>
        <option value="regressing">Regressing</option>
        <option value="improving">Improving</option>
      </select>
      <input type="text" id="matrixSearch" placeholder="Search question ID or text...">
    </div>
    <div style="overflow-x:auto;max-height:70vh;overflow-y:auto">
      <table id="matrixTable">
        <thead id="matrixHeader"></thead>
        <tbody id="matrixBody"></tbody>
      </table>
    </div>
  </div>

  <div id="questionDetail" class="detail-panel" style="display:none;margin-top:12px"></div>
</div>

<!-- TAB 3: ITERATIONS -->
<div id="tab-iterations" class="panel">
  <div class="card" style="margin-bottom:12px">
    <h3>Accuracy Trend Across Iterations</h3>
    <canvas id="iterChart" height="250"></canvas>
  </div>
  <div class="card">
    <h3>Iteration Comparison</h3>
    <div class="search-box">
      <select id="iterCompareA"></select>
      <span style="color:var(--tx3)">vs</span>
      <select id="iterCompareB"></select>
      <button onclick="compareIterations()" style="background:var(--ac);color:#fff;border:none;border-radius:6px;padding:6px 14px;cursor:pointer;font-size:12px">Compare</button>
    </div>
    <div id="iterCompareResult"></div>
  </div>
  <div class="card" style="margin-top:12px">
    <h3>Burndown to Targets</h3>
    <canvas id="burndownChart" height="200"></canvas>
  </div>
  <div style="margin-top:16px">
    <h3 style="font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--tx2);margin-bottom:12px">Iteration Timeline</h3>
    <div class="timeline" id="iterTimeline"></div>
  </div>
</div>

<!-- TAB 4: PIPELINES -->
<div id="tab-pipelines" class="panel">
  <div class="grid g4" id="pipelineCards"></div>
  <div class="grid g2" style="margin-top:12px">
    <div class="card">
      <h3>Accuracy per Iteration</h3>
      <canvas id="pipeAccChart" height="280"></canvas>
    </div>
    <div class="card">
      <h3>Error Rate per Iteration</h3>
      <canvas id="pipeErrChart" height="280"></canvas>
    </div>
  </div>
  <div class="grid g2" style="margin-top:12px">
    <div class="card">
      <h3>Average Latency (ms)</h3>
      <canvas id="pipeLatChart" height="280"></canvas>
    </div>
    <div class="card">
      <h3>Question Category Breakdown</h3>
      <div id="categoryBreakdown"></div>
    </div>
  </div>
  <div class="grid g2" style="margin-top:12px">
    <div class="card" id="f1Distribution">
      <h3>F1 Score Distribution</h3>
      <canvas id="f1DistChart" height="280"></canvas>
    </div>
    <div class="card" id="errorBreakdown">
      <h3>Error Type Breakdown</h3>
      <canvas id="errorBreakdownChart" height="280"></canvas>
    </div>
  </div>
</div>

<!-- TAB 5: ERROR ANALYSIS -->
<div id="tab-errors" class="panel">
  <div class="grid g4" id="errorStatCards"></div>

  <div class="grid g2" style="margin-top:12px">
    <div class="card">
      <h3>Errors by Type</h3>
      <canvas id="errorTypeChart" height="280"></canvas>
    </div>
    <div class="card">
      <h3>Error Timeline</h3>
      <canvas id="errorTimelineChart" height="280"></canvas>
    </div>
  </div>

  <div class="card" style="margin-top:12px">
    <h3>Error Patterns</h3>
    <div id="errorPatterns"></div>
  </div>

  <div class="card" style="margin-top:12px">
    <h3>Per-Question Error Details</h3>
    <div class="search-box">
      <select id="errorPipeFilter">
        <option value="all">All pipelines</option>
        <option value="standard">Standard</option>
        <option value="graph">Graph</option>
        <option value="quantitative">Quantitative</option>
        <option value="orchestrator">Orchestrator</option>
      </select>
      <select id="errorTypeFilter">
        <option value="all">All error types</option>
        <option value="TIMEOUT">Timeout</option>
        <option value="EMPTY_RESPONSE">Empty Response</option>
        <option value="ENTITY_MISS">Entity Miss</option>
        <option value="SQL_ERROR">SQL Error</option>
        <option value="NETWORK">Network</option>
        <option value="SERVER_ERROR">Server Error</option>
        <option value="RATE_LIMIT">Rate Limit</option>
        <option value="UNKNOWN">Unknown</option>
      </select>
    </div>
    <div style="overflow-x:auto;max-height:60vh;overflow-y:auto">
      <table>
        <thead>
          <tr>
            <th style="width:80px">ID</th>
            <th style="width:90px">Pipeline</th>
            <th style="width:100px">Error Type</th>
            <th style="width:50px">Count</th>
            <th>Question</th>
            <th>Last Error</th>
            <th style="width:80px">Last Iter</th>
          </tr>
        </thead>
        <tbody id="errorDetailsBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- TAB 6: PHASE TRACKER -->
<div id="tab-phases" class="panel">
  <div class="card" style="margin-bottom:16px">
    <h3>Phase Roadmap</h3>
    <div style="display:flex;align-items:center;gap:6px;margin-bottom:12px;padding:8px 0" id="phaseRoadmapBar"></div>
  </div>

  <div id="phaseCards"></div>
</div>

<!-- TAB 7: QUESTIONS -->
<div id="tab-questions" class="panel">
  <div class="search-box">
    <input type="text" id="qSearch" placeholder="Search by ID, question text, or expected answer...">
    <select id="qPipeFilter">
      <option value="all">All pipelines</option>
      <option value="standard">Standard</option>
      <option value="graph">Graph</option>
      <option value="quantitative">Quantitative</option>
      <option value="orchestrator">Orchestrator</option>
    </select>
    <select id="qStatusFilter">
      <option value="all">All</option>
      <option value="pass">Passing</option>
      <option value="fail">Failing</option>
      <option value="error">Has errors</option>
      <option value="improving">Improving</option>
      <option value="regressing">Regressing</option>
    </select>
  </div>
  <div style="overflow-x:auto">
    <table>
      <thead>
        <tr>
          <th style="width:80px">ID</th>
          <th>Question</th>
          <th style="width:80px">Pipeline</th>
          <th style="width:60px">Runs</th>
          <th style="width:70px">Pass Rate</th>
          <th style="width:60px">Best F1</th>
          <th style="width:80px">Status</th>
          <th style="width:70px">Trend</th>
        </tr>
      </thead>
      <tbody id="questionsBody"></tbody>
    </table>
  </div>
  <div id="qDetailPanel" class="detail-panel" style="display:none;margin-top:12px"></div>
</div>

<!-- TAB 8: SMOKE TESTS -->
<div id="tab-smoke" class="panel">
  <div class="grid g4" id="smokeStatusCards"></div>
  <div class="card" style="margin-top:12px">
    <h3>Smoke Test History <span style="font-weight:400;text-transform:none;color:var(--tx3)">(endpoint validation after each workflow change)</span></h3>
    <table>
      <thead>
        <tr>
          <th style="width:150px">Timestamp</th>
          <th style="width:90px">Pipeline</th>
          <th style="width:60px">Status</th>
          <th style="width:80px">Trigger</th>
          <th style="width:80px">Latency</th>
          <th>Query</th>
          <th>Response / Error</th>
        </tr>
      </thead>
      <tbody id="smokeTestsBody"></tbody>
    </table>
  </div>
</div>

<!-- TAB 9: WORKFLOWS (merged workflows + changes) -->
<div id="tab-workflows" class="panel">
  <div class="grid g4" id="wfVersionCards"></div>
  <div class="card" style="margin-top:12px">
    <h3>Workflow Version History</h3>
    <table>
      <thead>
        <tr>
          <th style="width:150px">Timestamp</th>
          <th style="width:100px">Pipeline</th>
          <th style="width:60px">Version</th>
          <th style="width:110px">Hash</th>
          <th>Changes</th>
          <th style="width:120px">Snapshot</th>
        </tr>
      </thead>
      <tbody id="wfHistoryBody"></tbody>
    </table>
  </div>
  <div id="wfDiffPanel" class="detail-panel" style="display:none;margin-top:12px"></div>

  <div class="card" style="margin-top:16px">
    <h3>Workflow Changes & Impact</h3>
    <table>
      <thead>
        <tr>
          <th style="width:150px">Timestamp</th>
          <th style="width:100px">Type</th>
          <th>Description</th>
          <th style="width:120px">Pipelines</th>
          <th style="width:100px">Impact</th>
        </tr>
      </thead>
      <tbody id="changesBody"></tbody>
    </table>
  </div>

  <div class="card" style="margin-top:12px">
    <h3>Database State Over Time</h3>
    <table>
      <thead>
        <tr>
          <th>Snapshot</th>
          <th>Trigger</th>
          <th>Pinecone Vectors</th>
          <th>Neo4j Nodes</th>
          <th>Neo4j Rels</th>
          <th>Supabase Rows</th>
        </tr>
      </thead>
      <tbody id="dbSnapshotsBody"></tbody>
    </table>
  </div>
</div>

<!-- TAB 10: AI INSIGHTS (upgraded from api tab) -->
<div id="tab-insights" class="panel">
  <div class="grid g2">
    <div class="card">
      <h3>Live Insights</h3>
      <div id="liveInsights"></div>
    </div>
    <div class="card">
      <h3>AI Recommendations</h3>
      <div id="recommendations"></div>
    </div>
  </div>

  <div class="card" style="margin-top:16px">
    <h3>Agentic Evaluation API</h3>
    <p style="color:var(--tx2);margin-bottom:12px">This data structure is designed for consumption by an AI agent that continuously evaluates and improves the RAG pipelines. The agent reads <code>data.json</code> and uses the structured data to make improvement decisions.</p>

    <h4 style="font-size:13px;margin:16px 0 8px">Data Schema (v2.0)</h4>
    <div class="answer-block" style="background:var(--s3);border-radius:6px;padding:12px;font-family:'JetBrains Mono',monospace;font-size:12px;white-space:pre;overflow-x:auto;max-height:400px;overflow-y:auto" id="apiSchema"></div>

    <h4 style="font-size:13px;margin:16px 0 8px">Decision Rules for Agentic Evaluation</h4>
    <div id="agenticRules" style="font-size:12.5px;color:var(--tx2)"></div>

    <h4 style="font-size:13px;margin:16px 0 8px">GitHub Actions Integration</h4>
    <div id="ghActionsDoc"></div>

    <h4 style="font-size:13px;margin:16px 0 8px">Quick Test Endpoint</h4>
    <div class="answer-block" style="background:var(--s3);border-radius:6px;padding:12px;font-family:'JetBrains Mono',monospace;font-size:12px;white-space:pre;overflow-x:auto">POST https://amoret.app.n8n.cloud/webhook/{endpoint}
Content-Type: application/json

{
  "query": "test question",
  "tenant_id": "benchmark",
  "top_k": 10,
  "include_sources": true,
  "benchmark_mode": true
}</div>

    <h4 style="font-size:13px;margin:16px 0 8px">Running Evaluations</h4>
    <div class="answer-block" style="background:var(--s3);border-radius:6px;padding:12px;font-family:'JetBrains Mono',monospace;font-size:12px;white-space:pre;overflow-x:auto"># Full eval (all pipelines, skip already-tested)
python run-comprehensive-eval.py

# Specific pipelines, max 10 per type
python run-comprehensive-eval.py --types standard,graph --max 10

# Re-test everything (ignore dedup)
python run-comprehensive-eval.py --reset

# GitHub Actions: trigger manually
gh workflow run rag-eval.yml -f types=standard,graph -f max_per_type=10 -f reset=true</div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>
</script>
</body>
</html>
