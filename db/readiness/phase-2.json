{
  "phase": 2,
  "name": "Expand",
  "questions": 1000,
  "description": "Scale to 1,000 questions using tier 1 and tier 2 HuggingFace datasets. Requires significant Neo4j and Supabase ingestion for multi-hop graph and financial QA datasets.",
  "last_checked": "2026-02-08T22:15:00Z",
  "checked_by": "phase2-database-setup branch",
  "prerequisites": {
    "phase_1_gates_passed": false,
    "phase_1_status": {
      "standard": {"current": 83.6, "target": 85, "met": false, "gap": -1.4},
      "graph": {"current": 76.4, "target": 70, "met": true, "gap": 6.4},
      "quantitative": {"current": 65.5, "target": 85, "met": false, "gap": -19.5},
      "orchestrator": {"current": 44.0, "target": 70, "met": false, "gap": -26.0},
      "overall": {"current": 68.3, "target": 75, "met": false, "gap": -6.7}
    },
    "notes": "Phase 1 gates NOT met. Graph pipeline passed (76.4% > 70%). Standard close (-1.4pp). Quantitative and Orchestrator need significant improvement."
  },
  "dataset_file": {
    "path": "datasets/phase-2/hf-1000.json",
    "exists": true,
    "size_mb": 4.7,
    "total_questions": 1000,
    "by_dataset": {
      "musique": 200,
      "2wikimultihopqa": 300,
      "finqa": 200,
      "tatqa": 150,
      "convfinqa": 100,
      "wikitablequestions": 50
    },
    "by_rag_target": {
      "graph": 500,
      "quantitative": 500
    },
    "issues": {
      "missing_expected_answer": 2,
      "missing_context_and_table_data": 0,
      "notes": "50 wikitablequestions now have table_data fetched from HuggingFace. 1 finqa question (finqa-186) had answer computed (43.33%). 2 finqa questions (finqa-97, finqa-165) have empty answers in original FinQA test set â€” insufficient context in source data."
    },
    "status": "ready"
  },
  "requirements": {
    "pinecone": {
      "min_vectors": 10411,
      "namespaces_required": [
        "benchmark-squad_v2",
        "benchmark-triviaqa",
        "benchmark-popqa"
      ],
      "status": "ready",
      "current": 10411,
      "verified_at": "2026-02-08T21:52:00Z",
      "namespaces": {
        "benchmark-squad_v2": 1000,
        "benchmark-triviaqa": 1000,
        "benchmark-popqa": 1000,
        "benchmark-finqa": 500,
        "benchmark-hotpotqa": 1000,
        "benchmark-msmarco": 1000,
        "benchmark-narrativeqa": 1000,
        "benchmark-natural_questions": 1000,
        "benchmark-pubmedqa": 500,
        "benchmark-asqa": 948,
        "benchmark-frames": 824
      },
      "notes": "No additional Pinecone ingestion needed for Phase 2. All 12 namespaces healthy."
    },
    "neo4j": {
      "min_nodes": 2500,
      "min_relationships": 3000,
      "entity_types_required": [
        "Person",
        "Organization",
        "Technology",
        "City",
        "Disease",
        "Entity",
        "Concept",
        "Location"
      ],
      "status": "migration_ready",
      "verified_at": "2026-02-08T22:15:00Z",
      "current_nodes": 14904,
      "current_relationships": 54907,
      "node_labels": {
        "Entity": 6216,
        "Person": 6100,
        "Organization": 1582,
        "City": 775,
        "Technology": 126,
        "Museum": 47,
        "Disease": 22,
        "Concept": 12,
        "other": 24
      },
      "quantity_check": {
        "nodes_required": 2500,
        "nodes_actual": 14904,
        "nodes_ok": true,
        "relationships_required": 3000,
        "relationships_actual": 54907,
        "relationships_ok": true
      },
      "quality_check": {
        "phase2_sample_entities_tested": 21,
        "phase2_sample_entities_found": 11,
        "coverage_pct": 52,
        "entities_found": [
          "SpongeBob", "Napoleon", "Julius Caesar", "Shakespeare",
          "Beethoven", "Einstein", "Marie Curie", "Alan Turing",
          "Tesla", "Newton", "Darwin"
        ],
        "entities_not_found": [
          "Plankton", "Mr. Lawrence", "Senica", "Heinrich Gross",
          "John Knox", "Presbyterian", "Rutherford B. Hayes",
          "Spiegel", "Mao Zedong", "Aristotle"
        ],
        "notes": "Entity extraction script created (db/populate/phase2_neo4j.py). Run with --llm for LLM-based extraction or without for heuristic. Will extract entities from 500 graph question contexts and seed into Neo4j."
      },
      "ingestion_script": "db/populate/phase2_neo4j.py",
      "datasets_to_ingest": [
        "musique",
        "2wikimultihopqa"
      ],
      "notes": "Quantity exceeds requirements. Quality gap exists but extraction script is ready. Run: python db/populate/phase2_neo4j.py --llm"
    },
    "supabase": {
      "min_rows": 10000,
      "tables_required": [
        "financials",
        "balance_sheet",
        "sales_data",
        "products",
        "employees",
        "finqa_tables",
        "tatqa_tables",
        "convfinqa_tables"
      ],
      "status": "migration_ready",
      "verified_at": "2026-02-08T22:15:00Z",
      "current_rows": 88,
      "phase_1_tables": {
        "financials": "present (24 rows)",
        "balance_sheet": "present (12 rows)",
        "sales_data": "present (16 rows)",
        "products": "present (18 rows)",
        "employees": "present (9 rows)"
      },
      "phase_2_tables": {
        "finqa_tables": "migration_created (db/migrations/phase2-financial-tables.sql)",
        "tatqa_tables": "migration_created (db/migrations/phase2-financial-tables.sql)",
        "convfinqa_tables": "migration_created (db/migrations/phase2-financial-tables.sql)"
      },
      "migration_file": "db/migrations/phase2-financial-tables.sql",
      "population_script": "db/populate/phase2_supabase.py",
      "datasets_to_ingest": [
        "finqa",
        "tatqa",
        "convfinqa"
      ],
      "expected_rows_after_population": {
        "finqa_tables": 200,
        "tatqa_tables": 150,
        "convfinqa_tables": 100,
        "total_new": 450
      },
      "notes": "Migration SQL and population script created. Run: python db/populate/phase2_supabase.py (requires SUPABASE_PASSWORD env var). Will create tables and insert 450 rows from hf-1000.json."
    }
  },
  "gate_criteria": {
    "standard": {
      "target_accuracy": 85,
      "current": null,
      "met": false,
      "notes": "Standard not directly tested in Phase 2 (carryover from Phase 1)"
    },
    "graph": {
      "target_accuracy": 60,
      "current": null,
      "met": false,
      "notes": "Target lower than Phase 1 because musique/2wiki questions are harder"
    },
    "quantitative": {
      "target_accuracy": 70,
      "current": null,
      "met": false,
      "notes": "Target lower than Phase 1 because financial report questions are more complex"
    },
    "orchestrator": {
      "target_accuracy": 65,
      "max_p95_latency_s": 15,
      "max_error_rate_pct": 10,
      "current": null,
      "met": false
    },
    "overall": {
      "target_accuracy": 70,
      "current": null,
      "met": false
    }
  },
  "readiness_summary": {
    "overall": "MIGRATION_READY",
    "blockers": [
      "Phase 1 gates not met (3/5 pipelines below target)",
      "Supabase Phase 2 tables need to be created (migration + population scripts ready)",
      "Neo4j entity extraction needs to be run (script ready)"
    ],
    "ready_components": [
      "Dataset file present and fixed (1,000 questions, all with context/table_data)",
      "Pinecone ready (no changes needed)",
      "Neo4j node/relationship quantity exceeds minimums (14,904 nodes / 54,907 rels)",
      "Migration SQL created: db/migrations/phase2-financial-tables.sql",
      "Supabase population script created: db/populate/phase2_supabase.py",
      "Neo4j extraction script created: db/populate/phase2_neo4j.py",
      "WikiTableQuestions data fetched (50/50 tables from HuggingFace)",
      "3 finqa expected_answer issues addressed (1 computed, 2 flagged as source data issue)"
    ],
    "actions_required": [
      {
        "priority": "P0",
        "action": "Pass Phase 1 gates",
        "details": "Standard needs +1.4pp, Quantitative needs +19.5pp, Orchestrator needs +26pp"
      },
      {
        "priority": "P1",
        "action": "Run Neo4j entity extraction",
        "command": "python db/populate/phase2_neo4j.py --llm",
        "details": "Extracts entities from 500 graph question contexts and seeds into Neo4j. Use --llm for higher quality."
      },
      {
        "priority": "P1",
        "action": "Run Supabase Phase 2 table creation and population",
        "command": "python db/populate/phase2_supabase.py",
        "details": "Creates finqa_tables, tatqa_tables, convfinqa_tables and inserts 450 rows of financial table data."
      }
    ]
  },
  "datasets_used": [
    "musique",
    "2wikimultihopqa",
    "finqa",
    "tatqa",
    "convfinqa",
    "wikitablequestions"
  ],
  "question_breakdown": {
    "graph": {
      "musique": 200,
      "2wikimultihopqa": 300,
      "total": 500
    },
    "quantitative": {
      "finqa": 200,
      "tatqa": 150,
      "convfinqa": 100,
      "wikitablequestions": 50,
      "total": 500
    },
    "standard": {
      "carryover_from_phase_1": 50,
      "total": 50
    }
  }
}
